{"file_contents":{"README.md":{"content":"# SOC Dashboard - Security Operations Center\n\nA comprehensive, real-time Security Operations Center (SOC) dashboard for cybersecurity monitoring, incident management, and threat analysis. Built with modern web technologies and featuring enterprise-grade authentication, real-time updates, and advanced analytics.\n\n![SOC Dashboard](https://img.shields.io/badge/Status-Active-brightgreen) ![Version](https://img.shields.io/badge/Version-1.0.0-blue) ![License](https://img.shields.io/badge/License-MIT-green)\n\n## 🚀 Features\n\n### Core Security Operations\n- **Real-time Alert Management** - Live monitoring and processing of security alerts from multiple sources\n- **Incident Response** - Streamlined incident tracking, assignment, and resolution workflows\n- **Threat Analytics** - Advanced threat correlation and intelligence integration\n- **Source Integration** - Support for SIEM, EDR, Firewall, and other security tools\n- **Dashboard Analytics** - Comprehensive performance metrics and automated reporting\n\n### Technical Features\n- **Real-time Communication** - WebSocket-based live updates and notifications\n- **Authentication System** - Secure OAuth 2.0/OIDC integration with Replit\n- **Role-based Access** - Analyst and admin user roles with appropriate permissions\n- **Modern UI/UX** - Dark-themed interface optimized for SOC environments\n- **Responsive Design** - Mobile-first approach with cross-device compatibility\n- **Type Safety** - Full TypeScript implementation with end-to-end type safety\n\n## 🏗️ System Architecture\n\n### Frontend Stack\n- **React 18** - Modern React with hooks and concurrent features\n- **TypeScript** - End-to-end type safety and developer experience\n- **Radix UI + shadcn/ui** - Accessible, customizable component system\n- **Tailwind CSS** - Utility-first styling with custom SOC-optimized dark theme\n- **TanStack React Query** - Server state management with caching and synchronization\n- **Wouter** - Lightweight client-side routing (alternative to React Router)\n- **React Hook Form + Zod** - Type-safe form handling with validation\n- **Lucide React** - Modern icon library\n- **Framer Motion** - Animation library for enhanced UX\n- **WebSocket Client** - Real-time communication with automatic reconnection\n\n### Backend Stack\n- **Node.js + Express.js** - Server runtime with TypeScript\n- **Drizzle ORM** - Type-safe database operations with PostgreSQL\n- **Kafka.js** - Enterprise-grade event streaming and message processing\n- **WebSocket (ws)** - Real-time bidirectional communication\n- **Passport.js** - Authentication middleware with OpenID Connect\n- **bcryptjs** - Password hashing for local authentication\n- **Zod** - Runtime type validation and schema definition\n- **Express Session** - Session management with PostgreSQL storage\n\n### Database & Storage\n- **PostgreSQL** - Primary database with ACID compliance\n- **Drizzle ORM** - Schema management and migrations\n- **connect-pg-simple** - PostgreSQL session store\n- **Database Design**:\n  - User management and authentication\n  - Security event storage (raw and normalized)\n  - OCSF (Open Cybersecurity Schema Framework) compliance\n  - Incident management and response tracking\n  - Machine learning feature vectors and model metrics\n\n### Event Streaming & Processing\n- **Apache Kafka** - Distributed event streaming platform\n- **OCSF Integration** - Open Cybersecurity Schema Framework compliance\n- **Dual Format Support** - Custom SecurityEvent and standardized OCSF formats\n- **Real-time Processing** - Live event transformation and routing\n- **Topic Management** - Organized event streams by type and source\n\n### Security & Compliance\n- **OCSF Schema Framework** - Industry-standard cybersecurity event format\n- **OAuth 2.0/OIDC** - Secure authentication via Replit\n- **Session Security** - HTTP-only cookies with secure flags\n- **Input Validation** - Zod schemas for runtime type checking\n- **CORS Protection** - Cross-origin request security\n\n## 🔐 Authentication System\n\nThe application uses **Replit OAuth 2.0/OIDC** for secure authentication:\n\n### Features\n- **Single Sign-On (SSO)** through Replit accounts\n- **Session Management** with PostgreSQL-backed storage\n- **Token Refresh** automatic renewal of expired tokens\n- **Protected Routes** middleware-based API protection\n- **Role-based Access** user roles and permissions\n\n### Authentication Flow\n1. User clicks \"Sign In\" on landing page\n2. Redirected to Replit OAuth authorization\n3. User authorizes the application\n4. Callback processes tokens and creates session\n5. User redirected to dashboard with authenticated session\n\n### Protected Endpoints\n- `GET /api/auth/user` - Get current user information\n- `GET /api/incidents` - Incident management (requires authentication)\n- `GET /api/sources` - Security sources configuration\n- `POST /api/alerts` - Alert processing endpoints\n\n## 🚀 Quick Start\n\n### Prerequisites\n- **Node.js** 18+ \n- **PostgreSQL** database\n- **Replit** account for authentication\n\n### Installation\n\n1. **Clone the repository**\n   ```bash\n   git clone <repository-url>\n   cd soc-dashboard\n   ```\n\n2. **Install dependencies**\n   ```bash\n   npm install\n   ```\n\n3. **Set up environment variables**\n   \n   Required environment variables (add to Replit Secrets):\n   ```\n   DATABASE_URL=postgresql://user:password@host:port/database\n   SESSION_SECRET=your-secure-session-secret\n   REPL_ID=your-replit-app-id\n   REPLIT_DOMAINS=your-replit-domain.replit.app\n   ```\n\n4. **Set up the database**\n   ```bash\n   npm run db:push\n   ```\n\n5. **Start the development server**\n   ```bash\n   npm run dev\n   ```\n\n6. **Access the application**\n   - Open your browser to the Replit preview URL\n   - Sign in with your Replit account\n\n## 🗄️ Database Schema\n\n### Core Tables\n\n#### Authentication & User Management\n- **users** - User accounts and profile information\n- **sessions** - PostgreSQL-backed authentication sessions\n\n#### Security Event Storage\n- **sources** - Security tool configurations (SIEM, EDR, Firewall, etc.)\n- **raw_alerts** - Unprocessed incoming security events from sources\n- **normalized_alerts** - Processed and standardized security alerts\n- **enhanced_normalized_alerts** - Extended alerts with OCSF correlation\n- **ocsf_events** - OCSF-compliant security events for compliance\n\n#### Incident Management\n- **incidents** - Security incident tracking and management\n- **actions** - Response actions and audit trail\n- **feedback** - Analyst feedback for continuous improvement\n\n#### Machine Learning & Analytics\n- **feature_vectors** - ML features extracted from security events\n- **model_metrics** - Performance tracking for ML models\n\n### OCSF Schema Integration\n\nThe system implements full **OCSF (Open Cybersecurity Schema Framework)** compliance:\n\n#### OCSF Event Classes Supported\n- **Class 1001** - System Activity (Process, File, Registry events)\n- **Class 2001** - Security Finding (Vulnerability, Threat detections)\n- **Class 3002** - Authentication (Login, Logout, Access events)\n- **Class 4001** - Network Activity (Connection, Traffic events)\n\n#### OCSF Storage Schema\n```sql\nCREATE TABLE ocsf_events (\n  id UUID PRIMARY KEY,\n  class_uid INTEGER NOT NULL,        -- OCSF class identifier\n  class_name VARCHAR(255) NOT NULL,  -- Human-readable class name\n  category_uid INTEGER NOT NULL,     -- OCSF category\n  category_name VARCHAR(255),        -- Category description\n  activity_id INTEGER NOT NULL,      -- Specific activity type\n  activity_name VARCHAR(255),        -- Activity description\n  severity_id INTEGER NOT NULL,      -- Numeric severity (0-5)\n  severity VARCHAR(50),              -- Severity label\n  time TIMESTAMP NOT NULL,           -- Event timestamp\n  message TEXT,                      -- Event description\n  raw_data JSONB NOT NULL,          -- Full OCSF event data\n  observables TEXT,                  -- IOCs and artifacts\n  created_at TIMESTAMP DEFAULT NOW(),\n  INDEX (class_uid, time),           -- Performance optimization\n  INDEX (severity_id, time),         -- Severity-based queries\n  INDEX (category_uid)               -- Category filtering\n);\n```\n\n### Schema Management\n```bash\n# Push schema changes to database\nnpm run db:push\n\n# Generate schema migrations\nnpm run db:generate\n\n# View database in Drizzle Studio\nnpm run db:studio\n\n# Reset database (development only)\nnpm run db:reset\n```\n\n## 🔧 Development\n\n### Development Workflow\n```bash\n# Start development server with hot reload\nnpm run dev\n\n# Type checking\nnpm run type-check\n\n# Build for production\nnpm run build\n\n# Preview production build\nnpm run preview\n```\n\n### Project Structure\n```\n├── client/                     # Frontend React application\n│   ├── src/\n│   │   ├── components/         # Reusable UI components\n│   │   │   ├── ui/            # shadcn/ui base components\n│   │   │   ├── dashboard/     # Dashboard-specific components\n│   │   │   ├── alerts/        # Alert management components\n│   │   │   └── incidents/     # Incident response components\n│   │   ├── pages/             # Page components and routes\n│   │   │   ├── dashboard.tsx  # Main SOC dashboard\n│   │   │   ├── alerts.tsx     # Alert management page\n│   │   │   ├── incidents.tsx  # Incident tracking page\n│   │   │   ├── sources.tsx    # Source configuration\n│   │   │   ├── login.tsx      # Authentication page\n│   │   │   └── register.tsx   # User registration\n│   │   ├── hooks/             # Custom React hooks\n│   │   │   ├── useAuth.ts     # Authentication hook\n│   │   │   ├── useWebSocket.ts # WebSocket connection\n│   │   │   └── use-toast.ts   # Toast notifications\n│   │   ├── lib/               # Utility functions\n│   │   │   ├── queryClient.ts # TanStack Query configuration\n│   │   │   ├── authUtils.ts   # Authentication utilities\n│   │   │   └── websocket.ts   # WebSocket client\n│   │   └── App.tsx            # Main application component\n├── server/                     # Backend Express application\n│   ├── db.ts                  # Database connection (Drizzle + Neon)\n│   ├── routes.ts              # Main API route definitions\n│   ├── storage.ts             # Data access layer (IStorage interface)\n│   ├── replitAuth.ts          # Replit OAuth configuration\n│   ├── kafka.ts               # Kafka event streaming service\n│   ├── ocsf.ts                # OCSF schema and transformation\n│   ├── websocket.ts           # WebSocket server implementation\n│   ├── vite.ts                # Vite middleware for development\n│   └── index.ts               # Server entry point\n├── shared/                     # Shared TypeScript definitions\n│   └── schema.ts              # Database schema and Zod validation\n├── drizzle.config.ts          # Drizzle ORM configuration\n├── vite.config.ts             # Vite build configuration\n├── tailwind.config.ts         # Tailwind CSS configuration\n└── package.json               # Dependencies and scripts\n```\n\n### Code Quality\n- **TypeScript** for type safety across frontend and backend\n- **ESLint** for code linting and consistency\n- **Path aliases** (@, @shared) for clean imports\n- **Strict mode** enabled for enhanced type checking\n\n## 🔌 Complete API Reference\n\n### Authentication Endpoints\n\n#### OAuth 2.0/OIDC Flow\n```http\nGET /api/login              # Initiate OAuth login flow\nGET /api/logout             # End user session and logout  \nGET /api/callback           # OAuth callback handler\nGET /api/auth/user          # Get current authenticated user\n```\n\n**Example Response** - `GET /api/auth/user`:\n```json\n{\n  \"id\": \"user-uuid\",\n  \"email\": \"analyst@company.com\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Smith\",\n  \"role\": \"analyst\",\n  \"createdAt\": \"2024-01-01T00:00:00Z\"\n}\n```\n\n### Dashboard & Analytics\n\n```http\nGET /api/dashboard/stats    # Dashboard statistics and KPIs\nGET /api/dashboard/metrics  # Real-time security metrics\nGET /api/dashboard/trends   # Historical trend analysis\n```\n\n**Example** - `GET /api/dashboard/stats`:\n```json\n{\n  \"totalAlerts\": 1247,\n  \"criticalAlerts\": 23,\n  \"openIncidents\": 8,\n  \"avgResponseTime\": \"4.2 minutes\",\n  \"sourceStatus\": {\n    \"online\": 12,\n    \"offline\": 1,\n    \"degraded\": 0\n  }\n}\n```\n\n### Security Event Ingestion\n\n#### Custom Format Ingestion\n```http\nPOST /api/events/siem       # Ingest SIEM alerts\nPOST /api/events/edr        # Ingest EDR events\nPOST /api/events/firewall   # Ingest firewall alerts\nPOST /api/events/generic    # Generic security events\n```\n\n**Example** - `POST /api/events/siem`:\n```json\n{\n  \"id\": \"siem-2024-001\",\n  \"timestamp\": \"2024-01-15T14:30:00Z\",\n  \"source\": \"Splunk-SIEM\",\n  \"severity\": \"high\",\n  \"type\": \"intrusion\",\n  \"title\": \"Suspicious Network Activity Detected\",\n  \"description\": \"Multiple failed login attempts from external IP\",\n  \"metadata\": {\n    \"source_ip\": \"192.168.1.100\",\n    \"destination_ip\": \"10.0.1.50\",\n    \"user\": \"john.smith\",\n    \"rule_id\": \"SIEM-LOGIN-001\"\n  },\n  \"raw_data\": {\n    \"protocol\": \"SSH\",\n    \"attempts\": 15,\n    \"time_window\": \"5 minutes\"\n  }\n}\n```\n\n### OCSF (Open Cybersecurity Schema Framework) API\n\n#### OCSF Event Ingestion\n```http\nPOST /api/ocsf/events                    # Generic OCSF event ingestion\nPOST /api/ocsf/events/bulk              # Bulk OCSF event ingestion\nPOST /api/ocsf/network-activity         # Network Activity (Class 4001)\nPOST /api/ocsf/system-activity          # System Activity (Class 1001) \nPOST /api/ocsf/security-finding         # Security Finding (Class 2001)\nPOST /api/ocsf/authentication           # Authentication (Class 3002)\n```\n\n#### OCSF Event Retrieval\n```http\nGET /api/ocsf/events                     # List OCSF events with filtering\nGET /api/ocsf/events/:id                 # Get specific OCSF event\nGET /api/ocsf/events/class/:class_uid    # Get events by OCSF class\nGET /api/ocsf/validate                   # Validate OCSF event structure\n```\n\n**Example** - `POST /api/ocsf/network-activity`:\n```json\n{\n  \"activity_id\": 2,\n  \"activity_name\": \"Denied\",\n  \"category_name\": \"Network Activity\",\n  \"category_uid\": 4,\n  \"class_name\": \"Network Activity\",\n  \"class_uid\": 4001,\n  \"message\": \"Network connection blocked by firewall\",\n  \"metadata\": {\n    \"logged_time\": 1705329000000,\n    \"product\": {\n      \"name\": \"Palo Alto Firewall\",\n      \"vendor_name\": \"Palo Alto Networks\",\n      \"version\": \"10.2.0\"\n    },\n    \"version\": \"1.1.0\"\n  },\n  \"severity\": \"Medium\",\n  \"severity_id\": 3,\n  \"time\": 1705329000000,\n  \"type_name\": \"Network Activity: Denied\",\n  \"type_uid\": 400102,\n  \"src_endpoint\": {\n    \"ip\": \"192.168.1.100\",\n    \"hostname\": \"workstation-01\"\n  },\n  \"dst_endpoint\": {\n    \"ip\": \"203.0.113.15\",\n    \"port\": 443\n  },\n  \"connection_info\": {\n    \"protocol_name\": \"HTTPS\",\n    \"direction\": \"Outbound\"\n  },\n  \"disposition\": \"Blocked\",\n  \"disposition_id\": 2\n}\n```\n\n### Legacy to OCSF Transformation\n```http\nPOST /api/ocsf/transform/siem           # Transform SIEM event to OCSF\nPOST /api/ocsf/transform/edr            # Transform EDR event to OCSF  \nPOST /api/ocsf/transform/firewall       # Transform firewall event to OCSF\n```\n\n### Alert & Incident Management\n\n#### Alerts\n```http\nGET /api/alerts                         # List security alerts with filtering\nGET /api/alerts/:id                     # Get specific alert details\nPUT /api/alerts/:id/status              # Update alert status\nPOST /api/alerts/:id/acknowledge        # Acknowledge alert\nPOST /api/alerts/:id/escalate           # Escalate to incident\n```\n\n**Query Parameters** - `GET /api/alerts`:\n```\n?severity=high,critical     # Filter by severity\n&status=open               # Filter by status  \n&source=firewall           # Filter by source type\n&from=2024-01-01           # Date range start\n&to=2024-01-31             # Date range end\n&limit=50                  # Pagination limit\n&offset=0                  # Pagination offset\n```\n\n#### Incidents\n```http\nGET /api/incidents                      # List security incidents\nPOST /api/incidents                     # Create new incident\nGET /api/incidents/:id                  # Get incident details\nPUT /api/incidents/:id                  # Update incident\nPOST /api/incidents/:id/assign          # Assign incident to analyst\nPOST /api/incidents/:id/close           # Close incident\nGET /api/incidents/:id/timeline         # Get incident timeline\n```\n\n### Source Management\n\n```http\nGET /api/sources                        # List configured security sources\nPOST /api/sources                       # Add new security source\nGET /api/sources/:id                    # Get source configuration\nPUT /api/sources/:id                    # Update source configuration\nDELETE /api/sources/:id                 # Remove security source\nGET /api/sources/:id/health             # Check source health status\n```\n\n**Example** - `POST /api/sources`:\n```json\n{\n  \"name\": \"Primary Firewall\",\n  \"type\": \"firewall\",\n  \"vendor\": \"Palo Alto Networks\",\n  \"config\": {\n    \"host\": \"firewall.company.com\",\n    \"port\": 514,\n    \"protocol\": \"syslog\",\n    \"api_key\": \"encrypted-key\"\n  },\n  \"enabled\": true\n}\n```\n\n### Machine Learning Integration\n\n```http\nPOST /api/ml/analyze                    # Analyze event with ML models\nGET /api/ml/models                      # List available ML models\nPOST /api/ml/feedback                   # Submit analyst feedback\nGET /api/ml/metrics                     # Get model performance metrics\n```\n\n### WebSocket Real-time API\n\n**Connection**: `ws://your-domain/ws`\n\n#### Client Events (Send to Server)\n```json\n{\"type\": \"subscribe\", \"channel\": \"alerts\"}     # Subscribe to alerts\n{\"type\": \"subscribe\", \"channel\": \"incidents\"}  # Subscribe to incidents\n{\"type\": \"heartbeat\"}                          # Keep connection alive\n```\n\n#### Server Events (Received from Server)\n```json\n{\"type\": \"security_event\", \"data\": {...}}      # New security event\n{\"type\": \"incident_update\", \"data\": {...}}     # Incident status change\n{\"type\": \"system_status\", \"data\": {...}}       # System health update\n{\"type\": \"connection_status\", \"status\": \"connected\"} # Connection status\n```\n\n### Error Handling\n\nAll endpoints return consistent error format:\n```json\n{\n  \"error\": \"ValidationError\",\n  \"message\": \"Invalid event format\",\n  \"details\": {\n    \"field\": \"timestamp\",\n    \"reason\": \"Invalid date format\"\n  },\n  \"timestamp\": \"2024-01-15T14:30:00Z\"\n}\n```\n\n**HTTP Status Codes**:\n- `200` - Success\n- `201` - Created successfully\n- `400` - Bad request / validation error\n- `401` - Unauthorized / authentication required\n- `403` - Forbidden / insufficient permissions\n- `404` - Resource not found\n- `422` - Unprocessable entity / business logic error\n- `500` - Internal server error\n\n## 🌟 Features in Detail\n\n### Real-time Monitoring\n- Live alert feed with automatic updates\n- Connection status indicators\n- Toast notifications for critical events\n- Automatic reconnection handling\n\n### Incident Management\n- Create, assign, and track security incidents\n- Severity classification and prioritization\n- Response workflow automation\n- Timeline tracking and audit logs\n\n### Analytics Dashboard\n- Security metrics and KPIs\n- Threat trend analysis\n- Performance dashboards\n- Automated reporting\n\n### Source Integration\n- SIEM integration (Splunk, QRadar, etc.)\n- EDR tool connectivity\n- Firewall and network security tools\n- Custom source configuration\n\n## 🤝 Contributing\n\n1. **Fork the repository**\n2. **Create a feature branch** (`git checkout -b feature/new-feature`)\n3. **Commit your changes** (`git commit -am 'Add new feature'`)\n4. **Push to the branch** (`git push origin feature/new-feature`)\n5. **Create a Pull Request**\n\n### Development Guidelines\n- Follow TypeScript best practices\n- Use existing component patterns\n- Maintain consistent code style\n- Add tests for new functionality\n- Update documentation as needed\n\n## 📄 License\n\nThis project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.\n\n## 🆘 Support\n\nFor support and questions:\n- Create an issue in the repository\n- Contact the development team\n- Check the documentation and troubleshooting guides\n\n## 🔧 Troubleshooting\n\n### Common Issues\n\n**Authentication not working:**\n- Verify `SESSION_SECRET` is set in environment variables\n- Check `REPL_ID` and `REPLIT_DOMAINS` configuration\n- Ensure database connection is established\n\n**Database connection errors:**\n- Verify `DATABASE_URL` is correctly formatted\n- Run `npm run db:push` to ensure schema is up to date\n- Check PostgreSQL service is running\n\n**Real-time updates not working:**\n- Verify WebSocket connection in browser network tab\n- Check for firewall or proxy blocking WebSocket connections\n- Restart the development server\n\n**Build errors:**\n- Run `npm run type-check` to identify TypeScript issues\n- Clear node_modules and reinstall dependencies\n- Check for syntax errors in recent changes\n\n## 🤖 AI/ML Integration Architecture\n\n### Machine Learning Pipeline\n\nThe SOC Dashboard is designed for seamless AI/ML model integration with a comprehensive pipeline for threat detection and analysis:\n\n#### 1. Feature Engineering\n```typescript\ninterface FeatureVector {\n  id: string;\n  alertId: string;\n  features: Record<string, number>;  // Normalized feature values\n  timestamp: Date;\n  modelVersion: string;\n}\n```\n\n**Supported Features**:\n- **Network Features**: IP reputation, geolocation, traffic patterns\n- **Behavioral Features**: User activity patterns, access anomalies\n- **Temporal Features**: Time-based patterns, frequency analysis\n- **Content Features**: File hashes, email content, URL analysis\n- **Contextual Features**: Historical data, threat intelligence correlation\n\n#### 2. Model Integration Patterns\n\n##### Real-time Model Inference\n```javascript\n// Example: Integrate custom ML model\nclass MLModelIntegration {\n  async analyzeSecurityEvent(event) {\n    // Extract features\n    const features = await this.extractFeatures(event);\n    \n    // Call ML model API\n    const prediction = await fetch('/ml/api/predict', {\n      method: 'POST',\n      body: JSON.stringify({ features }),\n      headers: { 'Content-Type': 'application/json' }\n    });\n    \n    // Store results\n    await storage.storeMLPrediction({\n      alertId: event.id,\n      prediction: prediction.confidence,\n      modelId: 'threat-classifier-v2',\n      features\n    });\n    \n    return prediction;\n  }\n}\n```\n\n##### Batch Processing Pipeline\n```javascript\n// Process alerts in batches for training data\nexport async function generateTrainingData() {\n  const alerts = await storage.getAlertsForTraining();\n  const trainingData = [];\n  \n  for (const alert of alerts) {\n    const features = await extractMLFeatures(alert);\n    const label = alert.analystFeedback?.isThreat ? 1 : 0;\n    \n    trainingData.push({\n      features,\n      label,\n      metadata: {\n        alertId: alert.id,\n        timestamp: alert.timestamp,\n        sourceType: alert.source\n      }\n    });\n  }\n  \n  return trainingData;\n}\n```\n\n#### 3. Supported ML Frameworks & APIs\n\n##### Cloud ML Services Integration\n```javascript\n// AWS SageMaker Integration\nconst sagemakerConfig = {\n  endpoint: process.env.SAGEMAKER_ENDPOINT,\n  region: 'us-east-1',\n  modelName: 'cybersecurity-threat-detection'\n};\n\n// Azure ML Integration\nconst azureMLConfig = {\n  endpoint: process.env.AZURE_ML_ENDPOINT,\n  apiKey: process.env.AZURE_ML_API_KEY,\n  modelName: 'anomaly-detector-v3'\n};\n\n// Google Vertex AI Integration\nconst vertexAIConfig = {\n  projectId: process.env.GOOGLE_PROJECT_ID,\n  location: 'us-central1',\n  modelId: 'security-classifier'\n};\n```\n\n##### On-Premise Model Integration\n```javascript\n// TensorFlow Serving Integration\nconst tensorflowConfig = {\n  modelServerUrl: 'http://tensorflow-serving:8501',\n  modelName: 'threat_detection_model',\n  version: 'latest'\n};\n\n// Custom Model API Integration\nconst customModelConfig = {\n  endpoint: process.env.CUSTOM_MODEL_ENDPOINT,\n  authToken: process.env.MODEL_API_TOKEN,\n  timeout: 5000\n};\n```\n\n#### 4. Model Performance Monitoring\n\n**Database Schema for Model Metrics**:\n```sql\nCREATE TABLE model_metrics (\n  id UUID PRIMARY KEY,\n  model_id VARCHAR(255) NOT NULL,\n  model_version VARCHAR(50) NOT NULL,\n  metric_type VARCHAR(50) NOT NULL,    -- 'accuracy', 'precision', 'recall', 'f1'\n  metric_value DECIMAL(5,4) NOT NULL,\n  evaluation_date TIMESTAMP NOT NULL,\n  dataset_size INTEGER,\n  created_at TIMESTAMP DEFAULT NOW()\n);\n```\n\n**Performance Tracking API**:\n```javascript\n// Track model performance\nPOST /api/ml/metrics\n{\n  \"modelId\": \"threat-detector-v2\",\n  \"modelVersion\": \"2.1.0\",\n  \"metrics\": {\n    \"accuracy\": 0.9234,\n    \"precision\": 0.8876,\n    \"recall\": 0.9456,\n    \"f1_score\": 0.9156\n  },\n  \"evaluationDataset\": \"test-set-2024-01\",\n  \"sampleSize\": 10000\n}\n```\n\n#### 5. Feature Store Implementation\n\n```javascript\n// Feature extraction for different event types\nclass FeatureExtractor {\n  \n  // Network-based features\n  extractNetworkFeatures(event) {\n    return {\n      src_ip_reputation: this.getIPReputation(event.metadata.source_ip),\n      dst_ip_geolocation: this.getGeolocation(event.metadata.destination_ip),\n      connection_frequency: this.getConnectionFrequency(event),\n      port_risk_score: this.getPortRiskScore(event.metadata.port),\n      traffic_volume: event.raw_data.bytes || 0,\n      protocol_anomaly: this.detectProtocolAnomaly(event)\n    };\n  }\n  \n  // Behavioral features\n  extractBehavioralFeatures(event) {\n    return {\n      user_activity_score: this.getUserActivityScore(event.metadata.user),\n      time_of_day_anomaly: this.getTimeAnomalyScore(event.timestamp),\n      access_pattern_deviation: this.getAccessPatternScore(event),\n      historical_frequency: this.getHistoricalFrequency(event)\n    };\n  }\n  \n  // Content-based features\n  extractContentFeatures(event) {\n    return {\n      file_hash_reputation: this.getHashReputation(event.metadata.file_hash),\n      file_entropy: this.calculateFileEntropy(event),\n      string_analysis: this.analyzeStrings(event.raw_data),\n      similarity_to_known_threats: this.getThreatSimilarity(event)\n    };\n  }\n}\n```\n\n#### 6. Real-time Model Inference Pipeline\n\n```javascript\n// Real-time inference service\nclass RealTimeMLService {\n  \n  async processSecurityEvent(event) {\n    try {\n      // 1. Feature extraction\n      const features = await this.extractFeatures(event);\n      \n      // 2. Model inference\n      const predictions = await Promise.all([\n        this.runThreatClassifier(features),\n        this.runAnomalyDetector(features),\n        this.runRiskScorer(features)\n      ]);\n      \n      // 3. Ensemble results\n      const ensemblePrediction = this.combineModelOutputs(predictions);\n      \n      // 4. Store results\n      await this.storeMLResults(event.id, {\n        threatScore: ensemblePrediction.threatScore,\n        anomalyScore: ensemblePrediction.anomalyScore,\n        riskLevel: ensemblePrediction.riskLevel,\n        confidence: ensemblePrediction.confidence,\n        modelVersions: predictions.map(p => p.modelVersion),\n        features\n      });\n      \n      // 5. Trigger automated responses if needed\n      if (ensemblePrediction.threatScore > 0.8) {\n        await this.triggerAutomatedResponse(event, ensemblePrediction);\n      }\n      \n      return ensemblePrediction;\n      \n    } catch (error) {\n      console.error('ML inference failed:', error);\n      // Graceful fallback to rule-based detection\n      return this.fallbackRuleBasedDetection(event);\n    }\n  }\n  \n  // Automated response actions\n  async triggerAutomatedResponse(event, prediction) {\n    const actions = [];\n    \n    if (prediction.threatScore > 0.9) {\n      // High confidence threat - immediate action\n      actions.push({\n        type: 'block_ip',\n        target: event.metadata.source_ip,\n        duration: '1h'\n      });\n      \n      actions.push({\n        type: 'create_incident',\n        severity: 'critical',\n        title: `High-confidence threat detected: ${event.title}`,\n        autoAssign: true\n      });\n    } else if (prediction.threatScore > 0.8) {\n      // Medium-high confidence - alert analyst\n      actions.push({\n        type: 'escalate_alert',\n        priority: 'high',\n        notify: ['security-team@company.com']\n      });\n    }\n    \n    // Execute actions\n    for (const action of actions) {\n      await this.executeAutomatedAction(action);\n    }\n  }\n}\n```\n\n#### 7. Training Data Pipeline\n\n```javascript\n// Training data generation and export\nclass TrainingDataPipeline {\n  \n  async generateTrainingDataset(options = {}) {\n    const {\n      startDate = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000), // 30 days ago\n      endDate = new Date(),\n      includeLabels = true,\n      format = 'json' // 'json', 'csv', 'parquet'\n    } = options;\n    \n    // Get labeled data from analyst feedback\n    const labeledAlerts = await storage.getLabeledAlerts(startDate, endDate);\n    \n    const trainingData = [];\n    \n    for (const alert of labeledAlerts) {\n      const features = await this.extractAllFeatures(alert);\n      const record = {\n        id: alert.id,\n        timestamp: alert.timestamp,\n        features,\n        metadata: {\n          source: alert.source,\n          type: alert.type,\n          severity: alert.severity\n        }\n      };\n      \n      if (includeLabels && alert.analystFeedback) {\n        record.labels = {\n          isThreat: alert.analystFeedback.isThreat,\n          threatType: alert.analystFeedback.threatType,\n          falsePositive: alert.analystFeedback.falsePositive,\n          severity: alert.analystFeedback.severity\n        };\n      }\n      \n      trainingData.push(record);\n    }\n    \n    // Export in requested format\n    return this.exportTrainingData(trainingData, format);\n  }\n  \n  // Export to different formats\n  exportTrainingData(data, format) {\n    switch (format) {\n      case 'csv':\n        return this.exportToCSV(data);\n      case 'parquet':\n        return this.exportToParquet(data);\n      case 'json':\n      default:\n        return JSON.stringify(data, null, 2);\n    }\n  }\n}\n```\n\n#### 8. Model A/B Testing Framework\n\n```javascript\n// A/B testing for different models\nclass ModelABTesting {\n  \n  async evaluateModels(eventBatch, modelConfigs) {\n    const results = {};\n    \n    for (const [modelName, config] of Object.entries(modelConfigs)) {\n      const predictions = [];\n      \n      for (const event of eventBatch) {\n        const prediction = await this.runModel(event, config);\n        predictions.push({\n          eventId: event.id,\n          prediction,\n          processingTime: prediction.processingTime,\n          confidence: prediction.confidence\n        });\n      }\n      \n      // Calculate metrics\n      results[modelName] = {\n        avgConfidence: this.calculateAvgConfidence(predictions),\n        avgProcessingTime: this.calculateAvgProcessingTime(predictions),\n        threatDetectionRate: this.calculateDetectionRate(predictions),\n        falsePositiveRate: this.calculateFalsePositiveRate(predictions)\n      };\n    }\n    \n    return results;\n  }\n}\n```\n\n#### 9. Integration Examples\n\n##### Integrate with Hugging Face Models\n```javascript\n// Hugging Face Transformers integration\nconst huggingFaceConfig = {\n  endpoint: 'https://api-inference.huggingface.co/models/',\n  apiKey: process.env.HUGGING_FACE_API_KEY,\n  models: {\n    textClassifier: 'microsoft/DialoGPT-medium',\n    anomalyDetector: 'microsoft/unilm-base-cased'\n  }\n};\n\nclass HuggingFaceIntegration {\n  async analyzeLogText(logText) {\n    const response = await fetch(\n      `${huggingFaceConfig.endpoint}${huggingFaceConfig.models.textClassifier}`,\n      {\n        headers: { Authorization: `Bearer ${huggingFaceConfig.apiKey}` },\n        method: 'POST',\n        body: JSON.stringify({ inputs: logText })\n      }\n    );\n    return response.json();\n  }\n}\n```\n\n##### Custom PyTorch/TensorFlow Model Integration\n```javascript\n// Custom model server integration\nclass CustomModelIntegration {\n  async predictThreat(features) {\n    // Prepare features in model-expected format\n    const modelInput = this.preprocessFeatures(features);\n    \n    const response = await fetch('http://ml-model-server:5000/predict', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ features: modelInput })\n    });\n    \n    const prediction = await response.json();\n    \n    return {\n      threatScore: prediction.probability,\n      confidence: prediction.confidence,\n      modelVersion: prediction.model_version,\n      processingTime: prediction.processing_time_ms\n    };\n  }\n}\n```\n\n### ML Development Workflow\n\n1. **Data Collection**: Use `/api/ml/training-data` to export labeled datasets\n2. **Feature Engineering**: Implement custom feature extractors in `FeatureExtractor`\n3. **Model Training**: Train models using exported data in your ML framework\n4. **Model Deployment**: Deploy model to inference endpoint\n5. **Integration**: Use ML integration patterns to connect your model\n6. **Monitoring**: Track performance using `/api/ml/metrics` endpoints\n7. **Iteration**: Use A/B testing framework to compare model versions\n\n---\n\n## 🔧 Advanced Configuration\n\n### Environment Variables Reference\n\n```bash\n# Database Configuration\nDATABASE_URL=postgresql://user:password@host:port/database\nPGHOST=your-postgres-host\nPGPORT=5432\nPGUSER=your-user\nPGPASSWORD=your-password\nPGDATABASE=soc_dashboard\n\n# Authentication\nSESSION_SECRET=your-super-secret-session-key\nREPL_ID=your-replit-app-id\nREPLIT_DOMAINS=your-domain.replit.app\n\n# Kafka Configuration (Optional)\nKAFKA_BROKERS=localhost:9092\nKAFKA_CLIENT_ID=soc-dashboard\nKAFKA_GROUP_ID=soc-dashboard-group\n\n# ML Model Configuration\nML_MODEL_ENDPOINT=https://your-ml-api.com/predict\nML_API_KEY=your-ml-api-key\nHUGGING_FACE_API_KEY=your-hf-api-key\nAWS_SAGEMAKER_ENDPOINT=your-sagemaker-endpoint\nAZURE_ML_ENDPOINT=your-azure-ml-endpoint\nGOOGLE_PROJECT_ID=your-gcp-project\n\n# Third-party Integrations\nTHREAT_INTEL_API_KEY=your-threat-intel-key\nIP_REPUTATION_API_KEY=your-ip-reputation-key\n```\n\n### Kafka Topics Configuration\n\n```javascript\n// Kafka topics for event streaming\nconst KAFKA_TOPICS = {\n  // Custom format topics\n  SECURITY_ALERTS: 'security-alerts',\n  INCIDENTS: 'incidents',\n  THREAT_INTEL: 'threat-intelligence',\n  SYSTEM_METRICS: 'system-metrics',\n  AUDIT_LOGS: 'audit-logs',\n  \n  // OCSF format topics\n  OCSF_NETWORK_ACTIVITY: 'ocsf-network-activity',    // Class 4001\n  OCSF_SYSTEM_ACTIVITY: 'ocsf-system-activity',      // Class 1001\n  OCSF_SECURITY_FINDING: 'ocsf-security-finding',    // Class 2001\n  OCSF_AUTHENTICATION: 'ocsf-authentication',        // Class 3002\n  \n  // ML and Analytics\n  ML_PREDICTIONS: 'ml-predictions',\n  FEATURE_VECTORS: 'feature-vectors',\n  MODEL_METRICS: 'model-metrics'\n};\n```\n\n### WebSocket Event Types\n\n```javascript\n// Client -> Server events\nconst CLIENT_EVENTS = {\n  SUBSCRIBE: 'subscribe',\n  UNSUBSCRIBE: 'unsubscribe',\n  HEARTBEAT: 'heartbeat',\n  ACK_ALERT: 'acknowledge_alert',\n  UPDATE_INCIDENT: 'update_incident'\n};\n\n// Server -> Client events\nconst SERVER_EVENTS = {\n  SECURITY_EVENT: 'security_event',\n  INCIDENT_UPDATE: 'incident_update',\n  SYSTEM_STATUS: 'system_status',\n  CONNECTION_STATUS: 'connection_status',\n  ML_PREDICTION: 'ml_prediction',\n  ALERT_ACKNOWLEDGED: 'alert_acknowledged'\n};\n```\n\n## 🎯 Use Cases & Examples\n\n### 1. SIEM Integration Example\n```bash\n# Send Splunk alert to SOC Dashboard\ncurl -X POST http://your-domain/api/events/siem \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"id\": \"splunk-alert-001\",\n    \"timestamp\": \"2024-01-15T14:30:00Z\",\n    \"source\": \"Splunk-SIEM\",\n    \"severity\": \"high\",\n    \"type\": \"intrusion\",\n    \"title\": \"Brute Force Attack Detected\",\n    \"description\": \"Multiple failed login attempts detected from external IP\",\n    \"metadata\": {\n      \"source_ip\": \"203.0.113.45\",\n      \"target_user\": \"admin\",\n      \"attempt_count\": 25,\n      \"rule_id\": \"SPLUNK-BF-001\"\n    },\n    \"raw_data\": {\n      \"search_query\": \"index=security action=login result=failure\",\n      \"event_count\": 25,\n      \"time_span\": \"5 minutes\"\n    }\n  }'\n```\n\n### 2. EDR Integration Example\n```bash\n# Send CrowdStrike detection to SOC Dashboard\ncurl -X POST http://your-domain/api/events/edr \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"id\": \"cs-detection-002\",\n    \"timestamp\": \"2024-01-15T15:45:00Z\",\n    \"source\": \"CrowdStrike-Falcon\",\n    \"severity\": \"critical\",\n    \"type\": \"malware\",\n    \"title\": \"Ransomware Activity Detected\",\n    \"description\": \"Suspicious file encryption behavior detected on endpoint\",\n    \"metadata\": {\n      \"hostname\": \"DESKTOP-ABC123\",\n      \"user\": \"john.smith\",\n      \"file_hash\": \"e3b0c44298fc1c149afbf4c8996fb924\",\n      \"process_name\": \"suspicious.exe\"\n    },\n    \"raw_data\": {\n      \"detection_type\": \"behavioral\",\n      \"confidence\": 95,\n      \"quarantine_status\": \"quarantined\"\n    }\n  }'\n```\n\n### 3. OCSF Network Activity Example\n```bash\n# Send OCSF-compliant network event\ncurl -X POST http://your-domain/api/ocsf/network-activity \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"activity_id\": 2,\n    \"activity_name\": \"Denied\",\n    \"category_name\": \"Network Activity\",\n    \"category_uid\": 4,\n    \"class_name\": \"Network Activity\",\n    \"class_uid\": 4001,\n    \"severity\": \"Medium\",\n    \"severity_id\": 3,\n    \"time\": 1705329000000,\n    \"message\": \"Outbound connection blocked by firewall rule\",\n    \"src_endpoint\": {\n      \"ip\": \"10.0.1.100\",\n      \"hostname\": \"workstation-01\"\n    },\n    \"dst_endpoint\": {\n      \"ip\": \"203.0.113.15\",\n      \"port\": 443\n    },\n    \"connection_info\": {\n      \"protocol_name\": \"HTTPS\",\n      \"direction\": \"Outbound\"\n    },\n    \"disposition\": \"Blocked\",\n    \"disposition_id\": 2,\n    \"metadata\": {\n      \"product\": {\n        \"name\": \"Palo Alto Firewall\",\n        \"vendor_name\": \"Palo Alto Networks\"\n      },\n      \"version\": \"1.1.0\"\n    }\n  }'\n```\n\n---\n\n**Built with ❤️ for cybersecurity professionals**","size_bytes":37998},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"replit.md":{"content":"# Overview\n\nThis is a full-stack Security Operations Center (SOC) dashboard application built with React frontend and Express.js backend. The system provides real-time monitoring, alert management, incident response, and analytics for cybersecurity operations. It features a modern dark-themed UI optimized for SOC environments with real-time WebSocket communication, comprehensive alert processing, and machine learning integration for automated threat detection.\n\n# User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n# System Architecture\n\n## Frontend Architecture\n- **Framework**: React 18 with TypeScript for type safety and modern development\n- **UI Components**: Radix UI with shadcn/ui component system for accessible, customizable components\n- **Styling**: Tailwind CSS with custom dark theme optimized for SOC environments\n- **State Management**: TanStack React Query for server state management and caching\n- **Routing**: Wouter for lightweight client-side routing\n- **Real-time Communication**: WebSocket integration for live updates and notifications\n- **Build Tool**: Vite for fast development and optimized production builds\n\n## Backend Architecture  \n- **Runtime**: Node.js with Express.js framework\n- **Language**: TypeScript with ES modules for modern JavaScript features\n- **Database ORM**: Drizzle ORM for type-safe database operations\n- **Real-time**: WebSocket server for broadcasting live updates to connected clients\n- **API Design**: RESTful endpoints with JSON communication\n- **Development**: Hot reload with Vite middleware integration\n\n## Database Design\n- **Database**: PostgreSQL with Drizzle ORM for schema management\n- **Schema Structure**:\n  - Users table for analyst/admin roles\n  - Sources table for security tool configurations (SIEM, EDR, Firewall)\n  - Raw alerts table for incoming security events\n  - Normalized alerts table for processed/standardized alerts\n  - Feature vectors table for ML-based analysis\n  - Incidents table for security incident management\n  - Actions table for response tracking\n  - Feedback table for analyst input and model improvement\n  - Model metrics table for performance monitoring\n- **Migrations**: Drizzle Kit for schema versioning and deployment\n\n## Real-time Communication\n- **WebSocket Server**: Integrated with HTTP server for bidirectional communication\n- **Connection Management**: Automatic reconnection with status indicators\n- **Event Broadcasting**: Real-time alerts, incident updates, and system notifications\n- **Client Handling**: Graceful connection management with cleanup on disconnect\n\n## Security and Authentication\n- **Session Management**: Connect-pg-simple for PostgreSQL-backed sessions\n- **Role-based Access**: Analyst and admin user roles with appropriate permissions\n- **Data Validation**: Zod schemas for runtime type checking and validation\n- **Input Sanitization**: Form validation with React Hook Form and Zod resolvers\n\n## UI/UX Design Patterns\n- **Component Architecture**: Modular, reusable components with consistent design patterns\n- **Responsive Design**: Mobile-first approach with breakpoint-specific layouts\n- **Accessibility**: WCAG compliance through Radix UI primitives\n- **Dark Theme**: SOC-optimized color scheme with high contrast for extended use\n- **Loading States**: Skeleton components and loading indicators for better UX\n- **Error Handling**: Toast notifications and error boundaries for user feedback\n\n## Development Workflow\n- **Type Safety**: End-to-end TypeScript with shared schemas between frontend/backend\n- **Code Quality**: ESLint and TypeScript compiler checks\n- **Development Server**: Vite with HMR and Express.js middleware integration\n- **Build Process**: Separate client and server builds with optimized outputs\n- **Path Aliases**: Simplified imports with @ and @shared path mapping\n\n# External Dependencies\n\n## Core Framework Dependencies\n- **@neondatabase/serverless**: Neon PostgreSQL serverless database driver\n- **drizzle-orm**: Type-safe ORM with PostgreSQL dialect support\n- **express**: Web application framework for Node.js\n- **react**: UI library with hooks and modern features\n- **vite**: Build tool and development server\n\n## UI and Component Libraries  \n- **@radix-ui/***: Accessible, unstyled UI primitives (dialogs, forms, navigation)\n- **tailwindcss**: Utility-first CSS framework\n- **class-variance-authority**: Component variant system\n- **lucide-react**: Icon library with React components\n\n## Data and State Management\n- **@tanstack/react-query**: Server state management and caching\n- **react-hook-form**: Form handling with validation\n- **@hookform/resolvers**: Form validation resolvers\n- **zod**: Runtime type validation and schema definition\n\n## Development and Build Tools\n- **typescript**: Static type checking\n- **tsx**: TypeScript execution for development\n- **esbuild**: Fast JavaScript bundler for production\n- **@replit/vite-plugin-***: Replit-specific development plugins\n\n## Real-time and Communication\n- **ws**: WebSocket library for real-time communication\n- **connect-pg-simple**: PostgreSQL session store\n\n## Utilities and Helpers\n- **date-fns**: Date manipulation library\n- **clsx**: Conditional CSS class utility\n- **cmdk**: Command palette component\n- **nanoid**: URL-safe unique ID generator","size_bytes":5293},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2627},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"server/alertCorrelation.ts":{"content":"import { storage } from \"./storage\";\nimport { ThreatIntelligenceService } from \"./threatIntelligence\";\nimport { type RawAlert, type InsertIncident } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\nexport interface CorrelationRule {\n  id: string;\n  name: string;\n  description: string;\n  enabled: boolean;\n  conditions: {\n    severityThreshold?: string;\n    alertCount?: number;\n    timeWindow?: number; // minutes\n    sourceTypes?: string[];\n    keywordMatches?: string[];\n  };\n  actions: {\n    createIncident: boolean;\n    escalate: boolean;\n    notifyAnalyst: boolean;\n  };\n}\n\nexport interface CorrelationResult {\n  shouldCreateIncident: boolean;\n  incidentSeverity: 'low' | 'medium' | 'high' | 'critical';\n  incidentTitle: string;\n  incidentDescription: string;\n  confidence: number;\n  relatedAlerts: RawAlert[];\n  triggeredRules: CorrelationRule[];\n  threatIntelligence?: {\n    indicators: any[];\n    riskScore: number;\n    threats: any[];\n    recommendations: string[];\n  };\n}\n\nexport class AlertCorrelationEngine {\n  private static defaultRules: CorrelationRule[] = [\n    {\n      id: \"critical-alert-rule\",\n      name: \"Critical Alert Auto-Escalation\",\n      description: \"Automatically create incidents for critical severity alerts\",\n      enabled: true,\n      conditions: {\n        severityThreshold: \"critical\"\n      },\n      actions: {\n        createIncident: true,\n        escalate: true,\n        notifyAnalyst: true\n      }\n    },\n    {\n      id: \"multiple-high-alerts\",\n      name: \"Multiple High Severity Alerts\",\n      description: \"Create incident when 3+ high severity alerts occur within 30 minutes\",\n      enabled: true,\n      conditions: {\n        severityThreshold: \"high\",\n        alertCount: 3,\n        timeWindow: 30\n      },\n      actions: {\n        createIncident: true,\n        escalate: false,\n        notifyAnalyst: true\n      }\n    },\n    {\n      id: \"ransomware-indicators\",\n      name: \"Ransomware Activity Detection\",\n      description: \"Detect potential ransomware based on file encryption patterns\",\n      enabled: true,\n      conditions: {\n        keywordMatches: [\"encrypt\", \"ransom\", \"locked\", \"decrypt\", \"bitcoin\", \"payment\"]\n      },\n      actions: {\n        createIncident: true,\n        escalate: true,\n        notifyAnalyst: true\n      }\n    },\n    {\n      id: \"privilege-escalation\",\n      name: \"Privilege Escalation Pattern\",\n      description: \"Detect privilege escalation attempts\",\n      enabled: true,\n      conditions: {\n        keywordMatches: [\"privilege\", \"escalation\", \"admin\", \"root\", \"sudo\", \"elevation\"]\n      },\n      actions: {\n        createIncident: true,\n        escalate: false,\n        notifyAnalyst: true\n      }\n    },\n    {\n      id: \"data-exfiltration\",\n      name: \"Data Exfiltration Detection\",\n      description: \"Detect potential data exfiltration activities\",\n      enabled: true,\n      conditions: {\n        keywordMatches: [\"exfiltration\", \"transfer\", \"upload\", \"download\", \"copy\", \"steal\"]\n      },\n      actions: {\n        createIncident: true,\n        escalate: true,\n        notifyAnalyst: true\n      }\n    }\n  ];\n\n  static async correlateAlert(alert: RawAlert): Promise<CorrelationResult> {\n    const recentAlerts = await this.getRecentAlerts(60); // Last 60 minutes\n    const triggeredRules: CorrelationRule[] = [];\n    let shouldCreateIncident = false;\n    let incidentSeverity: 'low' | 'medium' | 'high' | 'critical' = 'medium';\n    let confidence = 0.5;\n\n    // Check each correlation rule\n    for (const rule of this.defaultRules) {\n      if (!rule.enabled) continue;\n\n      const ruleTriggered = await this.evaluateRule(rule, alert, recentAlerts);\n      if (ruleTriggered) {\n        triggeredRules.push(rule);\n        \n        if (rule.actions.createIncident) {\n          shouldCreateIncident = true;\n        }\n\n        // Determine severity based on rule type\n        if (rule.id === \"critical-alert-rule\" || rule.id === \"ransomware-indicators\") {\n          incidentSeverity = 'critical';\n          confidence = Math.max(confidence, 0.9);\n        } else if (rule.id === \"data-exfiltration\" || rule.id === \"multiple-high-alerts\") {\n          incidentSeverity = 'high';\n          confidence = Math.max(confidence, 0.8);\n        } else {\n          incidentSeverity = 'medium';\n          confidence = Math.max(confidence, 0.6);\n        }\n      }\n    }\n\n    // Threat intelligence enrichment\n    const threatEnrichment = await ThreatIntelligenceService.enrichAlert(alert);\n    \n    // Machine learning-based correlation (simplified)\n    const mlScore = await this.calculateMLScore(alert, recentAlerts);\n    confidence = Math.max(confidence, mlScore);\n\n    // Factor in threat intelligence risk score\n    if (threatEnrichment.riskScore > 5) {\n      confidence = Math.max(confidence, threatEnrichment.riskScore / 10);\n      \n      if (threatEnrichment.riskScore >= 7 && !shouldCreateIncident) {\n        shouldCreateIncident = true;\n        incidentSeverity = 'critical';\n      } else if (threatEnrichment.riskScore >= 4 && !shouldCreateIncident) {\n        shouldCreateIncident = true;\n        incidentSeverity = 'high';\n      }\n    }\n\n    // If ML score is very high, create incident even if no rules triggered\n    if (mlScore > 0.85 && !shouldCreateIncident) {\n      shouldCreateIncident = true;\n      incidentSeverity = 'high';\n    }\n\n    const incidentTitle = this.generateIncidentTitle(alert, triggeredRules);\n    const incidentDescription = await this.generateIncidentDescription(alert, triggeredRules, confidence);\n\n    return {\n      shouldCreateIncident,\n      incidentSeverity,\n      incidentTitle,\n      incidentDescription,\n      confidence,\n      relatedAlerts: [alert, ...recentAlerts.slice(0, 5)], // Include up to 5 related alerts\n      triggeredRules,\n      threatIntelligence: threatEnrichment.indicators.length > 0 ? threatEnrichment : undefined\n    };\n  }\n\n  private static async evaluateRule(\n    rule: CorrelationRule,\n    alert: RawAlert,\n    recentAlerts: RawAlert[]\n  ): Promise<boolean> {\n    const { conditions } = rule;\n\n    // Check severity threshold\n    if (conditions.severityThreshold) {\n      const severityLevels = { 'low': 1, 'medium': 2, 'high': 3, 'critical': 4 };\n      const alertSeverity = severityLevels[alert.severity as keyof typeof severityLevels] || 0;\n      const threshold = severityLevels[conditions.severityThreshold as keyof typeof severityLevels] || 0;\n      \n      if (alertSeverity < threshold) {\n        return false;\n      }\n    }\n\n    // Check alert count in time window\n    if (conditions.alertCount && conditions.timeWindow) {\n      const relevantAlerts = recentAlerts.filter(a => \n        new Date(a.receivedAt).getTime() > Date.now() - (conditions.timeWindow! * 60 * 1000)\n      );\n      \n      if (relevantAlerts.length < conditions.alertCount - 1) { // -1 because current alert counts\n        return false;\n      }\n    }\n\n    // Check source types\n    if (conditions.sourceTypes && conditions.sourceTypes.length > 0) {\n      const source = await storage.getSource(alert.sourceId);\n      if (!source || !conditions.sourceTypes.includes(source.type)) {\n        return false;\n      }\n    }\n\n    // Check keyword matches\n    if (conditions.keywordMatches && conditions.keywordMatches.length > 0) {\n      const alertText = [\n        alert.description || '',\n        alert.type || '',\n        JSON.stringify(alert.rawData)\n      ].join(' ').toLowerCase();\n\n      const hasKeywordMatch = conditions.keywordMatches.some(keyword =>\n        alertText.includes(keyword.toLowerCase())\n      );\n\n      if (!hasKeywordMatch) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  private static async getRecentAlerts(minutes: number = 60): Promise<RawAlert[]> {\n    const allAlerts = await storage.getRawAlerts();\n    const cutoffTime = new Date(Date.now() - minutes * 60 * 1000);\n    \n    return allAlerts\n      .filter(alert => new Date(alert.receivedAt) > cutoffTime)\n      .sort((a, b) => new Date(b.receivedAt).getTime() - new Date(a.receivedAt).getTime());\n  }\n\n  private static async calculateMLScore(alert: RawAlert, recentAlerts: RawAlert[]): Promise<number> {\n    // Simplified ML scoring based on various factors\n    let score = 0.3; // Base score\n\n    // Severity contribution\n    const severityScores = { 'critical': 0.4, 'high': 0.3, 'medium': 0.2, 'low': 0.1 };\n    score += severityScores[alert.severity as keyof typeof severityScores] || 0.1;\n\n    // Frequency analysis - if similar alerts occurred recently\n    const similarAlerts = recentAlerts.filter(a => \n      a.type === alert.type || \n      a.severity === alert.severity ||\n      a.sourceId === alert.sourceId\n    );\n    \n    if (similarAlerts.length > 2) {\n      score += 0.2; // Pattern detected\n    }\n\n    // Time-based analysis - alerts during off-hours are more suspicious\n    const hour = new Date(alert.receivedAt).getHours();\n    if (hour < 6 || hour > 22) {\n      score += 0.1; // Off-hours activity\n    }\n\n    // Source reputation (simplified)\n    const source = await storage.getSource(alert.sourceId);\n    if (source?.type === 'EDR' || source?.type === 'SIEM') {\n      score += 0.1; // Higher trust in EDR/SIEM alerts\n    }\n\n    return Math.min(score, 1.0); // Cap at 1.0\n  }\n\n  private static generateIncidentTitle(alert: RawAlert, triggeredRules: CorrelationRule[]): string {\n    if (triggeredRules.length > 0) {\n      const primaryRule = triggeredRules[0];\n      if (primaryRule.id === \"ransomware-indicators\") {\n        return \"Potential Ransomware Activity Detected\";\n      } else if (primaryRule.id === \"data-exfiltration\") {\n        return \"Possible Data Exfiltration Attempt\";\n      } else if (primaryRule.id === \"privilege-escalation\") {\n        return \"Privilege Escalation Activity Detected\";\n      } else if (primaryRule.id === \"critical-alert-rule\") {\n        return `Critical Security Alert: ${alert.type || 'Unknown'}`;\n      } else if (primaryRule.id === \"multiple-high-alerts\") {\n        return \"Multiple High-Severity Security Events\";\n      }\n    }\n\n    // Fallback title\n    return `Security Incident: ${alert.type || 'Automated Detection'}`;\n  }\n\n  private static async generateIncidentDescription(\n    alert: RawAlert,\n    triggeredRules: CorrelationRule[],\n    confidence: number\n  ): Promise<string> {\n    let description = `Automated incident created with ${(confidence * 100).toFixed(1)}% confidence.\\n\\n`;\n    \n    description += `**Primary Alert Details:**\\n`;\n    description += `- Type: ${alert.type || 'Unknown'}\\n`;\n    description += `- Severity: ${alert.severity || 'Unknown'}\\n`;\n    description += `- Description: ${alert.description || 'No description available'}\\n`;\n    description += `- Received: ${new Date(alert.receivedAt).toISOString()}\\n\\n`;\n\n    if (triggeredRules.length > 0) {\n      description += `**Triggered Correlation Rules:**\\n`;\n      triggeredRules.forEach(rule => {\n        description += `- ${rule.name}: ${rule.description}\\n`;\n      });\n      description += '\\n';\n    }\n    \n    // Add threat intelligence information if available\n    const threatEnrichment = await ThreatIntelligenceService.enrichAlert(alert);\n    if (threatEnrichment.indicators.length > 0) {\n      description += `**Threat Intelligence Matches:**\\n`;\n      description += `- Risk Score: ${threatEnrichment.riskScore.toFixed(1)}/10\\n`;\n      threatEnrichment.indicators.forEach(indicator => {\n        description += `- ${indicator.type}: ${indicator.value} (${indicator.severity}, ${indicator.source})\\n`;\n      });\n      description += '\\n';\n      \n      if (threatEnrichment.recommendations.length > 0) {\n        description += `**Threat Intelligence Recommendations:**\\n`;\n        threatEnrichment.recommendations.forEach(rec => {\n          description += `- ${rec}\\n`;\n        });\n        description += '\\n';\n      }\n    }\n\n    description += `**Recommended Actions:**\\n`;\n    if (triggeredRules.some(r => r.actions.escalate)) {\n      description += `- Immediate escalation recommended\\n`;\n    }\n    description += `- Review alert details and raw data\\n`;\n    description += `- Investigate related systems and users\\n`;\n    description += `- Consider containment measures if confirmed malicious\\n`;\n\n    return description;\n  }\n\n  static async createIncidentFromCorrelation(\n    correlationResult: CorrelationResult,\n    primaryAlert: RawAlert\n  ): Promise<string | null> {\n    if (!correlationResult.shouldCreateIncident) {\n      return null;\n    }\n\n    const incidentData: InsertIncident = {\n      title: correlationResult.incidentTitle,\n      description: correlationResult.incidentDescription,\n      severity: correlationResult.incidentSeverity,\n      status: 'open'\n    };\n\n    try {\n      const incident = await storage.createIncident(incidentData);\n      \n      // Create initial action for the incident\n      await storage.createAction({\n        incidentId: incident.id,\n        actionType: 'AUTOMATED_DETECTION',\n        payload: {\n          primaryAlertId: primaryAlert.id,\n          confidence: correlationResult.confidence,\n          triggeredRules: correlationResult.triggeredRules.map(r => r.id),\n          relatedAlertIds: correlationResult.relatedAlerts.map(a => a.id)\n        },\n        performedBy: 'system'\n      });\n\n      console.log(`✅ Auto-created incident ${incident.id}: ${incident.title}`);\n      return incident.id;\n    } catch (error) {\n      console.error('❌ Failed to create incident from correlation:', error);\n      return null;\n    }\n  }\n}","size_bytes":13446},"server/alertDataLoader.ts":{"content":"import fs from 'fs';\nimport path from 'path';\n\nexport interface AlertDataset {\n  crowdstrike: any[];\n  email: any[];\n  firewall: any[];\n  sentinelone: any[];\n}\n\nexport class AlertDataLoader {\n  private static instance: AlertDataLoader;\n  private alertData: AlertDataset = {\n    crowdstrike: [],\n    email: [],\n    firewall: [],\n    sentinelone: []\n  };\n  private isLoaded = false;\n\n  static getInstance(): AlertDataLoader {\n    if (!AlertDataLoader.instance) {\n      AlertDataLoader.instance = new AlertDataLoader();\n    }\n    return AlertDataLoader.instance;\n  }\n\n  async loadAlertData(): Promise<void> {\n    if (this.isLoaded) return;\n\n    try {\n      const dataPath = path.join(process.cwd(), 'attached_assets');\n      \n      // Load CrowdStrike alerts\n      const crowdStrikeFile = path.join(dataPath, 'crowdstrike_alerts_labeled_1754556002025.json');\n      if (fs.existsSync(crowdStrikeFile)) {\n        const crowdStrikeData = JSON.parse(fs.readFileSync(crowdStrikeFile, 'utf8'));\n        this.alertData.crowdstrike = Array.isArray(crowdStrikeData) ? crowdStrikeData : [];\n        console.log(`✅ Loaded ${this.alertData.crowdstrike.length} CrowdStrike alerts`);\n      }\n\n      // Load Email alerts\n      const emailFile = path.join(dataPath, 'email_alerts_labeled_1754556002031.json');\n      if (fs.existsSync(emailFile)) {\n        const emailData = JSON.parse(fs.readFileSync(emailFile, 'utf8'));\n        this.alertData.email = Array.isArray(emailData) ? emailData : [];\n        console.log(`✅ Loaded ${this.alertData.email.length} Email alerts`);\n      }\n\n      // Load Firewall alerts\n      const firewallFile = path.join(dataPath, 'firewall_alerts_labeled_1754556002031.json');\n      if (fs.existsSync(firewallFile)) {\n        const firewallData = JSON.parse(fs.readFileSync(firewallFile, 'utf8'));\n        this.alertData.firewall = Array.isArray(firewallData) ? firewallData : [];\n        console.log(`✅ Loaded ${this.alertData.firewall.length} Firewall alerts`);\n      }\n\n      // Load SentinelOne alerts\n      const sentinelOneFile = path.join(dataPath, 'sentinelone_alerts_labeled_1754556002032.json');\n      if (fs.existsSync(sentinelOneFile)) {\n        const sentinelOneData = JSON.parse(fs.readFileSync(sentinelOneFile, 'utf8'));\n        this.alertData.sentinelone = Array.isArray(sentinelOneData) ? sentinelOneData : [];\n        console.log(`✅ Loaded ${this.alertData.sentinelone.length} SentinelOne alerts`);\n      }\n\n      this.isLoaded = true;\n      const totalAlerts = this.alertData.crowdstrike.length + \n                         this.alertData.email.length + \n                         this.alertData.firewall.length + \n                         this.alertData.sentinelone.length;\n      console.log(`🎯 Total alerts loaded: ${totalAlerts}`);\n    } catch (error) {\n      console.error('❌ Error loading alert data:', error);\n      this.isLoaded = false;\n    }\n  }\n\n  getRandomAlerts(sourceType: string, count: number): any[] {\n    const sourceKey = sourceType.toLowerCase() as keyof AlertDataset;\n    const sourceData = this.alertData[sourceKey];\n    \n    if (!sourceData || sourceData.length === 0) {\n      throw new Error(`No data available for source type: ${sourceType}`);\n    }\n\n    const results = [];\n    for (let i = 0; i < count; i++) {\n      const randomIndex = Math.floor(Math.random() * sourceData.length);\n      const alert = { ...sourceData[randomIndex] };\n      \n      // Update timestamp to current time for realism\n      if (alert.timestamp) {\n        alert.timestamp = new Date(Date.now() - Math.random() * 3600000).toISOString();\n      }\n      \n      results.push(alert);\n    }\n    \n    return results;\n  }\n\n  getDatasetStats(): { [key: string]: number } {\n    return {\n      crowdstrike: this.alertData.crowdstrike.length,\n      email: this.alertData.email.length,\n      firewall: this.alertData.firewall.length,\n      sentinelone: this.alertData.sentinelone.length,\n      total: this.alertData.crowdstrike.length + \n             this.alertData.email.length + \n             this.alertData.firewall.length + \n             this.alertData.sentinelone.length\n    };\n  }\n\n  getSampleAlert(sourceType: string): any | null {\n    const sourceKey = sourceType.toLowerCase() as keyof AlertDataset;\n    const sourceData = this.alertData[sourceKey];\n    \n    if (!sourceData || sourceData.length === 0) {\n      return null;\n    }\n    \n    const randomIndex = Math.floor(Math.random() * sourceData.length);\n    return sourceData[randomIndex];\n  }\n\n  async ensureDataLoaded(): Promise<void> {\n    if (!this.isLoaded) {\n      await this.loadAlertData();\n    }\n  }\n}","size_bytes":4601},"server/alertProcessor.ts":{"content":"import { storage } from \"./storage\";\nimport { AlertNormalizer, type NormalizedAlertData } from \"./normalization\";\nimport { AlertDataLoader } from \"./alertDataLoader\";\nimport { AlertCorrelationEngine } from \"./alertCorrelation\";\nimport { type RawAlert, type InsertRawAlert } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\nexport interface AlertProcessingResult {\n  rawAlert: RawAlert;\n  normalizedData: NormalizedAlertData;\n  success: boolean;\n  error?: string;\n  incidentCreated?: boolean;\n  incidentId?: string;\n  correlationConfidence?: number;\n}\n\nexport class AlertProcessor {\n  \n  static async processIncomingAlert(\n    alertData: any, \n    sourceId: string, \n    sourceType?: string\n  ): Promise<AlertProcessingResult> {\n    try {\n      // Step 1: Normalize the incoming alert\n      const normalizedData = AlertNormalizer.normalize(alertData, sourceType);\n      \n      // Step 2: Convert to raw alert format and store\n      const rawAlertData = AlertNormalizer.toRawAlert(normalizedData, sourceId);\n      const rawAlert = await storage.createRawAlert(rawAlertData);\n      \n      // Step 3: Run correlation analysis to determine if incident should be created\n      const correlationResult = await AlertCorrelationEngine.correlateAlert(rawAlert);\n      \n      let incidentId: string | null = null;\n      let incidentCreated = false;\n      \n      if (correlationResult.shouldCreateIncident) {\n        incidentId = await AlertCorrelationEngine.createIncidentFromCorrelation(correlationResult, rawAlert);\n        incidentCreated = incidentId !== null;\n        \n        if (incidentCreated) {\n          console.log(`🚨 Auto-created incident ${incidentId} for ${normalizedData.sourceType} alert`);\n        }\n      }\n      \n      console.log(`✅ Processed ${normalizedData.sourceType} alert: ${normalizedData.title} (correlation: ${(correlationResult.confidence * 100).toFixed(1)}%)`);\n      \n      return {\n        rawAlert,\n        normalizedData,\n        success: true,\n        incidentCreated,\n        incidentId: incidentId || undefined,\n        correlationConfidence: correlationResult.confidence\n      };\n    } catch (error) {\n      console.error('Alert processing failed:', error);\n      return {\n        rawAlert: {} as RawAlert,\n        normalizedData: {} as NormalizedAlertData,\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      };\n    }\n  }\n\n  static async processBulkAlerts(\n    alerts: Array<{ alertData: any; sourceId: string; sourceType?: string }>\n  ): Promise<AlertProcessingResult[]> {\n    const results: AlertProcessingResult[] = [];\n    \n    for (const alert of alerts) {\n      const result = await this.processIncomingAlert(\n        alert.alertData,\n        alert.sourceId,\n        alert.sourceType\n      );\n      results.push(result);\n    }\n    \n    const successCount = results.filter(r => r.success).length;\n    console.log(`✅ Bulk processing complete: ${successCount}/${results.length} alerts processed successfully`);\n    \n    return results;\n  }\n\n  static async simulateIncomingAlerts(\n    sourceType: string, \n    count: number = 5\n  ): Promise<AlertProcessingResult[]> {\n    // Load real alert data\n    const dataLoader = AlertDataLoader.getInstance();\n    await dataLoader.ensureDataLoaded();\n\n    // First, find or create a source for this simulation\n    const sources = await storage.getSources();\n    let source = sources.find(s => s.type.toLowerCase() === sourceType.toLowerCase());\n    \n    if (!source) {\n      source = await storage.createSource({\n        name: `${sourceType} Real Data Simulator`,\n        type: sourceType,\n        config: { simulated: true, dataSource: 'real_alerts', endpoint: `https://api.${sourceType.toLowerCase()}.example.com` }\n      });\n    }\n\n    try {\n      // Use real alert data instead of generated samples\n      const realAlerts = dataLoader.getRandomAlerts(sourceType, count);\n      const results: AlertProcessingResult[] = [];\n\n      console.log(`🎯 Simulating ${count} real ${sourceType} alerts...`);\n      \n      for (const alertData of realAlerts) {\n        const result = await this.processIncomingAlert(alertData, source.id, sourceType);\n        results.push(result);\n      }\n\n      const successCount = results.filter(r => r.success).length;\n      console.log(`✅ Successfully processed ${successCount}/${count} ${sourceType} alerts`);\n\n      return results;\n    } catch (error) {\n      console.log(`⚠️  No real data available for ${sourceType}, falling back to generated samples`);\n      // Fallback to generated data if real data is not available\n      const sampleAlerts = this.generateSampleAlerts(sourceType, count);\n      const results: AlertProcessingResult[] = [];\n\n      for (const alertData of sampleAlerts) {\n        const result = await this.processIncomingAlert(alertData, source.id, sourceType);\n        results.push(result);\n      }\n\n      return results;\n    }\n  }\n\n  static async simulateRealTimeAlerts(\n    sourceType: string,\n    durationMinutes: number = 5,\n    alertsPerMinute: number = 2\n  ): Promise<void> {\n    const dataLoader = AlertDataLoader.getInstance();\n    await dataLoader.ensureDataLoaded();\n\n    console.log(`🔄 Starting real-time simulation: ${sourceType} alerts for ${durationMinutes} minutes (${alertsPerMinute}/min)`);\n    \n    const intervalMs = (60 * 1000) / alertsPerMinute; // Convert to milliseconds between alerts\n    const totalAlerts = durationMinutes * alertsPerMinute;\n    let processedCount = 0;\n\n    const interval = setInterval(async () => {\n      try {\n        if (processedCount >= totalAlerts) {\n          clearInterval(interval);\n          console.log(`🏁 Real-time simulation completed: ${processedCount} alerts processed`);\n          return;\n        }\n\n        const result = await this.simulateIncomingAlerts(sourceType, 1);\n        if (result[0]?.success) {\n          processedCount++;\n          console.log(`⚡ Real-time alert ${processedCount}/${totalAlerts}: ${result[0].normalizedData.title}`);\n        }\n      } catch (error) {\n        console.error('❌ Real-time simulation error:', error);\n      }\n    }, intervalMs);\n\n    // Return immediately, simulation runs in background\n    return;\n  }\n\n  static async getDatasetStats(): Promise<any> {\n    const dataLoader = AlertDataLoader.getInstance();\n    await dataLoader.ensureDataLoaded();\n    return dataLoader.getDatasetStats();\n  }\n\n  static async getSampleAlert(sourceType: string): Promise<any> {\n    const dataLoader = AlertDataLoader.getInstance();\n    await dataLoader.ensureDataLoaded();\n    return dataLoader.getSampleAlert(sourceType);\n  }\n\n  private static generateSampleAlerts(sourceType: string, count: number): any[] {\n    const alerts = [];\n    \n    for (let i = 0; i < count; i++) {\n      switch (sourceType.toLowerCase()) {\n        case 'crowdstrike':\n          alerts.push(this.generateCrowdStrikeSample(i));\n          break;\n        case 'email':\n          alerts.push(this.generateEmailSample(i));\n          break;\n        case 'firewall':\n          alerts.push(this.generateFirewallSample(i));\n          break;\n        case 'sentinelone':\n          alerts.push(this.generateSentinelOneSample(i));\n          break;\n        default:\n          throw new Error(`Unsupported source type: ${sourceType}`);\n      }\n    }\n    \n    return alerts;\n  }\n\n  private static generateCrowdStrikeSample(index: number) {\n    const severities = ['Low', 'Medium', 'High', 'Critical'];\n    const tactics = ['Defense Evasion', 'Execution', 'Persistence', 'Privilege Escalation'];\n    const techniques = ['T1547', 'T1078', 'T1036', 'T1055'];\n    const detections = ['RemoteAccessTool', 'CommandAndControl', 'CredentialAccess', 'Malware'];\n    \n    return {\n      alert_id: randomUUID(),\n      detect_id: randomUUID(),\n      device_id: randomUUID(),\n      device_name: `workstation-${String(index + 1).padStart(2, '0')}.corp.local`,\n      agent_version: \"4.2.8\",\n      sensor_version: \"6.1.15\",\n      ip_address: `192.168.1.${100 + index}`,\n      mac_address: `00:11:22:33:44:${String(50 + index).padStart(2, '0')}`,\n      user_name: `user${index + 1}`,\n      file_name: `suspicious_${index}.exe`,\n      file_path: `C:\\\\Temp\\\\suspicious_${index}.exe`,\n      file_hash_sha1: `a1b2c3d4e5f6789${index}`,\n      file_hash_sha256: `def456789abc123${index}${'0'.repeat(48)}`,\n      severity: severities[index % severities.length],\n      tactic: tactics[index % tactics.length],\n      technique: techniques[index % techniques.length],\n      detect_name: detections[index % detections.length],\n      command_line: `suspicious_${index}.exe --malware-flag`,\n      parent_process: \"explorer.exe\",\n      parent_cmdline: \"C:\\\\Windows\\\\explorer.exe\",\n      timestamp: new Date(Date.now() - Math.random() * 3600000).toISOString(),\n      event_platform: \"Windows\",\n      event_type: \"ProcessRollup\",\n      network_remote_ip: `203.0.113.${10 + index}`,\n      network_remote_port: 8080 + index,\n      protocol: \"TCP\",\n      alert_label: \"true_positive\"\n    };\n  }\n\n  private static generateEmailSample(index: number) {\n    const verdicts = ['malicious', 'suspicious', 'clean'];\n    const malwareTypes = ['Emotet', 'Dridex', 'None'];\n    const engines = ['Microsoft Defender', 'Proofpoint', 'Mimecast'];\n    \n    return {\n      alert_id: randomUUID(),\n      sender_email: `suspicious${index}@badactor.com`,\n      recipient_email: `user${index}@company.com`,\n      subject: `Urgent Action Required - Case ${index + 1000}`,\n      timestamp: new Date(Date.now() - Math.random() * 3600000).toISOString(),\n      verdict: verdicts[index % verdicts.length],\n      quarantine_status: index % 2 === 0 ? \"blocked\" : \"quarantined\",\n      malware_detected: malwareTypes[index % malwareTypes.length],\n      phishing_detected: index % 3 === 0,\n      malicious_link_detected: index % 4 === 0,\n      spam_score: Math.random() * 10,\n      attachment_name: `document_${index}.pdf`,\n      attachment_hash: `hash${index}${'0'.repeat(60)}`,\n      message_id: randomUUID(),\n      header_from: `noreply${index}@suspicious.com`,\n      reply_to: `reply${index}@badactor.com`,\n      detection_engine: engines[index % engines.length],\n      message_size: 15000 + Math.floor(Math.random() * 50000),\n      alert_label: \"true_positive\"\n    };\n  }\n\n  private static generateFirewallSample(index: number) {\n    const actions = ['allow', 'deny', 'drop', 'reset'];\n    const protocols = ['TCP', 'UDP', 'ICMP'];\n    const threatTypes = ['port-scan', 'brute-force', 'dos-attack', 'C2'];\n    const severities = ['Low', 'Medium', 'High', 'Critical'];\n    \n    return {\n      alert_id: randomUUID(),\n      firewall_name: `fw-${String(index + 1).padStart(2, '0')}.company.com`,\n      src_ip: `203.0.113.${10 + index}`,\n      src_port: 50000 + index,\n      dest_ip: `192.168.1.${100 + index}`,\n      dest_port: [22, 80, 443, 3389][index % 4],\n      protocol: protocols[index % protocols.length],\n      action: actions[index % actions.length],\n      rule_name: `rule_security_${index}`,\n      policy_id: 1000 + index,\n      policy_name: `policy_block_${index}`,\n      application: ['SSH', 'HTTP', 'HTTPS', 'RDP'][index % 4],\n      threat_type: threatTypes[index % threatTypes.length],\n      severity: severities[index % severities.length],\n      category: ['threat', 'application', 'network'][index % 3],\n      timestamp: new Date(Date.now() - Math.random() * 3600000).toISOString(),\n      interface: ['eth0', 'eth1', 'wan1'][index % 3],\n      country: ['Unknown', 'China', 'Russia', 'North Korea'][index % 4],\n      alert_label: \"true_positive\"\n    };\n  }\n\n  private static generateSentinelOneSample(index: number) {\n    const classifications = ['Ransomware', 'Trojan', 'PUA', 'Infostealer'];\n    const verdicts = ['malicious', 'suspicious', 'benign'];\n    const detections = ['Generic.Trojan.Downloader', 'Backdoor.Win32.DarkKomet', 'Win32/Filecoder.AA'];\n    \n    return {\n      alert_id: randomUUID(),\n      agent_uuid: randomUUID(),\n      agent_ip: `192.168.1.${150 + index}`,\n      agent_os_type: ['windows', 'linux', 'mac'][index % 3],\n      agent_os_revision: String(60000 + index),\n      agent_version: \"5.2.1\",\n      agent_hostname: `endpoint-${String(index + 1).padStart(2, '0')}.corp.local`,\n      site_name: `Site ${index + 1}`,\n      group_name: ['IT Ops', 'Finance Dept', 'R&D'][index % 3],\n      account_name: `account${index}`,\n      threat_id: randomUUID(),\n      threat_classification: classifications[index % classifications.length],\n      detection_name: detections[index % detections.length],\n      file_path: `C:\\\\Users\\\\user${index}\\\\AppData\\\\Temp\\\\malware_${index}.exe`,\n      file_hash_sha256: `sentinel${index}${'0'.repeat(56)}`,\n      file_hash_md5: `md5hash${index}${'0'.repeat(24)}`,\n      file_hash_sha1: `sha1hash${index}${'0'.repeat(32)}`,\n      process_name: `process_${index}.exe`,\n      process_id: 1000 + index,\n      parent_process_name: \"explorer.exe\",\n      parent_process_id: 500 + index,\n      verdict: verdicts[index % verdicts.length],\n      initiated_by: ['user', 'system', 'remote'][index % 3],\n      storyline_id: randomUUID(),\n      mitigation_status: ['mitigated', 'pending', 'unresolved'][index % 3],\n      indicator_type: ['Process', 'File', 'Network Connection'][index % 3],\n      network_remote_ip: `203.0.113.${50 + index}`,\n      network_remote_port: 9000 + index,\n      network_protocol: protocols[index % protocols.length],\n      timestamp: new Date(Date.now() - Math.random() * 3600000).toISOString(),\n      alert_label: \"true_positive\"\n    };\n  }\n}\n\nconst protocols = ['TCP', 'UDP', 'ICMP'];","size_bytes":13559},"server/analyticsService.ts":{"content":"import { storage } from \"./storage\";\nimport { type RawAlert, type Incident, type Action, type Feedback, type ModelMetric } from \"@shared/schema\";\n\nexport interface AnalyticsMetrics {\n  // Model Performance\n  precision: number;\n  recall: number;\n  accuracy: number;\n  f1Score: number;\n  \n  // Response Times\n  avgResponseTimeMinutes: number;\n  avgDetectionTime: number;\n  avgResolutionTime: number;\n  \n  // Volume Metrics\n  alertsProcessedToday: number;\n  alertsProcessedWeek: number;\n  incidentsCreatedToday: number;\n  incidentsResolvedToday: number;\n  \n  // Automation Metrics\n  automationRate: number;\n  falsePositiveRate: number;\n  threatDetectionRate: number;\n  escalationRate: number;\n  \n  // Analyst Performance\n  avgFeedbackRating: number;\n  analystProductivity: number;\n  manualReviewsToday: number;\n  \n  // Trend Data\n  weeklyTrends: {\n    alerts: number[];\n    incidents: number[];\n    responseTime: number[];\n  };\n  \n  // Severity Distribution\n  severityDistribution: {\n    critical: number;\n    high: number;\n    medium: number;\n    low: number;\n  };\n  \n  // Source Performance\n  sourceMetrics: {\n    sourceId: string;\n    sourceName: string;\n    alertCount: number;\n    accuracy: number;\n    falsePositiveRate: number;\n  }[];\n}\n\nexport class AnalyticsService {\n  static async calculateRealTimeMetrics(): Promise<AnalyticsMetrics> {\n    const [alerts, incidents, actions, feedback, metrics, sources] = await Promise.all([\n      storage.getRawAlerts(),\n      storage.getIncidents(),\n      storage.getActions(),\n      storage.getFeedback(),\n      storage.getModelMetrics(),\n      storage.getSources()\n    ]);\n\n    const now = Date.now();\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    const todayTime = today.getTime();\n    \n    const weekAgo = new Date(now - 7 * 24 * 60 * 60 * 1000);\n\n    // Model Performance Metrics\n    const latestMetric = metrics[0];\n    const precision = latestMetric?.precision || this.calculatePrecisionFromData(incidents, alerts);\n    const recall = latestMetric?.recall || this.calculateRecallFromData(incidents, alerts);\n    const accuracy = latestMetric?.accuracy || this.calculateAccuracyFromData(incidents, alerts);\n    const f1Score = (2 * precision * recall) / (precision + recall) || 0;\n\n    // Response Time Calculations\n    const resolvedIncidents = incidents.filter(inc => inc.closedAt);\n    const avgResponseTimeMinutes = resolvedIncidents.length > 0\n      ? resolvedIncidents.reduce((sum, inc) => {\n          const responseTime = new Date(inc.closedAt!).getTime() - new Date(inc.createdAt).getTime();\n          return sum + responseTime;\n        }, 0) / resolvedIncidents.length / (1000 * 60)\n      : 0;\n\n    // Detection time (time from alert to incident creation)\n    const avgDetectionTime = this.calculateAvgDetectionTime(alerts, incidents);\n    \n    // Resolution time (time from incident creation to closure)\n    const avgResolutionTime = resolvedIncidents.length > 0\n      ? resolvedIncidents.reduce((sum, inc) => {\n          const resolutionTime = new Date(inc.closedAt!).getTime() - new Date(inc.createdAt).getTime();\n          return sum + resolutionTime;\n        }, 0) / resolvedIncidents.length / (1000 * 60 * 60) // Convert to hours\n      : 0;\n\n    // Volume Metrics\n    const alertsProcessedToday = alerts.filter(alert => \n      new Date(alert.receivedAt).getTime() >= todayTime\n    ).length;\n    \n    const alertsProcessedWeek = alerts.filter(alert => \n      new Date(alert.receivedAt) >= weekAgo\n    ).length;\n    \n    const incidentsCreatedToday = incidents.filter(inc => \n      new Date(inc.createdAt).getTime() >= todayTime\n    ).length;\n    \n    const incidentsResolvedToday = incidents.filter(inc => \n      inc.closedAt && new Date(inc.closedAt).getTime() >= todayTime\n    ).length;\n\n    // Automation Metrics\n    const automatedActions = actions.filter(action => \n      action.actionType === 'AUTOMATED_DETECTION' || \n      action.actionType === 'AUTO_QUARANTINE'\n    );\n    const automationRate = actions.length > 0 ? automatedActions.length / actions.length : 0;\n\n    const falsePositiveRate = this.calculateFalsePositiveRate(incidents, feedback);\n    const threatDetectionRate = this.calculateThreatDetectionRate(alerts, incidents);\n    const escalationRate = this.calculateEscalationRate(incidents, actions);\n\n    // Analyst Performance\n    const validFeedback = feedback.filter(f => f.rating !== null);\n    const avgFeedbackRating = validFeedback.length > 0\n      ? validFeedback.reduce((sum, f) => sum + (f.rating || 0), 0) / validFeedback.length\n      : 0;\n\n    const manualActions = actions.filter(action => \n      action.performedBy !== 'system' && action.performedBy !== null\n    );\n    const analystProductivity = this.calculateAnalystProductivity(manualActions, incidents);\n    \n    const manualReviewsToday = actions.filter(action => \n      action.actionType === 'ANALYST_REVIEW' && \n      new Date(action.performedAt).getTime() >= todayTime\n    ).length;\n\n    // Weekly Trends\n    const weeklyTrends = this.calculateWeeklyTrends(alerts, incidents);\n\n    // Severity Distribution\n    const severityDistribution = this.calculateSeverityDistribution(incidents);\n\n    // Source Performance\n    const sourceMetrics = await this.calculateSourceMetrics(sources, alerts, incidents);\n\n    return {\n      precision,\n      recall,\n      accuracy,\n      f1Score,\n      avgResponseTimeMinutes,\n      avgDetectionTime,\n      avgResolutionTime,\n      alertsProcessedToday,\n      alertsProcessedWeek,\n      incidentsCreatedToday,\n      incidentsResolvedToday,\n      automationRate,\n      falsePositiveRate,\n      threatDetectionRate,\n      escalationRate,\n      avgFeedbackRating,\n      analystProductivity,\n      manualReviewsToday,\n      weeklyTrends,\n      severityDistribution,\n      sourceMetrics\n    };\n  }\n\n  private static calculatePrecisionFromData(incidents: Incident[], alerts: RawAlert[]): number {\n    // Precision = True Positives / (True Positives + False Positives)\n    // For simplicity, assume high-severity resolved incidents are true positives\n    const truePositives = incidents.filter(inc => \n      inc.severity === 'critical' || inc.severity === 'high'\n    ).length;\n    \n    const falsePositives = incidents.filter(inc => \n      inc.severity === 'low' && inc.status === 'resolved'\n    ).length;\n    \n    return truePositives + falsePositives > 0 ? truePositives / (truePositives + falsePositives) : 0.85;\n  }\n\n  private static calculateRecallFromData(incidents: Incident[], alerts: RawAlert[]): number {\n    // Recall = True Positives / (True Positives + False Negatives)\n    // For simplicity, estimate based on alert-to-incident conversion rate\n    const criticalAlerts = alerts.filter(alert => alert.severity === 'critical').length;\n    const criticalIncidents = incidents.filter(inc => inc.severity === 'critical').length;\n    \n    return criticalAlerts > 0 ? Math.min(criticalIncidents / criticalAlerts, 1.0) : 0.82;\n  }\n\n  private static calculateAccuracyFromData(incidents: Incident[], alerts: RawAlert[]): number {\n    // Simplified accuracy calculation\n    const resolvedCorrectly = incidents.filter(inc => \n      inc.status === 'resolved' && (inc.severity === 'critical' || inc.severity === 'high')\n    ).length;\n    \n    const totalIncidents = incidents.length;\n    return totalIncidents > 0 ? resolvedCorrectly / totalIncidents : 0.88;\n  }\n\n  private static calculateAvgDetectionTime(alerts: RawAlert[], incidents: Incident[]): number {\n    // Calculate average time from first related alert to incident creation\n    let totalDetectionTime = 0;\n    let validIncidents = 0;\n\n    incidents.forEach(incident => {\n      // Find alerts that could be related to this incident (simplified)\n      const relatedAlerts = alerts.filter(alert => \n        Math.abs(new Date(alert.receivedAt).getTime() - new Date(incident.createdAt).getTime()) < 60 * 60 * 1000 // Within 1 hour\n      );\n\n      if (relatedAlerts.length > 0) {\n        const earliestAlert = relatedAlerts.reduce((earliest, alert) => \n          new Date(alert.receivedAt) < new Date(earliest.receivedAt) ? alert : earliest\n        );\n        \n        const detectionTime = new Date(incident.createdAt).getTime() - new Date(earliestAlert.receivedAt).getTime();\n        totalDetectionTime += detectionTime;\n        validIncidents++;\n      }\n    });\n\n    return validIncidents > 0 ? totalDetectionTime / validIncidents / (1000 * 60) : 8.5; // minutes\n  }\n\n  private static calculateFalsePositiveRate(incidents: Incident[], feedback: Feedback[]): number {\n    const negativeFeedback = feedback.filter(f => f.rating && f.rating <= 2).length;\n    const totalFeedback = feedback.length;\n    return totalFeedback > 0 ? negativeFeedback / totalFeedback : 0.05;\n  }\n\n  private static calculateThreatDetectionRate(alerts: RawAlert[], incidents: Incident[]): number {\n    const highSeverityAlerts = alerts.filter(alert => \n      alert.severity === 'critical' || alert.severity === 'high'\n    ).length;\n    \n    const threatIncidents = incidents.filter(inc => \n      inc.severity === 'critical' || inc.severity === 'high'\n    ).length;\n    \n    return highSeverityAlerts > 0 ? threatIncidents / highSeverityAlerts : 0.75;\n  }\n\n  private static calculateEscalationRate(incidents: Incident[], actions: Action[]): number {\n    const escalationActions = actions.filter(action => \n      action.actionType === 'ESCALATE' || action.actionType === 'ANALYST_ASSIGNMENT'\n    ).length;\n    \n    return incidents.length > 0 ? escalationActions / incidents.length : 0.25;\n  }\n\n  private static calculateAnalystProductivity(manualActions: Action[], incidents: Incident[]): number {\n    // Productivity = Actions per incident (higher is more productive)\n    return incidents.length > 0 ? manualActions.length / incidents.length : 2.3;\n  }\n\n  private static calculateWeeklyTrends(alerts: RawAlert[], incidents: Incident[]): {\n    alerts: number[];\n    incidents: number[];\n    responseTime: number[];\n  } {\n    const trends = {\n      alerts: [] as number[],\n      incidents: [] as number[],\n      responseTime: [] as number[]\n    };\n\n    // Calculate daily metrics for the last 7 days\n    for (let i = 6; i >= 0; i--) {\n      const dayStart = new Date(Date.now() - i * 24 * 60 * 60 * 1000);\n      dayStart.setHours(0, 0, 0, 0);\n      const dayEnd = new Date(dayStart);\n      dayEnd.setHours(23, 59, 59, 999);\n\n      const dayAlerts = alerts.filter(alert => {\n        const alertDate = new Date(alert.receivedAt);\n        return alertDate >= dayStart && alertDate <= dayEnd;\n      }).length;\n\n      const dayIncidents = incidents.filter(inc => {\n        const incDate = new Date(inc.createdAt);\n        return incDate >= dayStart && incDate <= dayEnd;\n      });\n\n      const dayResponseTime = dayIncidents.length > 0\n        ? dayIncidents.reduce((sum, inc) => {\n            const responseTime = inc.closedAt \n              ? new Date(inc.closedAt).getTime() - new Date(inc.createdAt).getTime()\n              : Date.now() - new Date(inc.createdAt).getTime();\n            return sum + responseTime;\n          }, 0) / dayIncidents.length / (1000 * 60) // minutes\n        : 0;\n\n      trends.alerts.push(dayAlerts);\n      trends.incidents.push(dayIncidents.length);\n      trends.responseTime.push(Math.round(dayResponseTime * 10) / 10);\n    }\n\n    return trends;\n  }\n\n  private static calculateSeverityDistribution(incidents: Incident[]): {\n    critical: number;\n    high: number;\n    medium: number;\n    low: number;\n  } {\n    const distribution = { critical: 0, high: 0, medium: 0, low: 0 };\n    \n    incidents.forEach(incident => {\n      distribution[incident.severity]++;\n    });\n\n    return distribution;\n  }\n\n  private static async calculateSourceMetrics(sources: any[], alerts: RawAlert[], incidents: Incident[]): Promise<{\n    sourceId: string;\n    sourceName: string;\n    alertCount: number;\n    accuracy: number;\n    falsePositiveRate: number;\n  }[]> {\n    return sources.map(source => {\n      const sourceAlerts = alerts.filter(alert => alert.sourceId === source.id);\n      \n      // Simplified accuracy calculation per source\n      const accuracy = sourceAlerts.length > 0 \n        ? Math.random() * 0.2 + 0.8 // 80-100% for demo\n        : 0;\n      \n      const falsePositiveRate = Math.random() * 0.1; // 0-10% for demo\n\n      return {\n        sourceId: source.id,\n        sourceName: source.name,\n        alertCount: sourceAlerts.length,\n        accuracy,\n        falsePositiveRate\n      };\n    });\n  }\n}","size_bytes":12460},"server/auth.ts":{"content":"import bcrypt from \"bcryptjs\";\nimport type { RequestHandler, Request } from \"express\";\nimport session from \"express-session\";\nimport { storage } from \"./storage\";\nimport type { User } from \"@shared/schema\";\n\n// Session interface for TypeScript\ndeclare module 'express-session' {\n  interface SessionData {\n    userId?: string;\n    user?: User;\n  }\n}\n\nexport interface AuthRequest extends Request {\n  session: session.Session & Partial<session.SessionData> & {\n    userId?: string;\n    user?: User;\n  };\n}\n\nexport class AuthService {\n  // Hash password using bcrypt\n  static async hashPassword(password: string): Promise<string> {\n    const saltRounds = 12;\n    return bcrypt.hash(password, saltRounds);\n  }\n\n  // Verify password against hash\n  static async verifyPassword(password: string, hash: string): Promise<boolean> {\n    return bcrypt.compare(password, hash);\n  }\n\n  // Register new user\n  static async registerUser(userData: {\n    email: string;\n    password: string;\n    firstName?: string;\n    lastName?: string;\n    role?: 'analyst' | 'admin';\n  }) {\n    // Check if user already exists\n    const existingUser = await storage.getUserByEmail(userData.email);\n    if (existingUser) {\n      throw new Error('User with this email already exists');\n    }\n\n    // Hash password\n    const hashedPassword = await this.hashPassword(userData.password);\n\n    // Create user\n    const user = await storage.createUser({\n      email: userData.email,\n      password: hashedPassword,\n      firstName: userData.firstName,\n      lastName: userData.lastName,\n      role: userData.role || 'analyst',\n    });\n\n    // Return user without password\n    const { password, ...userWithoutPassword } = user;\n    return userWithoutPassword;\n  }\n\n  // Login user\n  static async loginUser(email: string, password: string) {\n    // Get user with password for verification\n    const userWithPassword = await storage.getUserByEmailWithPassword(email);\n    if (!userWithPassword) {\n      throw new Error('Invalid email or password');\n    }\n\n    // Verify password\n    const isValidPassword = await this.verifyPassword(password, userWithPassword.password);\n    if (!isValidPassword) {\n      throw new Error('Invalid email or password');\n    }\n\n    // Return user without password\n    const { password: _, ...user } = userWithPassword;\n    return user;\n  }\n\n  // Get current user from session\n  static async getCurrentUser(req: AuthRequest): Promise<User | null> {\n    if (!req.session.userId) {\n      return null;\n    }\n\n    const user = await storage.getUser(req.session.userId);\n    return user || null;\n  }\n}\n\n// Authentication middleware\nexport const isAuthenticated: RequestHandler = async (req: any, res, next) => {\n  try {\n    if (!req.session.userId) {\n      return res.status(401).json({ message: \"Unauthorized\" });\n    }\n\n    const user = await storage.getUser(req.session.userId);\n    if (!user) {\n      req.session.userId = undefined;\n      return res.status(401).json({ message: \"Unauthorized\" });\n    }\n\n    req.user = user;\n    next();\n  } catch (error) {\n    console.error('Authentication error:', error);\n    res.status(401).json({ message: \"Unauthorized\" });\n  }\n};\n\n// Optional authentication middleware (doesn't require auth but adds user if available)\nexport const optionalAuth: RequestHandler = async (req: any, res, next) => {\n  try {\n    if (req.session.userId) {\n      const user = await storage.getUser(req.session.userId);\n      if (user) {\n        req.user = user;\n      }\n    }\n    next();\n  } catch (error) {\n    console.error('Optional auth error:', error);\n    next();\n  }\n};\n\n// Role-based authentication middleware\nexport const requireRole = (role: 'analyst' | 'admin'): RequestHandler => {\n  return async (req: any, res, next) => {\n    try {\n      if (!req.user) {\n        return res.status(401).json({ message: \"Unauthorized\" });\n      }\n\n      if (req.user.role !== role && req.user.role !== 'admin') {\n        return res.status(403).json({ message: \"Forbidden: Insufficient permissions\" });\n      }\n\n      next();\n    } catch (error) {\n      console.error('Role authorization error:', error);\n      res.status(403).json({ message: \"Forbidden\" });\n    }\n  };\n};","size_bytes":4172},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });","size_bytes":482},"server/exportService.ts":{"content":"import { storage } from \"./storage\";\nimport { AnalyticsService } from \"./analyticsService\";\nimport type { Incident, RawAlert, Action, Feedback } from \"@shared/schema\";\n\nexport interface ExportOptions {\n  format: 'csv' | 'json';\n  dateRange?: {\n    start: Date;\n    end: Date;\n  };\n  filters?: {\n    severity?: string[];\n    status?: string[];\n    sourceId?: string;\n  };\n}\n\nexport class ExportService {\n  static async exportIncidents(options: ExportOptions): Promise<string> {\n    const incidents = await storage.getIncidents();\n    const actions = await storage.getActions();\n    \n    // Apply filters and date range\n    let filteredIncidents = incidents;\n    \n    if (options.dateRange) {\n      filteredIncidents = incidents.filter(incident => {\n        const createdAt = new Date(incident.createdAt);\n        return createdAt >= options.dateRange!.start && createdAt <= options.dateRange!.end;\n      });\n    }\n    \n    if (options.filters?.severity?.length) {\n      filteredIncidents = filteredIncidents.filter(incident =>\n        options.filters!.severity!.includes(incident.severity)\n      );\n    }\n    \n    if (options.filters?.status?.length) {\n      filteredIncidents = filteredIncidents.filter(incident =>\n        options.filters!.status!.includes(incident.status)\n      );\n    }\n\n    // Enrich incidents with action counts and response times\n    const enrichedData = filteredIncidents.map(incident => {\n      const incidentActions = actions.filter(action => action.incidentId === incident.id);\n      const responseTime = incident.closedAt \n        ? Math.round((new Date(incident.closedAt).getTime() - new Date(incident.createdAt).getTime()) / (1000 * 60))\n        : null;\n      \n      return {\n        id: incident.id,\n        title: incident.title,\n        description: incident.description || 'No description available',\n        severity: incident.severity,\n        status: incident.status,\n        createdAt: new Date(incident.createdAt).toISOString(),\n        closedAt: incident.closedAt ? new Date(incident.closedAt).toISOString() : null,\n        responseTimeMinutes: responseTime,\n        actionCount: incidentActions.length,\n        assignedTo: incident.assignedTo || 'Unassigned',\n        escalated: incidentActions.some(action => action.actionType === 'ESCALATE') ? 'Yes' : 'No'\n      };\n    });\n\n    if (options.format === 'csv') {\n      return this.convertToCSV(enrichedData);\n    } else {\n      return JSON.stringify({\n        exportedAt: new Date().toISOString(),\n        totalCount: enrichedData.length,\n        filters: options.filters,\n        dateRange: options.dateRange,\n        data: enrichedData\n      }, null, 2);\n    }\n  }\n\n  static async exportAlerts(options: ExportOptions): Promise<string> {\n    const alerts = await storage.getRawAlerts();\n    const sources = await storage.getSources();\n    \n    // Apply filters and date range\n    let filteredAlerts = alerts;\n    \n    if (options.dateRange) {\n      filteredAlerts = alerts.filter(alert => {\n        const receivedAt = new Date(alert.receivedAt);\n        return receivedAt >= options.dateRange!.start && receivedAt <= options.dateRange!.end;\n      });\n    }\n    \n    if (options.filters?.severity?.length) {\n      filteredAlerts = filteredAlerts.filter(alert =>\n        alert.severity && options.filters!.severity!.includes(alert.severity)\n      );\n    }\n    \n    if (options.filters?.sourceId) {\n      filteredAlerts = filteredAlerts.filter(alert =>\n        alert.sourceId === options.filters!.sourceId\n      );\n    }\n\n    // Enrich alerts with source information\n    const enrichedData = filteredAlerts.map(alert => {\n      const source = sources.find(s => s.id === alert.sourceId);\n      \n      return {\n        id: alert.id,\n        sourceId: alert.sourceId,\n        sourceName: source?.name || 'Unknown',\n        sourceType: source?.type || 'Unknown',\n        severity: alert.severity || 'Unknown',\n        type: alert.type || 'Security Alert',\n        description: alert.description || 'Automated security alert',\n        receivedAt: new Date(alert.receivedAt).toISOString(),\n        dataSize: JSON.stringify(alert.rawData).length\n      };\n    });\n\n    if (options.format === 'csv') {\n      return this.convertToCSV(enrichedData);\n    } else {\n      return JSON.stringify({\n        exportedAt: new Date().toISOString(),\n        totalCount: enrichedData.length,\n        filters: options.filters,\n        dateRange: options.dateRange,\n        data: enrichedData\n      }, null, 2);\n    }\n  }\n\n  static async exportAnalytics(options: ExportOptions): Promise<string> {\n    const analytics = await AnalyticsService.calculateRealTimeMetrics();\n    const incidents = await storage.getIncidents();\n    const alerts = await storage.getRawAlerts();\n    \n    // Calculate additional statistics for export\n    const now = new Date();\n    const last30Days = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n    const last7Days = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n    \n    const recentIncidents = incidents.filter(inc => new Date(inc.createdAt) >= last30Days);\n    const weeklyIncidents = incidents.filter(inc => new Date(inc.createdAt) >= last7Days);\n    const recentAlerts = alerts.filter(alert => new Date(alert.receivedAt) >= last30Days);\n    \n    const reportData = {\n      generatedAt: new Date().toISOString(),\n      reportPeriod: options.dateRange || {\n        start: last30Days.toISOString(),\n        end: now.toISOString()\n      },\n      summary: {\n        totalIncidents: incidents.length,\n        incidentsLast30Days: recentIncidents.length,\n        incidentsLast7Days: weeklyIncidents.length,\n        totalAlerts: alerts.length,\n        alertsLast30Days: recentAlerts.length,\n        avgResponseTimeMinutes: analytics.avgResponseTimeMinutes.toFixed(2),\n        automationRate: (analytics.automationRate * 100).toFixed(1) + '%',\n        falsePositiveRate: (analytics.falsePositiveRate * 100).toFixed(1) + '%'\n      },\n      performanceMetrics: {\n        precision: (analytics.precision * 100).toFixed(1) + '%',\n        recall: (analytics.recall * 100).toFixed(1) + '%',\n        f1Score: (analytics.f1Score * 100).toFixed(1) + '%',\n        accuracy: (analytics.accuracy * 100).toFixed(1) + '%',\n        threatDetectionRate: (analytics.threatDetectionRate * 100).toFixed(1) + '%'\n      },\n      volumeMetrics: {\n        alertsProcessedToday: analytics.alertsProcessedToday,\n        incidentsCreatedToday: analytics.incidentsCreatedToday,\n        incidentsResolvedToday: analytics.incidentsResolvedToday,\n        manualReviewsToday: analytics.manualReviewsToday\n      },\n      severityDistribution: analytics.severityDistribution,\n      weeklyTrends: analytics.weeklyTrends,\n      sourceMetrics: analytics.sourceMetrics\n    };\n\n    if (options.format === 'csv') {\n      // For CSV, flatten the complex structure\n      const flatData = [\n        // Summary metrics\n        { metric: 'Total Incidents', value: reportData.summary.totalIncidents, category: 'Summary' },\n        { metric: 'Incidents (30 days)', value: reportData.summary.incidentsLast30Days, category: 'Summary' },\n        { metric: 'Incidents (7 days)', value: reportData.summary.incidentsLast7Days, category: 'Summary' },\n        { metric: 'Total Alerts', value: reportData.summary.totalAlerts, category: 'Summary' },\n        { metric: 'Alerts (30 days)', value: reportData.summary.alertsLast30Days, category: 'Summary' },\n        { metric: 'Avg Response Time (min)', value: reportData.summary.avgResponseTimeMinutes, category: 'Summary' },\n        { metric: 'Automation Rate', value: reportData.summary.automationRate, category: 'Summary' },\n        { metric: 'False Positive Rate', value: reportData.summary.falsePositiveRate, category: 'Summary' },\n        \n        // Performance metrics\n        { metric: 'Precision', value: reportData.performanceMetrics.precision, category: 'Performance' },\n        { metric: 'Recall', value: reportData.performanceMetrics.recall, category: 'Performance' },\n        { metric: 'F1 Score', value: reportData.performanceMetrics.f1Score, category: 'Performance' },\n        { metric: 'Accuracy', value: reportData.performanceMetrics.accuracy, category: 'Performance' },\n        { metric: 'Threat Detection Rate', value: reportData.performanceMetrics.threatDetectionRate, category: 'Performance' },\n        \n        // Volume metrics\n        { metric: 'Alerts Processed Today', value: reportData.volumeMetrics.alertsProcessedToday, category: 'Volume' },\n        { metric: 'Incidents Created Today', value: reportData.volumeMetrics.incidentsCreatedToday, category: 'Volume' },\n        { metric: 'Incidents Resolved Today', value: reportData.volumeMetrics.incidentsResolvedToday, category: 'Volume' },\n        { metric: 'Manual Reviews Today', value: reportData.volumeMetrics.manualReviewsToday, category: 'Volume' },\n        \n        // Severity distribution\n        { metric: 'Critical Incidents', value: reportData.severityDistribution.critical, category: 'Severity' },\n        { metric: 'High Incidents', value: reportData.severityDistribution.high, category: 'Severity' },\n        { metric: 'Medium Incidents', value: reportData.severityDistribution.medium, category: 'Severity' },\n        { metric: 'Low Incidents', value: reportData.severityDistribution.low, category: 'Severity' }\n      ];\n      \n      return this.convertToCSV(flatData);\n    } else {\n      return JSON.stringify(reportData, null, 2);\n    }\n  }\n\n  static async exportActions(options: ExportOptions): Promise<string> {\n    const actions = await storage.getActions();\n    const incidents = await storage.getIncidents();\n    \n    // Apply date range filter\n    let filteredActions = actions;\n    \n    if (options.dateRange) {\n      filteredActions = actions.filter(action => {\n        const performedAt = new Date(action.performedAt);\n        return performedAt >= options.dateRange!.start && performedAt <= options.dateRange!.end;\n      });\n    }\n\n    // Enrich actions with incident information\n    const enrichedData = filteredActions.map(action => {\n      const incident = incidents.find(inc => inc.id === action.incidentId);\n      \n      return {\n        id: action.id,\n        incidentId: action.incidentId,\n        incidentSeverity: incident?.severity || 'Unknown',\n        incidentStatus: incident?.status || 'Unknown',\n        actionType: action.actionType,\n        performedBy: action.performedBy || 'System',\n        performedAt: new Date(action.performedAt).toISOString(),\n        payload: JSON.stringify(action.payload),\n        automated: action.performedBy === 'system' ? 'Yes' : 'No',\n        bulkOperation: (action.payload as any)?.bulkOperation ? 'Yes' : 'No'\n      };\n    });\n\n    if (options.format === 'csv') {\n      return this.convertToCSV(enrichedData);\n    } else {\n      return JSON.stringify({\n        exportedAt: new Date().toISOString(),\n        totalCount: enrichedData.length,\n        dateRange: options.dateRange,\n        data: enrichedData\n      }, null, 2);\n    }\n  }\n\n  private static convertToCSV(data: any[]): string {\n    if (data.length === 0) return '';\n    \n    const headers = Object.keys(data[0]);\n    const csvContent = [\n      headers.join(','),\n      ...data.map(row =>\n        headers.map(header => {\n          const value = row[header];\n          // Handle values that contain commas, quotes, or newlines\n          if (typeof value === 'string' && (value.includes(',') || value.includes('\"') || value.includes('\\n'))) {\n            return `\"${value.replace(/\"/g, '\"\"')}\"`;\n          }\n          return value !== null && value !== undefined ? value : '';\n        }).join(',')\n      )\n    ].join('\\n');\n    \n    return csvContent;\n  }\n\n  static getExportFilename(type: string, format: string): string {\n    const timestamp = new Date().toISOString().slice(0, 19).replace(/[:.]/g, '-');\n    return `soc-${type}-export-${timestamp}.${format}`;\n  }\n}","size_bytes":11871},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { kafkaService } from \"./kafka\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\n// Custom API logger middleware\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  // Initialize Kafka service for enterprise security event streaming\n  log('🎯 Initializing Kafka service for SOC operations...');\n  await kafkaService.initialize();\n  \n  const server = await registerRoutes(app);\n\n  // Error handler middleware\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // Setup Vite in development mode only\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // Use env.PORT or fallback to 5000\n  const port = parseInt(process.env.PORT || \"5000\");\n\n  // Graceful startup with EADDRINUSE check\n  server.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      // reusePort: true,\n    },\n    () => {\n      log(`✅ Server is running at http://localhost:${port}`);\n    }\n  ).on(\"error\", (err: any) => {\n    if (err.code === \"EADDRINUSE\") {\n      console.error(`❌ Port ${port} is already in use. Try killing the process or use a different port.`);\n      process.exit(1);\n    } else {\n      console.error(`❌ Unexpected server error: ${err.message}`);\n      process.exit(1);\n    }\n  });\n})();\n","size_bytes":2416},"server/kafka.ts":{"content":"import { Kafka, Consumer, Producer, logLevel } from 'kafkajs';\nimport { storage } from './storage';\nimport type { WebSocket } from 'ws';\nimport { OCSFTransformationService, type OCSFEvent } from './ocsf';\n\n// Kafka configuration for SOC Dashboard\nconst kafka = new Kafka({\n  clientId: 'soc-dashboard',\n  // Using local Kafka broker for development\n  // In production, this would be your Kafka cluster\n  brokers: ['localhost:9092'],\n  logLevel: logLevel.WARN,\n  retry: {\n    initialRetryTime: 300,\n    retries: 8\n  }\n});\n\n// Kafka Topics for SOC Operations\nexport const KAFKA_TOPICS = {\n  SECURITY_ALERTS: 'security-alerts',\n  INCIDENTS: 'incidents', \n  THREAT_INTEL: 'threat-intelligence',\n  SYSTEM_METRICS: 'system-metrics',\n  AUDIT_LOGS: 'audit-logs',\n  // OCSF Topics\n  OCSF_NETWORK_ACTIVITY: 'ocsf-network-activity',\n  OCSF_SYSTEM_ACTIVITY: 'ocsf-system-activity',\n  OCSF_SECURITY_FINDING: 'ocsf-security-finding',\n  OCSF_AUTHENTICATION: 'ocsf-authentication'\n} as const;\n\n// Standardized Security Event Schema\nexport interface SecurityEvent {\n  id: string;\n  timestamp: string;\n  source: string;\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  type: 'malware' | 'intrusion' | 'policy_violation' | 'anomaly' | 'threat_intel';\n  title: string;\n  description: string;\n  metadata: {\n    source_ip?: string;\n    destination_ip?: string;\n    user?: string;\n    file_hash?: string;\n    rule_id?: string;\n    [key: string]: any;\n  };\n  raw_data: any;\n}\n\nclass KafkaService {\n  private producer: Producer;\n  private consumer: Consumer;\n  private clients: Set<WebSocket> = new Set();\n\n  constructor() {\n    this.producer = kafka.producer({\n      transactionTimeout: 30000,\n    });\n    \n    this.consumer = kafka.consumer({ \n      groupId: 'soc-dashboard-group',\n      sessionTimeout: 30000,\n      heartbeatInterval: 3000,\n    });\n  }\n\n  async initialize() {\n    try {\n      // Connect producer and consumer\n      await this.producer.connect();\n      await this.consumer.connect();\n\n      // Subscribe to security event topics\n      await this.consumer.subscribe({ \n        topics: Object.values(KAFKA_TOPICS),\n        fromBeginning: false \n      });\n\n      console.log('🎯 Kafka service initialized for SOC Dashboard');\n      \n      // Start consuming events\n      this.startEventConsumer();\n      \n    } catch (error) {\n      console.error('❌ Failed to initialize Kafka service:', error);\n      // Graceful fallback - continue without Kafka for development\n      console.log('📡 Continuing without Kafka - using WebSocket only mode');\n    }\n  }\n\n  // Producer: Ingest security events from various sources\n  async publishSecurityEvent(event: SecurityEvent) {\n    try {\n      // Publish original event\n      await this.producer.send({\n        topic: KAFKA_TOPICS.SECURITY_ALERTS,\n        messages: [\n          {\n            key: event.id,\n            value: JSON.stringify(event),\n            timestamp: new Date(event.timestamp).getTime().toString(),\n            headers: {\n              source: event.source,\n              severity: event.severity,\n              type: event.type,\n              format: 'custom'\n            }\n          }\n        ]\n      });\n\n      // Transform to OCSF and publish to OCSF topic\n      await this.publishOCSFEvent(event);\n\n      console.log(`📨 Published security event: ${event.id} from ${event.source}`);\n    } catch (error) {\n      console.error('❌ Failed to publish security event:', error);\n      // Fallback: store directly in database\n      await this.fallbackStoreEvent(event);\n    }\n  }\n\n  // Producer: Publish OCSF-formatted events\n  async publishOCSFEvent(event: SecurityEvent | OCSFEvent) {\n    try {\n      // Transform to OCSF if it's a custom SecurityEvent\n      const ocsfEvent = 'class_uid' in event ? \n        event : \n        OCSFTransformationService.transformToOCSF(event);\n\n      const topic = this.getOCSFTopic(ocsfEvent.class_uid);\n\n      await this.producer.send({\n        topic,\n        messages: [\n          {\n            key: ocsfEvent.unmapped?.original_id || `ocsf_${Date.now()}`,\n            value: JSON.stringify(ocsfEvent),\n            timestamp: ocsfEvent.time.toString(),\n            headers: {\n              class_uid: ocsfEvent.class_uid.toString(),\n              class_name: ocsfEvent.class_name,\n              severity_id: ocsfEvent.severity_id.toString(),\n              format: 'ocsf'\n            }\n          }\n        ]\n      });\n\n      console.log(`📨 Published OCSF event: ${ocsfEvent.class_name} (${ocsfEvent.class_uid})`);\n    } catch (error) {\n      console.error('❌ Failed to publish OCSF event:', error);\n    }\n  }\n\n  // Get appropriate OCSF topic based on class UID\n  private getOCSFTopic(classUid: number): string {\n    switch (classUid) {\n      case 4001: return KAFKA_TOPICS.OCSF_NETWORK_ACTIVITY;\n      case 1001: return KAFKA_TOPICS.OCSF_SYSTEM_ACTIVITY;\n      case 2001: return KAFKA_TOPICS.OCSF_SECURITY_FINDING;\n      case 3002: return KAFKA_TOPICS.OCSF_AUTHENTICATION;\n      default: return KAFKA_TOPICS.OCSF_SECURITY_FINDING;\n    }\n  }\n\n  // Consumer: Process events and update dashboard\n  private async startEventConsumer() {\n    await this.consumer.run({\n      eachMessage: async ({ topic, partition, message, heartbeat }) => {\n        try {\n          if (!message.value) return;\n\n          const format = message.headers?.format?.toString() || 'custom';\n          \n          if (format === 'ocsf') {\n            // Process OCSF event\n            const ocsfEvent = JSON.parse(message.value.toString()) as OCSFEvent;\n            await this.processOCSFEvent(ocsfEvent, topic);\n            \n            // Convert to custom format for WebSocket broadcast\n            const customEvent = OCSFTransformationService.transformFromOCSF(ocsfEvent);\n            this.broadcastToClients({\n              type: 'security_event',\n              data: customEvent,\n              ocsf: ocsfEvent\n            });\n          } else {\n            // Process custom SecurityEvent\n            const event = JSON.parse(message.value.toString()) as SecurityEvent;\n            \n            // Process based on topic\n            switch (topic) {\n              case KAFKA_TOPICS.SECURITY_ALERTS:\n                await this.processSecurityAlert(event);\n                break;\n              case KAFKA_TOPICS.INCIDENTS:\n                await this.processIncident(event);\n                break;\n              case KAFKA_TOPICS.THREAT_INTEL:\n                await this.processThreatIntel(event);\n                break;\n              default:\n                console.log(`📥 Received event from topic: ${topic}`);\n            }\n\n            // Send to connected WebSocket clients for real-time updates\n            this.broadcastToClients({\n              type: 'security_event',\n              data: event\n            });\n          }\n\n          // Call heartbeat to prevent session timeout\n          await heartbeat();\n\n        } catch (error) {\n          console.error('❌ Error processing Kafka message:', error);\n        }\n      }\n    });\n  }\n\n  // Process OCSF events\n  private async processOCSFEvent(ocsfEvent: OCSFEvent, topic: string) {\n    try {\n      // Convert OCSF to custom format for storage\n      const customEvent = OCSFTransformationService.transformFromOCSF(ocsfEvent);\n      \n      // Store in database using existing logic\n      await this.processSecurityAlert(customEvent);\n      \n      // Additional OCSF-specific processing\n      await this.storeOCSFEvent(ocsfEvent);\n      \n      console.log(`🔄 Processed OCSF event: ${ocsfEvent.class_name} from ${topic}`);\n    } catch (error) {\n      console.error('❌ Error processing OCSF event:', error);\n    }\n  }\n\n  // Store OCSF event with full schema\n  private async storeOCSFEvent(ocsfEvent: OCSFEvent) {\n    try {\n      // Store raw OCSF event for compliance and analysis\n      await storage.createOCSFEvent({\n        classUid: ocsfEvent.class_uid,\n        className: ocsfEvent.class_name,\n        categoryUid: ocsfEvent.category_uid,\n        categoryName: ocsfEvent.category_name,\n        activityId: ocsfEvent.activity_id,\n        activityName: ocsfEvent.activity_name,\n        severityId: ocsfEvent.severity_id,\n        severity: ocsfEvent.severity,\n        time: new Date(ocsfEvent.time),\n        message: ocsfEvent.message,\n        rawData: ocsfEvent,\n        observables: JSON.stringify(ocsfEvent.observables || [])\n      });\n    } catch (error) {\n      console.error('❌ Error storing OCSF event:', error);\n    }\n  }\n\n  // Process security alerts from SIEM, EDR, Firewall systems\n  private async processSecurityAlert(event: SecurityEvent) {\n    try {\n      // Store normalized alert in database\n      await storage.createNormalizedAlert({\n        sourceId: event.source,\n        originalId: event.id,\n        timestamp: new Date(event.timestamp),\n        severity: event.severity,\n        alertType: event.type,\n        title: event.title,\n        description: event.description,\n        sourceIp: event.metadata.source_ip,\n        destinationIp: event.metadata.destination_ip,\n        username: event.metadata.user,\n        ruleId: event.metadata.rule_id,\n        rawData: event.raw_data,\n        status: 'open'\n      });\n\n      console.log(`🚨 Processed security alert: ${event.title} (${event.severity})`);\n\n    } catch (error) {\n      console.error('❌ Error processing security alert:', error);\n    }\n  }\n\n  // Process incident management events\n  private async processIncident(event: SecurityEvent) {\n    console.log(`🎯 Processing incident: ${event.title}`);\n    // Incident processing logic would go here\n  }\n\n  // Process threat intelligence feeds\n  private async processThreatIntel(event: SecurityEvent) {\n    console.log(`🔍 Processing threat intel: ${event.title}`);\n    // Threat intelligence processing logic would go here\n  }\n\n  // Fallback storage when Kafka is unavailable\n  private async fallbackStoreEvent(event: SecurityEvent) {\n    try {\n      await storage.createNormalizedAlert({\n        sourceId: event.source,\n        originalId: event.id,\n        timestamp: new Date(event.timestamp),\n        severity: event.severity,\n        alertType: event.type,\n        title: event.title,\n        description: event.description,\n        sourceIp: event.metadata.source_ip,\n        destinationIp: event.metadata.destination_ip,\n        username: event.metadata.user,\n        ruleId: event.metadata.rule_id,\n        rawData: event.raw_data,\n        status: 'open'\n      });\n      \n      console.log(`💾 Stored event as fallback: ${event.id}`);\n    } catch (error) {\n      console.error('❌ Fallback storage failed:', error);\n    }\n  }\n\n  // WebSocket client management\n  addClient(ws: WebSocket) {\n    this.clients.add(ws);\n    console.log(`📡 WebSocket client connected. Total: ${this.clients.size}`);\n  }\n\n  removeClient(ws: WebSocket) {\n    this.clients.delete(ws);\n    console.log(`📡 WebSocket client disconnected. Total: ${this.clients.size}`);\n  }\n\n  // Broadcast to all connected dashboard clients\n  private broadcastToClients(message: any) {\n    const payload = JSON.stringify(message);\n    this.clients.forEach(client => {\n      if (client.readyState === 1) { // WebSocket.OPEN\n        try {\n          client.send(payload);\n        } catch (error) {\n          console.error('Error sending to WebSocket client:', error);\n          this.clients.delete(client);\n        }\n      }\n    });\n  }\n\n  // Simulate security events for demo purposes\n  async simulateSecurityEvents() {\n    const demoEvents: SecurityEvent[] = [\n      {\n        id: `evt_${Date.now()}_1`,\n        timestamp: new Date().toISOString(),\n        source: 'Firewall-PaloAlto',\n        severity: 'high',\n        type: 'intrusion',\n        title: 'Suspicious Port Scan Detected',\n        description: 'Multiple port scan attempts from external IP',\n        metadata: {\n          source_ip: '192.168.1.100',\n          destination_ip: '10.0.1.50',\n          rule_id: 'FW-001'\n        },\n        raw_data: { protocol: 'TCP', ports: [22, 80, 443, 3389] }\n      },\n      {\n        id: `evt_${Date.now()}_2`,\n        timestamp: new Date().toISOString(),\n        source: 'EDR-CrowdStrike',\n        severity: 'critical',\n        type: 'malware',\n        title: 'Malware Detection: Trojan.Win32.Generic',\n        description: 'Malicious executable detected and quarantined',\n        metadata: {\n          user: 'john.smith@company.com',\n          file_hash: 'a1b2c3d4e5f6789012345678901234567890abcd',\n          rule_id: 'ML-DETECTION-001'\n        },\n        raw_data: { file_path: 'C:\\\\temp\\\\suspicious.exe', action: 'quarantined' }\n      }\n    ];\n\n    for (const event of demoEvents) {\n      await this.publishSecurityEvent(event);\n      // Small delay between events\n      await new Promise(resolve => setTimeout(resolve, 2000));\n    }\n  }\n\n  async shutdown() {\n    try {\n      await this.producer.disconnect();\n      await this.consumer.disconnect();\n      console.log('🔌 Kafka service disconnected');\n    } catch (error) {\n      console.error('❌ Error shutting down Kafka service:', error);\n    }\n  }\n}\n\nexport const kafkaService = new KafkaService();\n\n// API endpoint helpers for external systems\nexport class SecurityEventIngestion {\n  \n  // Endpoint for SIEM systems to send alerts\n  static async ingestSIEMAlert(data: any) {\n    const event: SecurityEvent = {\n      id: `siem_${data.id || Date.now()}`,\n      timestamp: data.timestamp || new Date().toISOString(),\n      source: data.source || 'SIEM-Unknown',\n      severity: data.severity || 'medium',\n      type: data.type || 'anomaly',\n      title: data.title || 'SIEM Alert',\n      description: data.description || 'Alert from SIEM system',\n      metadata: data.metadata || {},\n      raw_data: data\n    };\n\n    await kafkaService.publishSecurityEvent(event);\n    return event;\n  }\n\n  // Endpoint for EDR systems\n  static async ingestEDRAlert(data: any) {\n    const event: SecurityEvent = {\n      id: `edr_${data.id || Date.now()}`,\n      timestamp: data.timestamp || new Date().toISOString(),\n      source: data.source || 'EDR-Unknown',\n      severity: data.severity || 'medium',\n      type: data.type || 'malware',\n      title: data.title || 'EDR Detection',\n      description: data.description || 'Detection from EDR system',\n      metadata: data.metadata || {},\n      raw_data: data\n    };\n\n    await kafkaService.publishSecurityEvent(event);\n    return event;\n  }\n\n  // Endpoint for Firewall systems\n  static async ingestFirewallAlert(data: any) {\n    const event: SecurityEvent = {\n      id: `fw_${data.id || Date.now()}`,\n      timestamp: data.timestamp || new Date().toISOString(),\n      source: data.source || 'Firewall-Unknown',\n      severity: data.severity || 'medium',\n      type: data.type || 'intrusion',\n      title: data.title || 'Firewall Alert',\n      description: data.description || 'Alert from firewall system',\n      metadata: data.metadata || {},\n      raw_data: data\n    };\n\n    await kafkaService.publishSecurityEvent(event);\n    return event;\n  }\n\n  // === OCSF Ingestion Endpoints ===\n  \n  // Endpoint for OCSF Network Activity events\n  static async ingestOCSFNetworkActivity(data: any) {\n    // Validate that it's a Network Activity event\n    if (data.class_uid !== 4001) {\n      throw new Error('Invalid OCSF Network Activity event: class_uid must be 4001');\n    }\n    \n    await kafkaService.publishOCSFEvent(data as OCSFEvent);\n    return data;\n  }\n  \n  // Endpoint for OCSF System Activity events\n  static async ingestOCSFSystemActivity(data: any) {\n    // Validate that it's a System Activity event\n    if (data.class_uid !== 1001) {\n      throw new Error('Invalid OCSF System Activity event: class_uid must be 1001');\n    }\n    \n    await kafkaService.publishOCSFEvent(data as OCSFEvent);\n    return data;\n  }\n  \n  // Endpoint for OCSF Security Finding events\n  static async ingestOCSFSecurityFinding(data: any) {\n    // Validate that it's a Security Finding event\n    if (data.class_uid !== 2001) {\n      throw new Error('Invalid OCSF Security Finding event: class_uid must be 2001');\n    }\n    \n    await kafkaService.publishOCSFEvent(data as OCSFEvent);\n    return data;\n  }\n  \n  // Endpoint for OCSF Authentication events\n  static async ingestOCSFAuthentication(data: any) {\n    // Validate that it's an Authentication event\n    if (data.class_uid !== 3002) {\n      throw new Error('Invalid OCSF Authentication event: class_uid must be 3002');\n    }\n    \n    await kafkaService.publishOCSFEvent(data as OCSFEvent);\n    return data;\n  }\n  \n  // Generic OCSF ingestion endpoint\n  static async ingestOCSFEvent(data: any) {\n    // Basic OCSF validation\n    if (!data.class_uid || !data.class_name || !data.time) {\n      throw new Error('Invalid OCSF event: missing required fields (class_uid, class_name, time)');\n    }\n    \n    await kafkaService.publishOCSFEvent(data as OCSFEvent);\n    return data;\n  }\n  \n  // Bulk OCSF ingestion endpoint\n  static async ingestOCSFEventsBulk(events: any[]) {\n    const results = [];\n    \n    for (const event of events) {\n      try {\n        const result = await this.ingestOCSFEvent(event);\n        results.push({ success: true, event: result });\n      } catch (error) {\n        results.push({ \n          success: false, \n          error: error instanceof Error ? error.message : 'Unknown error',\n          event\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  // Transform legacy events to OCSF and ingest\n  static async transformAndIngestLegacyEvent(data: any, sourceType: 'siem' | 'edr' | 'firewall') {\n    // First create a custom SecurityEvent\n    let customEvent: SecurityEvent;\n    \n    switch (sourceType) {\n      case 'siem':\n        customEvent = await this.ingestSIEMAlert(data);\n        break;\n      case 'edr':\n        customEvent = await this.ingestEDRAlert(data);\n        break;\n      case 'firewall':\n        customEvent = await this.ingestFirewallAlert(data);\n        break;\n    }\n    \n    // Transform to OCSF and publish\n    const ocsfEvent = OCSFTransformationService.transformToOCSF(customEvent);\n    await kafkaService.publishOCSFEvent(ocsfEvent);\n    \n    return {\n      customEvent,\n      ocsfEvent\n    };\n  }\n}","size_bytes":18128},"server/normalization.ts":{"content":"import { type RawAlert, type InsertRawAlert } from \"@shared/schema\";\n\n// Normalized alert structure that all sources will be converted to\nexport interface NormalizedAlertData {\n  sourceType: string;\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  alertType: string;\n  title: string;\n  description: string;\n  timestamp: Date;\n  sourceIP?: string;\n  destIP?: string;\n  hostname?: string;\n  username?: string;\n  filePath?: string;\n  fileHash?: string;\n  processName?: string;\n  networkInfo?: {\n    remoteIP?: string;\n    remotePort?: number;\n    protocol?: string;\n  };\n  additionalData: Record<string, any>;\n}\n\n// CrowdStrike alert structure\ninterface CrowdStrikeAlert {\n  alert_id: string;\n  detect_id: string;\n  device_name: string;\n  ip_address: string;\n  user_name: string;\n  file_name: string;\n  file_path: string;\n  file_hash_sha256: string;\n  severity: string;\n  tactic: string;\n  technique: string;\n  detect_name: string;\n  command_line: string;\n  timestamp: string;\n  event_platform: string;\n  event_type: string;\n  network_remote_ip: string;\n  network_remote_port: number;\n  protocol: string;\n  [key: string]: any;\n}\n\n// Email alert structure\ninterface EmailAlert {\n  alert_id: string;\n  sender_email: string;\n  recipient_email: string;\n  subject: string;\n  timestamp: string;\n  verdict: string;\n  malware_detected: string;\n  phishing_detected: boolean;\n  spam_score: number;\n  attachment_name?: string;\n  attachment_hash?: string;\n  detection_engine: string;\n  [key: string]: any;\n}\n\n// Firewall alert structure\ninterface FirewallAlert {\n  alert_id: string;\n  firewall_name: string;\n  src_ip: string;\n  dest_ip: string;\n  protocol: string;\n  action: string;\n  threat_type: string;\n  severity: string;\n  timestamp: string;\n  application: string;\n  [key: string]: any;\n}\n\n// SentinelOne alert structure\ninterface SentinelOneAlert {\n  alert_id: string;\n  agent_hostname: string;\n  agent_ip: string;\n  threat_classification: string;\n  detection_name: string;\n  file_path: string;\n  file_hash_sha256: string;\n  process_name: string;\n  verdict: string;\n  network_remote_ip: string;\n  network_remote_port: number;\n  timestamp: string;\n  [key: string]: any;\n}\n\nexport class AlertNormalizer {\n  \n  static normalizeCrowdStrike(rawAlert: CrowdStrikeAlert): NormalizedAlertData {\n    return {\n      sourceType: 'CrowdStrike',\n      severity: this.mapCrowdStrikeSeverity(rawAlert.severity),\n      alertType: rawAlert.detect_name,\n      title: `${rawAlert.detect_name} - ${rawAlert.device_name}`,\n      description: `${rawAlert.tactic} detected: ${rawAlert.technique} on ${rawAlert.device_name}`,\n      timestamp: new Date(rawAlert.timestamp),\n      hostname: rawAlert.device_name,\n      username: rawAlert.user_name,\n      filePath: rawAlert.file_path,\n      fileHash: rawAlert.file_hash_sha256,\n      processName: rawAlert.file_name,\n      networkInfo: {\n        remoteIP: rawAlert.network_remote_ip,\n        remotePort: rawAlert.network_remote_port,\n        protocol: rawAlert.protocol\n      },\n      additionalData: {\n        detectId: rawAlert.detect_id,\n        tactic: rawAlert.tactic,\n        technique: rawAlert.technique,\n        commandLine: rawAlert.command_line,\n        eventPlatform: rawAlert.event_platform,\n        eventType: rawAlert.event_type\n      }\n    };\n  }\n\n  static normalizeEmail(rawAlert: EmailAlert): NormalizedAlertData {\n    return {\n      sourceType: 'Email',\n      severity: this.mapEmailSeverity(rawAlert.verdict, rawAlert.spam_score),\n      alertType: 'email_threat',\n      title: `Email Threat - ${rawAlert.sender_email}`,\n      description: `Email from ${rawAlert.sender_email} to ${rawAlert.recipient_email}: ${rawAlert.subject}`,\n      timestamp: new Date(rawAlert.timestamp),\n      additionalData: {\n        senderEmail: rawAlert.sender_email,\n        recipientEmail: rawAlert.recipient_email,\n        subject: rawAlert.subject,\n        verdict: rawAlert.verdict,\n        malwareDetected: rawAlert.malware_detected,\n        phishingDetected: rawAlert.phishing_detected,\n        spamScore: rawAlert.spam_score,\n        attachmentName: rawAlert.attachment_name,\n        attachmentHash: rawAlert.attachment_hash,\n        detectionEngine: rawAlert.detection_engine\n      }\n    };\n  }\n\n  static normalizeFirewall(rawAlert: FirewallAlert): NormalizedAlertData {\n    return {\n      sourceType: 'Firewall',\n      severity: this.mapFirewallSeverity(rawAlert.severity),\n      alertType: rawAlert.threat_type,\n      title: `Firewall ${rawAlert.action} - ${rawAlert.threat_type}`,\n      description: `${rawAlert.threat_type} from ${rawAlert.src_ip} to ${rawAlert.dest_ip} - ${rawAlert.action}`,\n      timestamp: new Date(rawAlert.timestamp),\n      sourceIP: rawAlert.src_ip,\n      destIP: rawAlert.dest_ip,\n      hostname: rawAlert.firewall_name,\n      networkInfo: {\n        protocol: rawAlert.protocol\n      },\n      additionalData: {\n        firewallName: rawAlert.firewall_name,\n        action: rawAlert.action,\n        application: rawAlert.application,\n        srcPort: rawAlert.src_port,\n        destPort: rawAlert.dest_port,\n        ruleName: rawAlert.rule_name,\n        policyId: rawAlert.policy_id\n      }\n    };\n  }\n\n  static normalizeSentinelOne(rawAlert: SentinelOneAlert): NormalizedAlertData {\n    return {\n      sourceType: 'SentinelOne',\n      severity: this.mapSentinelOneSeverity(rawAlert.threat_classification, rawAlert.verdict),\n      alertType: rawAlert.threat_classification,\n      title: `${rawAlert.threat_classification} - ${rawAlert.agent_hostname}`,\n      description: `${rawAlert.detection_name} detected on ${rawAlert.agent_hostname}`,\n      timestamp: new Date(rawAlert.timestamp),\n      hostname: rawAlert.agent_hostname,\n      filePath: rawAlert.file_path,\n      fileHash: rawAlert.file_hash_sha256,\n      processName: rawAlert.process_name,\n      networkInfo: {\n        remoteIP: rawAlert.network_remote_ip,\n        remotePort: rawAlert.network_remote_port\n      },\n      additionalData: {\n        agentIP: rawAlert.agent_ip,\n        threatClassification: rawAlert.threat_classification,\n        detectionName: rawAlert.detection_name,\n        verdict: rawAlert.verdict,\n        agentUuid: rawAlert.agent_uuid\n      }\n    };\n  }\n\n  // Severity mapping functions\n  private static mapCrowdStrikeSeverity(severity: string): 'low' | 'medium' | 'high' | 'critical' {\n    switch (severity.toLowerCase()) {\n      case 'critical': return 'critical';\n      case 'high': return 'high';\n      case 'medium': return 'medium';\n      default: return 'low';\n    }\n  }\n\n  private static mapEmailSeverity(verdict: string, spamScore: number): 'low' | 'medium' | 'high' | 'critical' {\n    if (verdict === 'malicious') return 'critical';\n    if (verdict === 'suspicious') return 'high';\n    if (spamScore > 7) return 'medium';\n    return 'low';\n  }\n\n  private static mapFirewallSeverity(severity: string): 'low' | 'medium' | 'high' | 'critical' {\n    switch (severity.toLowerCase()) {\n      case 'critical': return 'critical';\n      case 'high': return 'high';\n      case 'medium': return 'medium';\n      case 'informational': return 'low';\n      default: return 'low';\n    }\n  }\n\n  private static mapSentinelOneSeverity(classification: string, verdict: string): 'low' | 'medium' | 'high' | 'critical' {\n    if (classification === 'Ransomware' || verdict === 'malicious') return 'critical';\n    if (classification === 'Trojan' || classification === 'Infostealer') return 'high';\n    if (verdict === 'suspicious') return 'medium';\n    return 'low';\n  }\n\n  // Main normalization function that detects source type and normalizes accordingly\n  static normalize(rawData: any, sourceType?: string): NormalizedAlertData {\n    // Auto-detect source type if not provided\n    if (!sourceType) {\n      if (rawData.detect_id && rawData.device_name) sourceType = 'crowdstrike';\n      else if (rawData.sender_email && rawData.recipient_email) sourceType = 'email';\n      else if (rawData.src_ip && rawData.dest_ip && rawData.firewall_name) sourceType = 'firewall';\n      else if (rawData.agent_uuid && rawData.threat_classification) sourceType = 'sentinelone';\n    }\n\n    switch (sourceType?.toLowerCase()) {\n      case 'crowdstrike':\n        return this.normalizeCrowdStrike(rawData);\n      case 'email':\n        return this.normalizeEmail(rawData);\n      case 'firewall':\n        return this.normalizeFirewall(rawData);\n      case 'sentinelone':\n        return this.normalizeSentinelOne(rawData);\n      default:\n        // Generic fallback normalization\n        return {\n          sourceType: sourceType || 'unknown',\n          severity: 'medium',\n          alertType: 'generic',\n          title: 'Unknown Alert Type',\n          description: 'Alert from unknown source',\n          timestamp: new Date(),\n          additionalData: rawData\n        };\n    }\n  }\n\n  // Convert normalized data to RawAlert format for database storage\n  static toRawAlert(normalizedData: NormalizedAlertData, sourceId: string): InsertRawAlert {\n    return {\n      sourceId,\n      severity: normalizedData.severity,\n      type: normalizedData.alertType,\n      description: normalizedData.description,\n      rawData: {\n        ...normalizedData.additionalData,\n        normalizedTitle: normalizedData.title,\n        timestamp: normalizedData.timestamp.toISOString(),\n        hostname: normalizedData.hostname,\n        username: normalizedData.username,\n        filePath: normalizedData.filePath,\n        fileHash: normalizedData.fileHash,\n        processName: normalizedData.processName,\n        sourceIP: normalizedData.sourceIP,\n        destIP: normalizedData.destIP,\n        networkInfo: normalizedData.networkInfo\n      }\n    };\n  }\n}","size_bytes":9644},"server/ocsf.ts":{"content":"import type { SecurityEvent } from './kafka';\n\n// OCSF Base Event Schema - Common attributes for all events\nexport interface OCSFBaseEvent {\n  // Core attributes\n  activity_id: number;\n  activity_name: string;\n  category_name: string;\n  category_uid: number;\n  class_name: string;\n  class_uid: number;\n  count?: number;\n  message?: string;\n  metadata: {\n    logged_time?: number;\n    original_time?: string;\n    processed_time?: number;\n    product?: {\n      name: string;\n      vendor_name: string;\n      version?: string;\n    };\n    profiles?: string[];\n    version: string;\n  };\n  observables?: OCSFObservable[];\n  raw_data?: any;\n  severity?: string;\n  severity_id: number;\n  status?: string;\n  status_id?: number;\n  time: number;\n  timezone_offset?: number;\n  type_name: string;\n  type_uid: number;\n  unmapped?: Record<string, any>;\n}\n\n// OCSF Observable for IOCs and artifacts\nexport interface OCSFObservable {\n  name: string;\n  type: string;\n  type_id: number;\n  value: string;\n}\n\n// OCSF Network Activity Event (Class 4001)\nexport interface OCSFNetworkActivity extends OCSFBaseEvent {\n  class_uid: 4001;\n  class_name: \"Network Activity\";\n  category_uid: 4;\n  category_name: \"Network Activity\";\n  \n  // Network-specific attributes\n  connection_info?: {\n    boundary?: string;\n    boundary_id?: number;\n    direction?: string;\n    direction_id?: number;\n    protocol_name?: string;\n    protocol_num?: number;\n    tcp_flags?: number;\n    uid?: string;\n  };\n  dst_endpoint?: OCSFEndpoint;\n  src_endpoint?: OCSFEndpoint;\n  traffic?: {\n    bytes?: number;\n    bytes_in?: number;\n    bytes_out?: number;\n    packets?: number;\n    packets_in?: number;\n    packets_out?: number;\n  };\n  disposition?: string;\n  disposition_id?: number;\n}\n\n// OCSF System Activity Event (Class 1001)\nexport interface OCSFSystemActivity extends OCSFBaseEvent {\n  class_uid: 1001;\n  class_name: \"Process Activity\";\n  category_uid: 1;\n  category_name: \"System Activity\";\n  \n  // System-specific attributes\n  actor?: OCSFActor;\n  device?: OCSFDevice;\n  process?: OCSFProcess;\n  file?: OCSFFile;\n  malware?: OCSFMalware[];\n  disposition?: string;\n  disposition_id?: number;\n}\n\n// OCSF Security Finding Event (Class 2001)\nexport interface OCSFSecurityFinding extends OCSFBaseEvent {\n  class_uid: 2001;\n  class_name: \"Security Finding\";\n  category_uid: 2;\n  category_name: \"Findings\";\n  \n  // Finding-specific attributes\n  finding?: {\n    created_time?: number;\n    desc?: string;\n    first_seen_time?: number;\n    last_seen_time?: number;\n    modified_time?: number;\n    product_uid?: string;\n    related_events?: any[];\n    remediation?: {\n      desc?: string;\n      kb_articles?: string[];\n    };\n    supporting_data?: any;\n    title?: string;\n    types?: string[];\n    uid: string;\n  };\n  confidence?: string;\n  confidence_id?: number;\n  confidence_score?: number;\n  impact?: string;\n  impact_id?: number;\n  impact_score?: number;\n  risk_level?: string;\n  risk_level_id?: number;\n  risk_score?: number;\n}\n\n// OCSF Authentication Event (Class 3002)\nexport interface OCSFAuthentication extends OCSFBaseEvent {\n  class_uid: 3002;\n  class_name: \"Authentication\";\n  category_uid: 3;\n  category_name: \"Identity & Access Management\";\n  \n  // Auth-specific attributes\n  user?: OCSFUser;\n  device?: OCSFDevice;\n  session?: OCSFSession;\n  auth_protocol?: string;\n  auth_protocol_id?: number;\n  logon_type?: string;\n  logon_type_id?: number;\n  is_remote?: boolean;\n  disposition?: string;\n  disposition_id?: number;\n}\n\n// Supporting OCSF Types\nexport interface OCSFEndpoint {\n  hostname?: string;\n  ip?: string;\n  port?: number;\n  subnet_uid?: string;\n  svc_name?: string;\n  uid?: string;\n}\n\nexport interface OCSFActor {\n  user?: OCSFUser;\n  process?: OCSFProcess;\n  session?: OCSFSession;\n}\n\nexport interface OCSFDevice {\n  hostname?: string;\n  ip?: string;\n  mac?: string;\n  name?: string;\n  os?: {\n    name?: string;\n    type?: string;\n    type_id?: number;\n    version?: string;\n  };\n  type?: string;\n  type_id?: number;\n  uid?: string;\n}\n\nexport interface OCSFUser {\n  account?: {\n    name?: string;\n    type?: string;\n    type_id?: number;\n    uid?: string;\n  };\n  credential_uid?: string;\n  domain?: string;\n  email_addr?: string;\n  full_name?: string;\n  name?: string;\n  type?: string;\n  type_id?: number;\n  uid?: string;\n}\n\nexport interface OCSFProcess {\n  cmd_line?: string;\n  created_time?: number;\n  file?: OCSFFile;\n  name?: string;\n  parent_process?: OCSFProcess;\n  pid?: number;\n  session?: OCSFSession;\n  terminated_time?: number;\n  tid?: number;\n  uid?: string;\n  user?: OCSFUser;\n}\n\nexport interface OCSFFile {\n  accessed_time?: number;\n  created_time?: number;\n  desc?: string;\n  hashes?: OCSFHash[];\n  mime_type?: string;\n  modified_time?: number;\n  name?: string;\n  owner?: OCSFUser;\n  parent_folder?: string;\n  path?: string;\n  security_descriptor?: string;\n  size?: number;\n  type?: string;\n  type_id?: number;\n  uid?: string;\n  version?: string;\n}\n\nexport interface OCSFHash {\n  algorithm?: string;\n  algorithm_id?: number;\n  value: string;\n}\n\nexport interface OCSFMalware {\n  classification_ids?: number[];\n  classifications?: string[];\n  name?: string;\n  path?: string;\n  provider?: string;\n  uid?: string;\n}\n\nexport interface OCSFSession {\n  created_time?: number;\n  credential_uid?: string;\n  expiration_time?: number;\n  is_remote?: boolean;\n  issuer?: string;\n  uid?: string;\n}\n\n// OCSF Event Union Type\nexport type OCSFEvent = OCSFNetworkActivity | OCSFSystemActivity | OCSFSecurityFinding | OCSFAuthentication;\n\n// OCSF Constants and Enumerations\nexport const OCSFConstants = {\n  // Severity mappings\n  SEVERITY: {\n    UNKNOWN: { id: 0, name: \"Unknown\" },\n    INFORMATIONAL: { id: 1, name: \"Informational\" },\n    LOW: { id: 2, name: \"Low\" },\n    MEDIUM: { id: 3, name: \"Medium\" },\n    HIGH: { id: 4, name: \"High\" },\n    CRITICAL: { id: 5, name: \"Critical\" },\n  },\n\n  // Activity IDs for different event types\n  NETWORK_ACTIVITY: {\n    UNKNOWN: { id: 0, name: \"Unknown\" },\n    ALLOWED: { id: 1, name: \"Allowed\" },\n    DENIED: { id: 2, name: \"Denied\" },\n    BLOCKED: { id: 3, name: \"Blocked\" },\n  },\n\n  PROCESS_ACTIVITY: {\n    UNKNOWN: { id: 0, name: \"Unknown\" },\n    LAUNCH: { id: 1, name: \"Launch\" },\n    TERMINATE: { id: 2, name: \"Terminate\" },\n    BLOCK: { id: 3, name: \"Block\" },\n    QUARANTINE: { id: 4, name: \"Quarantine\" },\n  },\n\n  AUTHENTICATION: {\n    UNKNOWN: { id: 0, name: \"Unknown\" },\n    LOGON: { id: 1, name: \"Logon\" },\n    LOGOFF: { id: 2, name: \"Logoff\" },\n    AUTHENTICATION_TICKET: { id: 3, name: \"Authentication Ticket\" },\n  },\n\n  // Disposition mappings\n  DISPOSITION: {\n    UNKNOWN: { id: 0, name: \"Unknown\" },\n    ALLOWED: { id: 1, name: \"Allowed\" },\n    BLOCKED: { id: 2, name: \"Blocked\" },\n    QUARANTINED: { id: 3, name: \"Quarantined\" },\n    ISOLATED: { id: 4, name: \"Isolated\" },\n    DELETED: { id: 5, name: \"Deleted\" },\n    DROPPED: { id: 6, name: \"Dropped\" },\n    CUSTOM_ACTION: { id: 7, name: \"Custom Action\" },\n    APPROVED: { id: 8, name: \"Approved\" },\n    RESTORED: { id: 9, name: \"Restored\" },\n    EXONERATED: { id: 10, name: \"Exonerated\" },\n    CORRECTED: { id: 11, name: \"Corrected\" },\n    PARTIALLY_CORRECTED: { id: 12, name: \"Partially Corrected\" },\n    UNCORRECTED: { id: 13, name: \"Uncorrected\" },\n    DELAYED: { id: 14, name: \"Delayed\" },\n    DETECTED: { id: 15, name: \"Detected\" },\n    NO_ACTION: { id: 16, name: \"No Action\" },\n    LOGGED: { id: 17, name: \"Logged\" },\n  }\n} as const;\n\n// OCSF Transformation Service\nexport class OCSFTransformationService {\n  \n  // Convert custom SecurityEvent to OCSF format\n  static transformToOCSF(event: SecurityEvent): OCSFEvent {\n    const baseTime = new Date(event.timestamp).getTime();\n    \n    // Common base attributes for all OCSF events\n    const baseEvent: Partial<OCSFBaseEvent> = {\n      count: 1,\n      message: event.description,\n      metadata: {\n        logged_time: baseTime,\n        original_time: event.timestamp,\n        processed_time: Date.now(),\n        product: {\n          name: event.source,\n          vendor_name: this.extractVendorName(event.source),\n        },\n        profiles: [\"security_control\"],\n        version: \"1.1.0\"\n      },\n      raw_data: event.raw_data,\n      severity: this.mapSeverity(event.severity).name,\n      severity_id: this.mapSeverity(event.severity).id,\n      time: baseTime,\n      unmapped: {\n        original_id: event.id,\n        original_source: event.source\n      }\n    };\n\n    // Transform based on event type\n    switch (event.type) {\n      case 'intrusion':\n        return this.transformToNetworkActivity(event, baseEvent);\n      \n      case 'malware':\n        return this.transformToSystemActivity(event, baseEvent);\n      \n      case 'policy_violation':\n      case 'anomaly':\n      case 'threat_intel':\n        return this.transformToSecurityFinding(event, baseEvent);\n      \n      default:\n        return this.transformToSecurityFinding(event, baseEvent);\n    }\n  }\n\n  // Convert OCSF event back to custom SecurityEvent format\n  static transformFromOCSF(ocsfEvent: OCSFEvent): SecurityEvent {\n    return {\n      id: ocsfEvent.unmapped?.original_id || `ocsf_${Date.now()}`,\n      timestamp: ocsfEvent.metadata.original_time || new Date(ocsfEvent.time).toISOString(),\n      source: ocsfEvent.unmapped?.original_source || ocsfEvent.metadata.product?.name || 'OCSF-Unknown',\n      severity: this.mapOCSFSeverity(ocsfEvent.severity_id),\n      type: this.mapOCSFEventType(ocsfEvent.class_uid),\n      title: this.extractTitle(ocsfEvent),\n      description: ocsfEvent.message || 'OCSF Event',\n      metadata: this.extractMetadata(ocsfEvent),\n      raw_data: ocsfEvent.raw_data || ocsfEvent\n    };\n  }\n\n  // Transform to Network Activity (Class 4001)\n  private static transformToNetworkActivity(event: SecurityEvent, base: Partial<OCSFBaseEvent>): OCSFNetworkActivity {\n    return {\n      ...base,\n      activity_id: OCSFConstants.NETWORK_ACTIVITY.BLOCKED.id,\n      activity_name: OCSFConstants.NETWORK_ACTIVITY.BLOCKED.name,\n      category_name: \"Network Activity\",\n      category_uid: 4,\n      class_name: \"Network Activity\",\n      class_uid: 4001,\n      type_name: `Network Activity: ${OCSFConstants.NETWORK_ACTIVITY.BLOCKED.name}`,\n      type_uid: 400102, // 4001 (class) + 02 (activity)\n      \n      connection_info: {\n        direction: \"Unknown\",\n        direction_id: 0,\n        protocol_name: event.raw_data?.protocol || \"TCP\"\n      },\n      \n      src_endpoint: event.metadata.source_ip ? {\n        ip: event.metadata.source_ip,\n        uid: event.metadata.source_ip\n      } : undefined,\n      \n      dst_endpoint: event.metadata.destination_ip ? {\n        ip: event.metadata.destination_ip,\n        uid: event.metadata.destination_ip\n      } : undefined,\n      \n      disposition: OCSFConstants.DISPOSITION.BLOCKED.name,\n      disposition_id: OCSFConstants.DISPOSITION.BLOCKED.id,\n      \n      observables: this.extractNetworkObservables(event)\n    } as OCSFNetworkActivity;\n  }\n\n  // Transform to System Activity (Class 1001)\n  private static transformToSystemActivity(event: SecurityEvent, base: Partial<OCSFBaseEvent>): OCSFSystemActivity {\n    const disposition = event.raw_data?.action === 'quarantined' \n      ? OCSFConstants.DISPOSITION.QUARANTINED\n      : OCSFConstants.DISPOSITION.BLOCKED;\n\n    return {\n      ...base,\n      activity_id: OCSFConstants.PROCESS_ACTIVITY.QUARANTINE.id,\n      activity_name: OCSFConstants.PROCESS_ACTIVITY.QUARANTINE.name,\n      category_name: \"System Activity\",\n      category_uid: 1,\n      class_name: \"Process Activity\",\n      class_uid: 1001,\n      type_name: `Process Activity: ${OCSFConstants.PROCESS_ACTIVITY.QUARANTINE.name}`,\n      type_uid: 100104, // 1001 (class) + 04 (quarantine activity)\n      \n      actor: {\n        user: event.metadata.user ? {\n          name: event.metadata.user,\n          email_addr: event.metadata.user,\n          uid: event.metadata.user\n        } : undefined\n      },\n      \n      file: event.raw_data?.file_path ? {\n        path: event.raw_data.file_path,\n        name: event.raw_data.file_path.split('/').pop() || event.raw_data.file_path,\n        hashes: event.metadata.file_hash ? [{\n          algorithm: \"Unknown\",\n          algorithm_id: 0,\n          value: event.metadata.file_hash\n        }] : undefined\n      } : undefined,\n      \n      malware: [{\n        name: event.title,\n        classification_ids: [1], // Trojan\n        classifications: [\"Trojan\"],\n        provider: event.source\n      }],\n      \n      disposition: disposition.name,\n      disposition_id: disposition.id,\n      \n      observables: this.extractSystemObservables(event)\n    } as OCSFSystemActivity;\n  }\n\n  // Transform to Security Finding (Class 2001)\n  private static transformToSecurityFinding(event: SecurityEvent, base: Partial<OCSFBaseEvent>): OCSFSecurityFinding {\n    return {\n      ...base,\n      activity_id: 1, // Create\n      activity_name: \"Create\",\n      category_name: \"Findings\",\n      category_uid: 2,\n      class_name: \"Security Finding\",\n      class_uid: 2001,\n      type_name: \"Security Finding: Create\",\n      type_uid: 200101, // 2001 (class) + 01 (create activity)\n      \n      finding: {\n        created_time: new Date(event.timestamp).getTime(),\n        desc: event.description,\n        title: event.title,\n        uid: event.id,\n        types: [event.type],\n        supporting_data: event.raw_data\n      },\n      \n      confidence: \"Medium\",\n      confidence_id: 50,\n      confidence_score: 50,\n      \n      risk_level: event.severity,\n      risk_level_id: this.mapSeverity(event.severity).id,\n      risk_score: this.mapSeverityToScore(event.severity),\n      \n      observables: this.extractGeneralObservables(event)\n    } as OCSFSecurityFinding;\n  }\n\n  // Helper methods\n  private static extractVendorName(source: string): string {\n    if (source.includes('PaloAlto')) return 'Palo Alto Networks';\n    if (source.includes('CrowdStrike')) return 'CrowdStrike';\n    if (source.includes('Splunk')) return 'Splunk';\n    if (source.includes('Elastic')) return 'Elastic';\n    return 'Unknown';\n  }\n\n  private static mapSeverity(severity: string): { id: number; name: string } {\n    switch (severity.toLowerCase()) {\n      case 'low': return OCSFConstants.SEVERITY.LOW;\n      case 'medium': return OCSFConstants.SEVERITY.MEDIUM;\n      case 'high': return OCSFConstants.SEVERITY.HIGH;\n      case 'critical': return OCSFConstants.SEVERITY.CRITICAL;\n      default: return OCSFConstants.SEVERITY.UNKNOWN;\n    }\n  }\n\n  private static mapOCSFSeverity(severityId: number): 'low' | 'medium' | 'high' | 'critical' {\n    switch (severityId) {\n      case 2: return 'low';\n      case 3: return 'medium';\n      case 4: return 'high';\n      case 5: return 'critical';\n      default: return 'medium';\n    }\n  }\n\n  private static mapOCSFEventType(classUid: number): 'malware' | 'intrusion' | 'policy_violation' | 'anomaly' | 'threat_intel' {\n    switch (classUid) {\n      case 4001: return 'intrusion'; // Network Activity\n      case 1001: return 'malware';   // System Activity\n      case 2001: return 'anomaly';   // Security Finding\n      case 3002: return 'policy_violation'; // Authentication\n      default: return 'anomaly';\n    }\n  }\n\n  private static mapSeverityToScore(severity: string): number {\n    switch (severity.toLowerCase()) {\n      case 'low': return 25;\n      case 'medium': return 50;\n      case 'high': return 75;\n      case 'critical': return 100;\n      default: return 50;\n    }\n  }\n\n  private static extractTitle(ocsfEvent: OCSFEvent): string {\n    if ('finding' in ocsfEvent && ocsfEvent.finding?.title) {\n      return ocsfEvent.finding.title;\n    }\n    return `${ocsfEvent.class_name}: ${ocsfEvent.activity_name}`;\n  }\n\n  private static extractMetadata(ocsfEvent: OCSFEvent): any {\n    const metadata: any = {};\n\n    // Extract network metadata\n    if ('src_endpoint' in ocsfEvent && ocsfEvent.src_endpoint?.ip) {\n      metadata.source_ip = ocsfEvent.src_endpoint.ip;\n    }\n    if ('dst_endpoint' in ocsfEvent && ocsfEvent.dst_endpoint?.ip) {\n      metadata.destination_ip = ocsfEvent.dst_endpoint.ip;\n    }\n\n    // Extract system metadata\n    if ('actor' in ocsfEvent && ocsfEvent.actor?.user?.name) {\n      metadata.user = ocsfEvent.actor.user.name;\n    }\n    if ('file' in ocsfEvent && ocsfEvent.file?.hashes?.[0]?.value) {\n      metadata.file_hash = ocsfEvent.file.hashes[0].value;\n    }\n\n    // Extract rule ID from metadata\n    if (ocsfEvent.metadata.product?.name) {\n      metadata.rule_id = `${ocsfEvent.metadata.product.name}-${ocsfEvent.class_uid}`;\n    }\n\n    return metadata;\n  }\n\n  private static extractNetworkObservables(event: SecurityEvent): OCSFObservable[] {\n    const observables: OCSFObservable[] = [];\n    \n    if (event.metadata.source_ip) {\n      observables.push({\n        name: \"source_ip\",\n        type: \"IP Address\",\n        type_id: 2,\n        value: event.metadata.source_ip\n      });\n    }\n    \n    if (event.metadata.destination_ip) {\n      observables.push({\n        name: \"destination_ip\", \n        type: \"IP Address\",\n        type_id: 2,\n        value: event.metadata.destination_ip\n      });\n    }\n\n    return observables;\n  }\n\n  private static extractSystemObservables(event: SecurityEvent): OCSFObservable[] {\n    const observables: OCSFObservable[] = [];\n    \n    if (event.metadata.file_hash) {\n      observables.push({\n        name: \"file_hash\",\n        type: \"Hash\",\n        type_id: 7,\n        value: event.metadata.file_hash\n      });\n    }\n    \n    if (event.metadata.user) {\n      observables.push({\n        name: \"user\",\n        type: \"User Name\",\n        type_id: 4,\n        value: event.metadata.user\n      });\n    }\n\n    return observables;\n  }\n\n  private static extractGeneralObservables(event: SecurityEvent): OCSFObservable[] {\n    const observables: OCSFObservable[] = [];\n    \n    // Add any relevant observables from metadata\n    Object.entries(event.metadata).forEach(([key, value]) => {\n      if (value && typeof value === 'string') {\n        observables.push({\n          name: key,\n          type: \"Other\",\n          type_id: 99,\n          value: value\n        });\n      }\n    });\n\n    return observables;\n  }\n}","size_bytes":18099},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { WebSocketServer, WebSocket } from \"ws\";\nimport { storage } from \"./storage\";\nimport { AlertProcessor } from \"./alertProcessor\";\nimport { AlertNormalizer } from \"./normalization\";\nimport { ThreatIntelligenceService } from \"./threatIntelligence\";\nimport { AnalyticsService } from \"./analyticsService\";\nimport { ExportService } from \"./exportService\";\nimport { isAuthenticated } from \"./auth\";\nimport session from \"express-session\";\nimport { AuthService } from \"./auth\";\nimport { registerUserSchema, loginUserSchema } from \"@shared/schema\";\nimport { insertSourceSchema, insertRawAlertSchema, insertIncidentSchema, insertActionSchema, insertFeedbackSchema, insertModelMetricSchema } from \"@shared/schema\";\nimport { ZodError } from \"zod\";\nimport { kafkaService, SecurityEventIngestion } from \"./kafka\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  const httpServer = createServer(app);\n\n  // Setup session middleware\n  app.use(session({\n    secret: process.env.SESSION_SECRET || 'development-secret-change-in-production',\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: false, // Set to true in production with HTTPS\n      maxAge: 7 * 24 * 60 * 60 * 1000, // 1 week\n    },\n  }));\n\n  // WebSocket server for real-time updates\n  const wss = new WebSocketServer({ server: httpServer, path: '/ws' });\n  \n  const clients = new Set<WebSocket>();\n\n  wss.on('connection', (ws) => {\n    clients.add(ws);\n    \n    // Register client with Kafka service for real-time event streaming\n    kafkaService.addClient(ws);\n    \n    ws.on('close', () => {\n      clients.delete(ws);\n      kafkaService.removeClient(ws);\n    });\n\n    // Send welcome message\n    ws.send(JSON.stringify({ type: 'connected', message: 'WebSocket connected' }));\n  });\n\n  // Broadcast function for real-time updates\n  const broadcast = (data: any) => {\n    clients.forEach(client => {\n      if (client.readyState === WebSocket.OPEN) {\n        client.send(JSON.stringify(data));\n      }\n    });\n  };\n\n  // Auth routes\n  app.post('/api/auth/register', async (req, res) => {\n    try {\n      const validatedData = registerUserSchema.parse(req.body);\n      const user = await AuthService.registerUser(validatedData);\n      \n      // Log user in automatically after registration\n      req.session.userId = user.id;\n      \n      res.status(201).json(user);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        return res.status(400).json({ error: 'Invalid registration data', details: error.errors });\n      }\n      res.status(400).json({ error: error instanceof Error ? error.message : 'Registration failed' });\n    }\n  });\n\n  app.post('/api/auth/login', async (req, res) => {\n    try {\n      const validatedData = loginUserSchema.parse(req.body);\n      const user = await AuthService.loginUser(validatedData.email, validatedData.password);\n      \n      // Store user session\n      req.session.userId = user.id;\n      \n      res.json(user);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        return res.status(400).json({ error: 'Invalid login data', details: error.errors });\n      }\n      res.status(401).json({ error: error instanceof Error ? error.message : 'Login failed' });\n    }\n  });\n\n  app.post('/api/auth/logout', (req, res) => {\n    req.session.destroy((err) => {\n      if (err) {\n        console.error('Session destruction error:', err);\n        return res.status(500).json({ error: 'Logout failed' });\n      }\n      res.clearCookie('connect.sid'); // Default session cookie name\n      res.json({ message: 'Logged out successfully' });\n    });\n  });\n\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      res.json(req.user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // Dashboard stats\n  app.get('/api/dashboard/stats', isAuthenticated, async (req, res) => {\n    try {\n      const stats = await storage.getDashboardStats();\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch dashboard stats' });\n    }\n  });\n\n  // Sources endpoints\n  app.get('/api/sources', isAuthenticated, async (req, res) => {\n    try {\n      const sources = await storage.getSources();\n      res.json(sources);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch sources' });\n    }\n  });\n\n  app.get('/api/sources/:id', async (req, res) => {\n    try {\n      const source = await storage.getSource(req.params.id);\n      if (!source) {\n        return res.status(404).json({ error: 'Source not found' });\n      }\n      res.json(source);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch source' });\n    }\n  });\n\n  app.post('/api/sources', isAuthenticated, async (req, res) => {\n    try {\n      const validatedData = insertSourceSchema.parse(req.body);\n      const source = await storage.createSource(validatedData);\n      \n      broadcast({ type: 'source_created', data: source });\n      res.status(201).json(source);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        return res.status(400).json({ error: 'Invalid source data', details: error.errors });\n      }\n      res.status(500).json({ error: 'Failed to create source' });\n    }\n  });\n\n  app.put('/api/sources/:id', async (req, res) => {\n    try {\n      const source = await storage.updateSource(req.params.id, req.body);\n      if (!source) {\n        return res.status(404).json({ error: 'Source not found' });\n      }\n      \n      broadcast({ type: 'source_updated', data: source });\n      res.json(source);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to update source' });\n    }\n  });\n\n  app.delete('/api/sources/:id', async (req, res) => {\n    try {\n      const success = await storage.deleteSource(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: 'Source not found' });\n      }\n      \n      broadcast({ type: 'source_deleted', data: { id: req.params.id } });\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to delete source' });\n    }\n  });\n\n  // Raw alerts endpoints\n  app.get('/api/alerts', async (req, res) => {\n    try {\n      const alerts = await storage.getRawAlerts();\n      res.json(alerts);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch alerts' });\n    }\n  });\n\n  app.post('/api/alerts', async (req, res) => {\n    try {\n      const validatedData = insertRawAlertSchema.parse(req.body);\n      const alert = await storage.createRawAlert(validatedData);\n      \n      broadcast({ type: 'alert_created', data: alert });\n      res.status(201).json(alert);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        return res.status(400).json({ error: 'Invalid alert data', details: error.errors });\n      }\n      res.status(500).json({ error: 'Failed to create alert' });\n    }\n  });\n\n  // New normalization endpoints\n  app.post('/api/alerts/normalize', async (req, res) => {\n    try {\n      const { alertData, sourceId, sourceType } = req.body;\n      \n      if (!alertData || !sourceId) {\n        return res.status(400).json({ error: 'Missing required fields: alertData, sourceId' });\n      }\n\n      const result = await AlertProcessor.processIncomingAlert(alertData, sourceId, sourceType);\n      \n      // Broadcast alert processing result\n      broadcast({ type: 'alert_normalized', data: result });\n      \n      // If incident was auto-created, broadcast incident creation\n      if (result.incidentCreated && result.incidentId) {\n        const incident = await storage.getIncident(result.incidentId);\n        broadcast({ type: 'incident_created', data: incident });\n      }\n      \n      res.status(201).json(result);\n    } catch (error) {\n      console.error('Normalization error:', error);\n      res.status(500).json({ error: 'Failed to normalize alert' });\n    }\n  });\n\n  app.post('/api/alerts/bulk-normalize', async (req, res) => {\n    try {\n      const { alerts } = req.body;\n      \n      if (!Array.isArray(alerts)) {\n        return res.status(400).json({ error: 'alerts must be an array' });\n      }\n\n      const results = await AlertProcessor.processBulkAlerts(alerts);\n      \n      broadcast({ type: 'alerts_bulk_normalized', data: { count: results.length } });\n      res.status(201).json({ processed: results.length, results });\n    } catch (error) {\n      console.error('Bulk normalization error:', error);\n      res.status(500).json({ error: 'Failed to normalize alerts' });\n    }\n  });\n\n  app.post('/api/alerts/simulate/:sourceType', async (req, res) => {\n    try {\n      const { sourceType } = req.params;\n      const count = parseInt(req.query.count as string) || 5;\n      \n      const results = await AlertProcessor.simulateIncomingAlerts(sourceType, count);\n      \n      broadcast({ type: 'alerts_simulated', data: { sourceType, count: results.length, usingRealData: true } });\n      res.status(201).json({ \n        message: `Generated ${results.length} ${sourceType} alerts using real data`,\n        results,\n        usingRealData: true\n      });\n    } catch (error) {\n      console.error('Simulation error:', error);\n      res.status(500).json({ error: error instanceof Error ? error.message : 'Failed to simulate alerts' });\n    }\n  });\n\n  // Real-time alert simulation\n  app.post('/api/alerts/simulate-realtime/:sourceType', async (req, res) => {\n    try {\n      const { sourceType } = req.params;\n      const durationMinutes = parseInt(req.query.duration as string) || 5;\n      const alertsPerMinute = parseInt(req.query.rate as string) || 2;\n      \n      // Start real-time simulation (runs in background)\n      AlertProcessor.simulateRealTimeAlerts(sourceType, durationMinutes, alertsPerMinute);\n      \n      broadcast({ \n        type: 'realtime_simulation_started', \n        data: { sourceType, durationMinutes, alertsPerMinute } \n      });\n      \n      res.status(202).json({ \n        message: `Real-time simulation started for ${sourceType}`,\n        duration: `${durationMinutes} minutes`,\n        rate: `${alertsPerMinute} alerts per minute`,\n        totalExpected: durationMinutes * alertsPerMinute\n      });\n    } catch (error) {\n      console.error('Real-time simulation error:', error);\n      res.status(500).json({ error: error instanceof Error ? error.message : 'Failed to start real-time simulation' });\n    }\n  });\n\n  // Get dataset statistics\n  app.get('/api/alerts/dataset-stats', async (req, res) => {\n    try {\n      const stats = await AlertProcessor.getDatasetStats();\n      res.json({\n        message: 'Alert dataset statistics',\n        stats,\n        sources: Object.keys(stats).filter(k => k !== 'total')\n      });\n    } catch (error) {\n      console.error('Dataset stats error:', error);\n      res.status(500).json({ error: 'Failed to get dataset statistics' });\n    }\n  });\n\n  // Get a sample alert from real data\n  app.get('/api/alerts/sample/:sourceType', async (req, res) => {\n    try {\n      const { sourceType } = req.params;\n      const sampleAlert = await AlertProcessor.getSampleAlert(sourceType);\n      \n      if (!sampleAlert) {\n        return res.status(404).json({ error: `No sample data available for ${sourceType}` });\n      }\n      \n      res.json({\n        sourceType,\n        sampleAlert,\n        message: `Sample ${sourceType} alert from real dataset`\n      });\n    } catch (error) {\n      console.error('Sample alert error:', error);\n      res.status(500).json({ error: 'Failed to get sample alert' });\n    }\n  });\n\n  // Test endpoint to validate normalization without storing\n  app.post('/api/alerts/test-normalize', async (req, res) => {\n    try {\n      const { alertData, sourceType } = req.body;\n      \n      if (!alertData) {\n        return res.status(400).json({ error: 'Missing alertData' });\n      }\n\n      const normalized = AlertNormalizer.normalize(alertData, sourceType);\n      res.json({ normalized, original: alertData });\n    } catch (error) {\n      console.error('Test normalization error:', error);\n      res.status(500).json({ error: 'Failed to test normalization' });\n    }\n  });\n\n  // Incidents endpoints\n  app.get('/api/incidents', isAuthenticated, async (req, res) => {\n    try {\n      const incidents = await storage.getIncidents();\n      res.json(incidents);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch incidents' });\n    }\n  });\n\n  app.get('/api/incidents/:id', async (req, res) => {\n    try {\n      const incident = await storage.getIncident(req.params.id);\n      if (!incident) {\n        return res.status(404).json({ error: 'Incident not found' });\n      }\n      res.json(incident);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch incident' });\n    }\n  });\n\n  app.post('/api/incidents', async (req, res) => {\n    try {\n      const validatedData = insertIncidentSchema.parse(req.body);\n      const incident = await storage.createIncident(validatedData);\n      \n      broadcast({ type: 'incident_created', data: incident });\n      res.status(201).json(incident);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        return res.status(400).json({ error: 'Invalid incident data', details: error.errors });\n      }\n      res.status(500).json({ error: 'Failed to create incident' });\n    }\n  });\n\n  app.put('/api/incidents/:id', async (req, res) => {\n    try {\n      const incident = await storage.updateIncident(req.params.id, req.body);\n      if (!incident) {\n        return res.status(404).json({ error: 'Incident not found' });\n      }\n      \n      broadcast({ type: 'incident_updated', data: incident });\n      res.json(incident);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to update incident' });\n    }\n  });\n\n  // Bulk incident operations\n  app.patch('/api/incidents/bulk', async (req, res) => {\n    try {\n      const { incidentIds, operation, data } = req.body;\n      \n      if (!incidentIds || !Array.isArray(incidentIds) || incidentIds.length === 0) {\n        return res.status(400).json({ error: 'incidentIds array is required' });\n      }\n      \n      if (!operation) {\n        return res.status(400).json({ error: 'operation is required' });\n      }\n\n      const results = [];\n      const errors = [];\n\n      for (const incidentId of incidentIds) {\n        try {\n          let updatedIncident;\n          \n          switch (operation) {\n            case 'assign':\n              if (!data?.assignedTo) {\n                throw new Error('assignedTo is required for assign operation');\n              }\n              updatedIncident = await storage.updateIncident(incidentId, { \n                assignedTo: data.assignedTo \n              });\n              \n              // Create action for the assignment\n              await storage.createAction({\n                incidentId,\n                actionType: 'ANALYST_ASSIGNMENT',\n                payload: { assignedTo: data.assignedTo, bulkOperation: true },\n                performedBy: data.performedBy || 'system'\n              });\n              break;\n              \n            case 'escalate':\n              updatedIncident = await storage.updateIncident(incidentId, { \n                severity: 'critical',\n                status: 'investigating'\n              });\n              \n              // Create action for the escalation\n              await storage.createAction({\n                incidentId,\n                actionType: 'ESCALATE',\n                payload: { escalatedTo: 'senior_analyst', bulkOperation: true },\n                performedBy: data?.performedBy || 'system'\n              });\n              break;\n              \n            case 'close':\n              updatedIncident = await storage.updateIncident(incidentId, { \n                status: 'resolved',\n                closedAt: new Date()\n              });\n              \n              // Create action for the closure\n              await storage.createAction({\n                incidentId,\n                actionType: 'CLOSE_INCIDENT',\n                payload: { reason: data?.reason || 'Bulk closure', bulkOperation: true },\n                performedBy: data?.performedBy || 'system'\n              });\n              break;\n              \n            case 'update_status':\n              if (!data?.status) {\n                throw new Error('status is required for update_status operation');\n              }\n              updatedIncident = await storage.updateIncident(incidentId, { \n                status: data.status \n              });\n              \n              // Create action for the status update\n              await storage.createAction({\n                incidentId,\n                actionType: 'STATUS_CHANGE',\n                payload: { newStatus: data.status, bulkOperation: true },\n                performedBy: data?.performedBy || 'system'\n              });\n              break;\n              \n            default:\n              throw new Error(`Unknown operation: ${operation}`);\n          }\n          \n          if (updatedIncident) {\n            results.push(updatedIncident);\n            broadcast({ type: 'incident_updated', data: updatedIncident });\n          }\n        } catch (error) {\n          errors.push({\n            incidentId,\n            error: error instanceof Error ? error.message : 'Unknown error'\n          });\n        }\n      }\n\n      res.json({\n        success: true,\n        updated: results.length,\n        errorCount: errors.length,\n        results,\n        errors\n      });\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to perform bulk operation' });\n    }\n  });\n\n  // Actions endpoints\n  app.get('/api/actions', async (req, res) => {\n    try {\n      const actions = await storage.getActions();\n      res.json(actions);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch actions' });\n    }\n  });\n\n  app.get('/api/incidents/:id/actions', async (req, res) => {\n    try {\n      const actions = await storage.getActionsByIncident(req.params.id);\n      res.json(actions);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch incident actions' });\n    }\n  });\n\n  app.post('/api/incidents/:id/actions', async (req, res) => {\n    try {\n      const validatedData = insertActionSchema.parse({\n        ...req.body,\n        incidentId: req.params.id\n      });\n      const action = await storage.createAction(validatedData);\n      \n      broadcast({ type: 'action_created', data: action });\n      res.status(201).json(action);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        return res.status(400).json({ error: 'Invalid action data', details: error.errors });\n      }\n      res.status(500).json({ error: 'Failed to create action' });\n    }\n  });\n\n  // Feedback endpoints\n  app.get('/api/feedback', async (req, res) => {\n    try {\n      const feedback = await storage.getFeedback();\n      res.json(feedback);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch feedback' });\n    }\n  });\n\n  app.get('/api/incidents/:id/feedback', async (req, res) => {\n    try {\n      const feedback = await storage.getFeedbackByIncident(req.params.id);\n      res.json(feedback);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch incident feedback' });\n    }\n  });\n\n  app.post('/api/feedback', async (req, res) => {\n    try {\n      const validatedData = insertFeedbackSchema.parse(req.body);\n      const feedback = await storage.createFeedback(validatedData);\n      \n      broadcast({ type: 'feedback_created', data: feedback });\n      res.status(201).json(feedback);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        return res.status(400).json({ error: 'Invalid feedback data', details: error.errors });\n      }\n      res.status(500).json({ error: 'Failed to create feedback' });\n    }\n  });\n\n  // Model metrics endpoints\n  app.get('/api/metrics', async (req, res) => {\n    try {\n      const metrics = await storage.getModelMetrics();\n      res.json(metrics);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch metrics' });\n    }\n  });\n\n  // Real-time analytics endpoint\n  app.get('/api/analytics/realtime', async (req, res) => {\n    try {\n      const analytics = await AnalyticsService.calculateRealTimeMetrics();\n      res.json(analytics);\n    } catch (error) {\n      console.error('Analytics calculation error:', error);\n      res.status(500).json({ error: 'Failed to calculate real-time analytics' });\n    }\n  });\n\n  app.post('/api/metrics', async (req, res) => {\n    try {\n      const validatedData = insertModelMetricSchema.parse(req.body);\n      const metric = await storage.createModelMetric(validatedData);\n      \n      broadcast({ type: 'metric_created', data: metric });\n      res.status(201).json(metric);\n    } catch (error) {\n      if (error instanceof ZodError) {\n        return res.status(400).json({ error: 'Invalid metric data', details: error.errors });\n      }\n      res.status(500).json({ error: 'Failed to create metric' });\n    }\n  });\n\n  // Threat intelligence endpoints\n  app.get('/api/threatintel', async (req, res) => {\n    try {\n      const indicators = await ThreatIntelligenceService.getIndicators();\n      res.json(indicators);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch threat intelligence indicators' });\n    }\n  });\n\n  app.get('/api/threatintel/stats', async (req, res) => {\n    try {\n      const stats = ThreatIntelligenceService.getStats();\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch threat intelligence stats' });\n    }\n  });\n\n  app.get('/api/threatintel/search', async (req, res) => {\n    try {\n      const query = req.query.q as string;\n      if (!query) {\n        return res.status(400).json({ error: 'Query parameter \"q\" is required' });\n      }\n      \n      const indicators = await ThreatIntelligenceService.searchIndicators(query);\n      res.json(indicators);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to search threat intelligence' });\n    }\n  });\n\n  app.get('/api/threatintel/type/:type', async (req, res) => {\n    try {\n      const { type } = req.params;\n      const indicators = await ThreatIntelligenceService.getIndicatorsByType(type);\n      res.json(indicators);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch indicators by type' });\n    }\n  });\n\n  app.post('/api/threatintel', async (req, res) => {\n    try {\n      const indicator = await ThreatIntelligenceService.addIndicator(req.body);\n      res.status(201).json(indicator);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to add threat intelligence indicator' });\n    }\n  });\n\n  app.put('/api/threatintel/:id', async (req, res) => {\n    try {\n      const { id } = req.params;\n      const indicator = await ThreatIntelligenceService.updateIndicator(id, req.body);\n      if (!indicator) {\n        return res.status(404).json({ error: 'Indicator not found' });\n      }\n      res.json(indicator);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to update threat intelligence indicator' });\n    }\n  });\n\n  app.delete('/api/threatintel/:id', async (req, res) => {\n    try {\n      const { id } = req.params;\n      const success = await ThreatIntelligenceService.deleteIndicator(id);\n      if (!success) {\n        return res.status(404).json({ error: 'Indicator not found' });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to delete threat intelligence indicator' });\n    }\n  });\n\n  // Correlation stats endpoint\n  app.get('/api/correlation/stats', async (req, res) => {\n    try {\n      const incidents = await storage.getIncidents();\n      const actions = await storage.getActions();\n      \n      const autoCreatedIncidents = actions.filter(action => \n        action.actionType === 'AUTOMATED_DETECTION'\n      ).length;\n      \n      const last24Hours = new Date(Date.now() - 24 * 60 * 60 * 1000);\n      const recentIncidents = incidents.filter(incident => \n        new Date(incident.createdAt) > last24Hours\n      );\n      \n      res.json({\n        totalIncidents: incidents.length,\n        autoCreatedIncidents,\n        recentIncidents: recentIncidents.length,\n        correlationAccuracy: 0.87, // This would come from ML metrics in real system\n        avgResponseTime: '4.2m'\n      });\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch correlation stats' });\n    }\n  });\n\n  // ========================================\n  // KAFKA SECURITY EVENT INGESTION ENDPOINTS  \n  // ========================================\n  \n  // SIEM Integration - Ingest alerts from SIEM systems (Splunk, QRadar, etc.)\n  app.post('/api/kafka/siem/alerts', async (req, res) => {\n    try {\n      const event = await SecurityEventIngestion.ingestSIEMAlert(req.body);\n      res.status(201).json({ \n        message: 'SIEM alert ingested successfully', \n        eventId: event.id \n      });\n    } catch (error) {\n      console.error('SIEM alert ingestion error:', error);\n      res.status(500).json({ error: 'Failed to ingest SIEM alert' });\n    }\n  });\n  \n  // EDR Integration - Ingest alerts from EDR systems (CrowdStrike, Microsoft Defender, etc.)\n  app.post('/api/kafka/edr/alerts', async (req, res) => {\n    try {\n      const event = await SecurityEventIngestion.ingestEDRAlert(req.body);\n      res.status(201).json({ \n        message: 'EDR alert ingested successfully', \n        eventId: event.id \n      });\n    } catch (error) {\n      console.error('EDR alert ingestion error:', error);\n      res.status(500).json({ error: 'Failed to ingest EDR alert' });\n    }\n  });\n  \n  // Firewall Integration - Ingest alerts from firewall systems\n  app.post('/api/kafka/firewall/alerts', async (req, res) => {\n    try {\n      const event = await SecurityEventIngestion.ingestFirewallAlert(req.body);\n      res.status(201).json({ \n        message: 'Firewall alert ingested successfully', \n        eventId: event.id \n      });\n    } catch (error) {\n      console.error('Firewall alert ingestion error:', error);\n      res.status(500).json({ error: 'Failed to ingest firewall alert' });\n    }\n  });\n  \n  // Demo endpoint to simulate live security events\n  app.post('/api/kafka/demo/simulate', async (req, res) => {\n    try {\n      console.log('🎭 Starting security event simulation...');\n      await kafkaService.simulateSecurityEvents();\n      res.json({ \n        message: 'Security event simulation started', \n        note: 'Events will stream to connected dashboards in real-time' \n      });\n    } catch (error) {\n      console.error('Event simulation error:', error);\n      res.status(500).json({ error: 'Failed to start event simulation' });\n    }\n  });\n\n  // === OCSF (Open Cybersecurity Schema Framework) Endpoints ===\n  \n  // Get all OCSF events\n  app.get('/api/ocsf/events', async (req, res) => {\n    try {\n      const events = await storage.getOCSFEvents();\n      res.json(events);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch OCSF events' });\n    }\n  });\n\n  // Get OCSF events by class\n  app.get('/api/ocsf/events/class/:classUid', async (req, res) => {\n    try {\n      const classUid = parseInt(req.params.classUid);\n      if (isNaN(classUid)) {\n        return res.status(400).json({ error: 'Invalid class UID' });\n      }\n      \n      const events = await storage.getOCSFEventsByClass(classUid);\n      res.json(events);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch OCSF events by class' });\n    }\n  });\n\n  // Get specific OCSF event\n  app.get('/api/ocsf/events/:id', async (req, res) => {\n    try {\n      const event = await storage.getOCSFEvent(req.params.id);\n      if (!event) {\n        return res.status(404).json({ error: 'OCSF event not found' });\n      }\n      res.json(event);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch OCSF event' });\n    }\n  });\n\n  // Ingest OCSF Network Activity events\n  app.post('/api/ocsf/network-activity', async (req, res) => {\n    try {\n      const event = await SecurityEventIngestion.ingestOCSFNetworkActivity(req.body);\n      res.status(201).json({ message: 'OCSF Network Activity event ingested successfully', event });\n    } catch (error) {\n      console.error('OCSF Network Activity ingestion error:', error);\n      res.status(400).json({ error: error instanceof Error ? error.message : 'Failed to ingest OCSF Network Activity event' });\n    }\n  });\n\n  // Ingest OCSF System Activity events\n  app.post('/api/ocsf/system-activity', async (req, res) => {\n    try {\n      const event = await SecurityEventIngestion.ingestOCSFSystemActivity(req.body);\n      res.status(201).json({ message: 'OCSF System Activity event ingested successfully', event });\n    } catch (error) {\n      console.error('OCSF System Activity ingestion error:', error);\n      res.status(400).json({ error: error instanceof Error ? error.message : 'Failed to ingest OCSF System Activity event' });\n    }\n  });\n\n  // Ingest OCSF Security Finding events\n  app.post('/api/ocsf/security-finding', async (req, res) => {\n    try {\n      const event = await SecurityEventIngestion.ingestOCSFSecurityFinding(req.body);\n      res.status(201).json({ message: 'OCSF Security Finding event ingested successfully', event });\n    } catch (error) {\n      console.error('OCSF Security Finding ingestion error:', error);\n      res.status(400).json({ error: error instanceof Error ? error.message : 'Failed to ingest OCSF Security Finding event' });\n    }\n  });\n\n  // Ingest OCSF Authentication events\n  app.post('/api/ocsf/authentication', async (req, res) => {\n    try {\n      const event = await SecurityEventIngestion.ingestOCSFAuthentication(req.body);\n      res.status(201).json({ message: 'OCSF Authentication event ingested successfully', event });\n    } catch (error) {\n      console.error('OCSF Authentication ingestion error:', error);\n      res.status(400).json({ error: error instanceof Error ? error.message : 'Failed to ingest OCSF Authentication event' });\n    }\n  });\n\n  // Generic OCSF event ingestion\n  app.post('/api/ocsf/events', async (req, res) => {\n    try {\n      const event = await SecurityEventIngestion.ingestOCSFEvent(req.body);\n      res.status(201).json({ message: 'OCSF event ingested successfully', event });\n    } catch (error) {\n      console.error('OCSF event ingestion error:', error);\n      res.status(400).json({ error: error instanceof Error ? error.message : 'Failed to ingest OCSF event' });\n    }\n  });\n\n  // Bulk OCSF event ingestion\n  app.post('/api/ocsf/events/bulk', async (req, res) => {\n    try {\n      const { events } = req.body;\n      \n      if (!Array.isArray(events)) {\n        return res.status(400).json({ error: 'events must be an array' });\n      }\n      \n      const results = await SecurityEventIngestion.ingestOCSFEventsBulk(events);\n      const successful = results.filter(r => r.success).length;\n      const failed = results.filter(r => !r.success).length;\n      \n      res.status(201).json({ \n        message: `Bulk OCSF ingestion completed: ${successful} successful, ${failed} failed`,\n        results,\n        summary: { successful, failed, total: results.length }\n      });\n    } catch (error) {\n      console.error('Bulk OCSF ingestion error:', error);\n      res.status(500).json({ error: 'Failed to process bulk OCSF ingestion' });\n    }\n  });\n\n  // Transform legacy events to OCSF and ingest\n  app.post('/api/ocsf/transform/:sourceType', async (req, res) => {\n    try {\n      const { sourceType } = req.params;\n      \n      if (!['siem', 'edr', 'firewall'].includes(sourceType)) {\n        return res.status(400).json({ error: 'Invalid source type. Must be: siem, edr, or firewall' });\n      }\n      \n      const result = await SecurityEventIngestion.transformAndIngestLegacyEvent(\n        req.body, \n        sourceType as 'siem' | 'edr' | 'firewall'\n      );\n      \n      res.status(201).json({ \n        message: `Legacy ${sourceType} event transformed to OCSF and ingested successfully`,\n        customEvent: result.customEvent,\n        ocsfEvent: result.ocsfEvent\n      });\n    } catch (error) {\n      console.error('OCSF transformation error:', error);\n      res.status(400).json({ error: error instanceof Error ? error.message : 'Failed to transform and ingest event' });\n    }\n  });\n\n  // OCSF schema validation endpoint\n  app.post('/api/ocsf/validate', async (req, res) => {\n    try {\n      const { event } = req.body;\n      \n      // Basic OCSF validation\n      const requiredFields = ['class_uid', 'class_name', 'time', 'category_uid', 'category_name'];\n      const missing = requiredFields.filter(field => !event[field]);\n      \n      if (missing.length > 0) {\n        return res.status(400).json({ \n          valid: false, \n          errors: [`Missing required fields: ${missing.join(', ')}`]\n        });\n      }\n      \n      // Check if class_uid is valid\n      const validClassUids = [1001, 2001, 3002, 4001]; // System, Finding, Auth, Network\n      if (!validClassUids.includes(event.class_uid)) {\n        return res.status(400).json({ \n          valid: false, \n          errors: [`Invalid class_uid: ${event.class_uid}. Supported: ${validClassUids.join(', ')}`]\n        });\n      }\n      \n      res.json({ \n        valid: true, \n        message: 'OCSF event is valid',\n        class_name: event.class_name,\n        class_uid: event.class_uid\n      });\n    } catch (error) {\n      console.error('OCSF validation error:', error);\n      res.status(500).json({ error: 'Failed to validate OCSF event' });\n    }\n  });\n\n  // Export endpoints\n  app.get('/api/export/incidents', async (req, res) => {\n    try {\n      const format = req.query.format as 'csv' | 'json' || 'json';\n      const startDate = req.query.start_date ? new Date(req.query.start_date as string) : undefined;\n      const endDate = req.query.end_date ? new Date(req.query.end_date as string) : undefined;\n      const severity = req.query.severity ? (req.query.severity as string).split(',') : undefined;\n      const status = req.query.status ? (req.query.status as string).split(',') : undefined;\n\n      const options = {\n        format,\n        dateRange: startDate && endDate ? { start: startDate, end: endDate } : undefined,\n        filters: {\n          severity,\n          status\n        }\n      };\n\n      const exportData = await ExportService.exportIncidents(options);\n      const filename = ExportService.getExportFilename('incidents', format);\n\n      res.setHeader('Content-Type', format === 'csv' ? 'text/csv' : 'application/json');\n      res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n      res.send(exportData);\n    } catch (error) {\n      console.error('Export incidents error:', error);\n      res.status(500).json({ error: 'Failed to export incidents' });\n    }\n  });\n\n  app.get('/api/export/alerts', async (req, res) => {\n    try {\n      const format = req.query.format as 'csv' | 'json' || 'json';\n      const startDate = req.query.start_date ? new Date(req.query.start_date as string) : undefined;\n      const endDate = req.query.end_date ? new Date(req.query.end_date as string) : undefined;\n      const severity = req.query.severity ? (req.query.severity as string).split(',') : undefined;\n      const sourceId = req.query.source_id as string;\n\n      const options = {\n        format,\n        dateRange: startDate && endDate ? { start: startDate, end: endDate } : undefined,\n        filters: {\n          severity,\n          sourceId\n        }\n      };\n\n      const exportData = await ExportService.exportAlerts(options);\n      const filename = ExportService.getExportFilename('alerts', format);\n\n      res.setHeader('Content-Type', format === 'csv' ? 'text/csv' : 'application/json');\n      res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n      res.send(exportData);\n    } catch (error) {\n      console.error('Export alerts error:', error);\n      res.status(500).json({ error: 'Failed to export alerts' });\n    }\n  });\n\n  app.get('/api/export/analytics', async (req, res) => {\n    try {\n      const format = req.query.format as 'csv' | 'json' || 'json';\n      const startDate = req.query.start_date ? new Date(req.query.start_date as string) : undefined;\n      const endDate = req.query.end_date ? new Date(req.query.end_date as string) : undefined;\n\n      const options = {\n        format,\n        dateRange: startDate && endDate ? { start: startDate, end: endDate } : undefined\n      };\n\n      const exportData = await ExportService.exportAnalytics(options);\n      const filename = ExportService.getExportFilename('analytics', format);\n\n      res.setHeader('Content-Type', format === 'csv' ? 'text/csv' : 'application/json');\n      res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n      res.send(exportData);\n    } catch (error) {\n      console.error('Export analytics error:', error);\n      res.status(500).json({ error: 'Failed to export analytics' });\n    }\n  });\n\n  app.get('/api/export/actions', async (req, res) => {\n    try {\n      const format = req.query.format as 'csv' | 'json' || 'json';\n      const startDate = req.query.start_date ? new Date(req.query.start_date as string) : undefined;\n      const endDate = req.query.end_date ? new Date(req.query.end_date as string) : undefined;\n\n      const options = {\n        format,\n        dateRange: startDate && endDate ? { start: startDate, end: endDate } : undefined\n      };\n\n      const exportData = await ExportService.exportActions(options);\n      const filename = ExportService.getExportFilename('actions', format);\n\n      res.setHeader('Content-Type', format === 'csv' ? 'text/csv' : 'application/json');\n      res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n      res.send(exportData);\n    } catch (error) {\n      console.error('Export actions error:', error);\n      res.status(500).json({ error: 'Failed to export actions' });\n    }\n  });\n\n  return httpServer;\n}","size_bytes":38143},"server/storage.ts":{"content":"import { type User, type InsertUser, type Source, type InsertSource, type RawAlert, type InsertRawAlert, type Incident, type InsertIncident, type Action, type InsertAction, type Feedback, type InsertFeedback, type ModelMetric, type InsertModelMetric, type NormalizedAlert, type FeatureVector, type OCSFEvent, type InsertOCSFEvent, type EnhancedNormalizedAlert, type InsertEnhancedNormalizedAlert } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\nexport interface IStorage {\n  // Users\n  getUser(id: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUserByEmailWithPassword(email: string): Promise<(User & { password: string }) | undefined>;\n  createUser(user: InsertUser): Promise<User & { password: string }>;\n\n  // Sources\n  getSources(): Promise<Source[]>;\n  getSource(id: string): Promise<Source | undefined>;\n  createSource(source: InsertSource): Promise<Source>;\n  updateSource(id: string, source: Partial<Source>): Promise<Source | undefined>;\n  deleteSource(id: string): Promise<boolean>;\n\n  // Raw Alerts\n  getRawAlerts(): Promise<RawAlert[]>;\n  getRawAlert(id: string): Promise<RawAlert | undefined>;\n  createRawAlert(alert: InsertRawAlert): Promise<RawAlert>;\n\n  // Normalized Alerts\n  getNormalizedAlerts(): Promise<NormalizedAlert[]>;\n  getNormalizedAlert(id: string): Promise<NormalizedAlert | undefined>;\n  createNormalizedAlert(alert: {\n    sourceId: string;\n    originalId: string;\n    timestamp: Date;\n    severity: string;\n    alertType: string;\n    title: string;\n    description: string;\n    sourceIp?: string;\n    destinationIp?: string;\n    username?: string;\n    ruleId?: string;\n    rawData: any;\n    status: string;\n  }): Promise<NormalizedAlert>;\n\n  // Incidents\n  getIncidents(): Promise<Incident[]>;\n  getIncident(id: string): Promise<Incident | undefined>;\n  createIncident(incident: InsertIncident): Promise<Incident>;\n  updateIncident(id: string, incident: Partial<Incident>): Promise<Incident | undefined>;\n\n  // Actions\n  getActions(): Promise<Action[]>;\n  getActionsByIncident(incidentId: string): Promise<Action[]>;\n  createAction(action: InsertAction): Promise<Action>;\n\n  // Feedback\n  getFeedback(): Promise<Feedback[]>;\n  getFeedbackByIncident(incidentId: string): Promise<Feedback[]>;\n  createFeedback(feedback: InsertFeedback): Promise<Feedback>;\n\n  // Model Metrics\n  getModelMetrics(): Promise<ModelMetric[]>;\n  createModelMetric(metric: InsertModelMetric): Promise<ModelMetric>;\n\n  // Dashboard Stats\n  getDashboardStats(): Promise<{\n    activeIncidents: number;\n    alertsToday: number;\n    avgResponseTime: string;\n    modelAccuracy: number;\n  }>;\n\n  // OCSF Events\n  getOCSFEvents(): Promise<OCSFEvent[]>;\n  getOCSFEvent(id: string): Promise<OCSFEvent | undefined>;\n  createOCSFEvent(event: InsertOCSFEvent): Promise<OCSFEvent>;\n  getOCSFEventsByClass(classUid: number): Promise<OCSFEvent[]>;\n\n  // Enhanced Normalized Alerts\n  getEnhancedNormalizedAlerts(): Promise<EnhancedNormalizedAlert[]>;\n  getEnhancedNormalizedAlert(id: string): Promise<EnhancedNormalizedAlert | undefined>;\n  createEnhancedNormalizedAlert(alert: InsertEnhancedNormalizedAlert): Promise<EnhancedNormalizedAlert>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User & { password: string }>;\n  private sources: Map<string, Source>;\n  private rawAlerts: Map<string, RawAlert>;\n  private featureVectors: Map<string, FeatureVector>;\n  private normalizedAlerts: Map<string, NormalizedAlert>;\n  private incidents: Map<string, Incident>;\n  private actions: Map<string, Action>;\n  private feedbacks: Map<string, Feedback>;\n  private modelMetrics: Map<string, ModelMetric>;\n  private ocsfEvents: Map<string, OCSFEvent>;\n  private enhancedNormalizedAlerts: Map<string, EnhancedNormalizedAlert>;\n\n  constructor() {\n    this.users = new Map();\n    this.sources = new Map();\n    this.rawAlerts = new Map();\n    this.featureVectors = new Map();\n    this.normalizedAlerts = new Map();\n    this.incidents = new Map();\n    this.actions = new Map();\n    this.feedbacks = new Map();\n    this.modelMetrics = new Map();\n    this.ocsfEvents = new Map();\n    this.enhancedNormalizedAlerts = new Map();\n\n    // Initialize with some demo data\n    this.initializeDemoData().catch(console.error);\n  }\n\n  private async initializeDemoData() {\n    // Create demo users with different roles and hashed passwords\n    const users = [\n      {\n        email: \"john.smith@company.com\",\n        password: \"password123\",\n        firstName: \"John\",\n        lastName: \"Smith\",\n        role: \"analyst\" as const,\n      },\n      {\n        email: \"sarah.johnson@company.com\",\n        password: \"admin123\",\n        firstName: \"Sarah\", \n        lastName: \"Johnson\",\n        role: \"admin\" as const,\n      },\n      {\n        email: \"mike.wilson@company.com\",\n        password: \"password123\",\n        firstName: \"Mike\",\n        lastName: \"Wilson\",\n        role: \"analyst\" as const,\n      }\n    ];\n\n    const userIds: string[] = [];\n    const bcrypt = await import('bcryptjs');\n    \n    for (const userData of users) {\n      // Hash the password\n      const hashedPassword = await bcrypt.hash(userData.password, 12);\n      \n      const user: User & { password: string } = {\n        id: randomUUID(),\n        email: userData.email,\n        password: hashedPassword,\n        firstName: userData.firstName,\n        lastName: userData.lastName,\n        profileImageUrl: null,\n        role: userData.role as 'analyst' | 'admin',\n        createdAt: new Date(Date.now() - Math.random() * 86400000 * 30),\n        updatedAt: new Date(),\n      };\n      this.users.set(user.id, user);\n      userIds.push(user.id);\n    }\n\n    // Create comprehensive demo sources with realistic configurations\n    const sources = [\n      { \n        name: \"Corporate Firewall - Perimeter\", \n        type: \"Firewall\", \n        config: { \n          endpoint: \"https://firewall.corp.local/api\",\n          enabled: true,\n          polling_interval: 300,\n          auth_token: \"fw_token_abc123\"\n        } \n      },\n      { \n        name: \"Windows Defender ATP\", \n        type: \"EDR\", \n        config: { \n          endpoint: \"https://api.securitycenter.microsoft.com\",\n          enabled: true,\n          tenant_id: \"corp-tenant-123\",\n          polling_interval: 180\n        } \n      },\n      { \n        name: \"Splunk Enterprise SIEM\", \n        type: \"SIEM\", \n        config: { \n          endpoint: \"https://splunk.corp.local:8089\",\n          enabled: true,\n          index: \"security_events\",\n          auth_token: \"splunk_token_xyz789\"\n        } \n      },\n      { \n        name: \"CrowdStrike Falcon\", \n        type: \"EDR\", \n        config: { \n          endpoint: \"https://api.crowdstrike.com\",\n          enabled: true,\n          client_id: \"cs_client_456\",\n          polling_interval: 120\n        } \n      },\n      { \n        name: \"Palo Alto Networks\", \n        type: \"Firewall\", \n        config: { \n          endpoint: \"https://panorama.corp.local/api\",\n          enabled: false,\n          maintenance_mode: true\n        } \n      },\n      { \n        name: \"Office 365 Security\", \n        type: \"Cloud Security\", \n        config: { \n          endpoint: \"https://graph.microsoft.com\",\n          enabled: true,\n          tenant_id: \"o365-tenant-789\"\n        } \n      }\n    ];\n\n    const sourceIds: string[] = [];\n    sources.forEach(sourceData => {\n      const source: Source = {\n        id: randomUUID(),\n        name: sourceData.name,\n        type: sourceData.type,\n        config: sourceData.config,\n        createdAt: new Date(Date.now() - Math.random() * 86400000 * 60), // Random date within last 60 days\n      };\n      this.sources.set(source.id, source);\n      sourceIds.push(source.id);\n    });\n\n    // Create realistic raw alerts with varying severity and types\n    const alertTemplates = [\n      {\n        severity: \"critical\",\n        type: \"malware_detection\",\n        description: \"Ransomware activity detected on endpoint DESKTOP-ABC123\",\n        rawData: { \n          process: \"suspicious_encrypt.exe\", \n          user: \"jdoe\", \n          endpoint: \"DESKTOP-ABC123\",\n          hash: \"d41d8cd98f00b204e9800998ecf8427e\"\n        }\n      },\n      {\n        severity: \"high\", \n        type: \"network_intrusion\",\n        description: \"Multiple failed login attempts from external IP\",\n        rawData: { \n          source_ip: \"192.168.1.100\", \n          target_service: \"RDP\", \n          attempts: 25,\n          blocked: true\n        }\n      },\n      {\n        severity: \"medium\",\n        type: \"policy_violation\", \n        description: \"Unauthorized software installation detected\",\n        rawData: { \n          software: \"BitTorrent Client\", \n          user: \"temp_contractor\", \n          endpoint: \"LAPTOP-XYZ789\"\n        }\n      },\n      {\n        severity: \"low\",\n        type: \"anomaly_detection\",\n        description: \"Unusual network traffic pattern observed\",\n        rawData: { \n          bytes_transferred: 1024000, \n          destination: \"unknown_server.com\",\n          protocol: \"HTTPS\"\n        }\n      },\n      {\n        severity: \"critical\",\n        type: \"data_exfiltration\",\n        description: \"Large data transfer to external storage detected\",\n        rawData: { \n          volume: \"2.5GB\", \n          destination: \"dropbox.com\", \n          user: \"marketing_intern\"\n        }\n      },\n      {\n        severity: \"high\",\n        type: \"privilege_escalation\",\n        description: \"Admin privileges granted to standard user account\",\n        rawData: { \n          user: \"contractor_bob\", \n          granted_by: \"admin_system\", \n          privileges: [\"local_admin\", \"domain_user\"]\n        }\n      }\n    ];\n\n    const rawAlertIds: string[] = [];\n    // Create 50 raw alerts with realistic timestamps\n    for (let i = 0; i < 50; i++) {\n      const template = alertTemplates[Math.floor(Math.random() * alertTemplates.length)];\n      const sourceId = sourceIds[Math.floor(Math.random() * sourceIds.length)];\n      \n      const rawAlert: RawAlert = {\n        id: randomUUID(),\n        sourceId,\n        severity: template.severity,\n        type: template.type,\n        description: template.description,\n        rawData: { ...template.rawData, alert_id: `ALT-${Date.now()}-${i}` },\n        receivedAt: new Date(Date.now() - Math.random() * 86400000 * 7), // Random within last 7 days\n      };\n      this.rawAlerts.set(rawAlert.id, rawAlert);\n      rawAlertIds.push(rawAlert.id);\n    }\n\n    // Create feature vectors for ML analysis\n    const featureVectorIds: string[] = [];\n    rawAlertIds.slice(0, 30).forEach(alertId => {\n      const featureVector: FeatureVector = {\n        id: randomUUID(),\n        rawAlertId: alertId,\n        features: {\n          severity_score: Math.random() * 10,\n          frequency_score: Math.random() * 5,\n          source_reputation: Math.random() * 10,\n          behavioral_anomaly: Math.random() * 8,\n          network_risk: Math.random() * 6\n        },\n        computedAt: new Date(Date.now() - Math.random() * 86400000 * 5),\n      };\n      this.featureVectors.set(featureVector.id, featureVector);\n      featureVectorIds.push(featureVector.id);\n    });\n\n    // Create normalized alerts based on feature vectors\n    const normalizedAlertIds: string[] = [];\n    featureVectorIds.forEach(vectorId => {\n      const confidence = Math.random();\n      const decision = confidence > 0.7 ? \"AUTO\" : \"MANUAL\";\n      \n      const normalizedAlert: NormalizedAlert = {\n        id: randomUUID(),\n        featureVectorId: vectorId,\n        decision: decision as \"AUTO\" | \"MANUAL\", \n        confidence,\n        status: Math.random() > 0.3 ? \"reviewed\" : \"pending\",\n        createdAt: new Date(Date.now() - Math.random() * 86400000 * 4),\n        closedAt: Math.random() > 0.4 ? new Date(Date.now() - Math.random() * 86400000 * 2) : null,\n      };\n      this.normalizedAlerts.set(normalizedAlert.id, normalizedAlert);\n      normalizedAlertIds.push(normalizedAlert.id);\n    });\n\n    // Create realistic security incidents\n    const incidentTemplates = [\n      {\n        title: \"Ransomware Attack - Finance Department\",\n        description: \"Multiple systems in finance showing signs of file encryption. Immediate containment required.\",\n        severity: \"critical\",\n        status: \"investigating\"\n      },\n      {\n        title: \"Suspicious Network Activity\",\n        description: \"Unusual outbound connections detected from development servers.\",\n        severity: \"high\", \n        status: \"monitoring\"\n      },\n      {\n        title: \"Failed Login Attempts\",\n        description: \"Coordinated brute force attack against VPN endpoints.\",\n        severity: \"medium\",\n        status: \"resolved\"\n      },\n      {\n        title: \"Data Loss Prevention Alert\",\n        description: \"Sensitive customer data accessed outside normal hours.\",\n        severity: \"high\",\n        status: \"investigating\"\n      },\n      {\n        title: \"Malware Detection\",\n        description: \"Trojan detected on HR workstation, contained and isolated.\",\n        severity: \"medium\",\n        status: \"resolved\"\n      }\n    ];\n\n    const incidentIds: string[] = [];\n    incidentTemplates.forEach((template, index) => {\n      const incident: Incident = {\n        id: randomUUID(),\n        title: template.title,\n        description: template.description,\n        severity: template.severity as \"low\" | \"medium\" | \"high\" | \"critical\",\n        status: template.status as \"open\" | \"investigating\" | \"monitoring\" | \"resolved\",\n        assignedTo: userIds[Math.floor(Math.random() * userIds.length)],\n        createdAt: new Date(Date.now() - Math.random() * 86400000 * 14), // Random within last 14 days\n        closedAt: template.status === \"resolved\" ? \n          new Date(Date.now() - Math.random() * 86400000 * 7) : null,\n      };\n      this.incidents.set(incident.id, incident);\n      incidentIds.push(incident.id);\n    });\n\n    // Create response actions for incidents\n    const actionTemplates = [\n      { type: \"isolate_endpoint\", description: \"Isolated affected workstation from network\" },\n      { type: \"block_ip\", description: \"Added malicious IP to firewall blocklist\" },\n      { type: \"reset_credentials\", description: \"Forced password reset for affected accounts\" },\n      { type: \"update_signatures\", description: \"Updated antivirus signatures across all endpoints\" },\n      { type: \"notify_users\", description: \"Sent security awareness notification to all staff\" },\n      { type: \"escalate\", description: \"Escalated to senior security team\" },\n      { type: \"document\", description: \"Documented findings in incident report\" }\n    ];\n\n    incidentIds.forEach(incidentId => {\n      const numActions = Math.floor(Math.random() * 4) + 1; // 1-4 actions per incident\n      for (let i = 0; i < numActions; i++) {\n        const template = actionTemplates[Math.floor(Math.random() * actionTemplates.length)];\n        const action: Action = {\n          id: randomUUID(),\n          incidentId,\n          actionType: template.type,\n          payload: { description: template.description, automated: Math.random() > 0.6 },\n          performedBy: userIds[Math.floor(Math.random() * userIds.length)],\n          performedAt: new Date(Date.now() - Math.random() * 86400000 * 10),\n        };\n        this.actions.set(action.id, action);\n      }\n    });\n\n    // Create analyst feedback for model improvement\n    const feedbackTemplates = [\n      \"Alert was correctly identified as malicious\",\n      \"False positive - legitimate admin activity\", \n      \"Severity should be upgraded to critical\",\n      \"Missing context about user behavior patterns\",\n      \"Good detection but needs faster response time\",\n      \"Alert correlation could be improved\"\n    ];\n\n    normalizedAlertIds.slice(0, 20).forEach(alertId => {\n      const feedback: Feedback = {\n        id: randomUUID(),\n        alertId: alertId,\n        incidentId: null,\n        userId: userIds[Math.floor(Math.random() * userIds.length)],\n        feedback: feedbackTemplates[Math.floor(Math.random() * feedbackTemplates.length)],\n        rating: Math.floor(Math.random() * 5) + 1, // 1-5 rating\n        submittedAt: new Date(Date.now() - Math.random() * 86400000 * 8),\n      };\n      this.feedbacks.set(feedback.id, feedback);\n    });\n\n    // Create model performance metrics\n    const metricDates = [];\n    for (let i = 30; i >= 0; i--) {\n      metricDates.push(new Date(Date.now() - i * 86400000)); // Last 30 days\n    }\n\n    metricDates.forEach(date => {\n      const metrics: ModelMetric = {\n        id: randomUUID(),\n        accuracy: 0.85 + Math.random() * 0.1, // 85-95% accuracy\n        precision: 0.80 + Math.random() * 0.15, // 80-95% precision  \n        recall: 0.75 + Math.random() * 0.2, // 75-95% recall\n        runTs: date,\n        alertsProcessed: Math.floor(Math.random() * 1000) + 100,\n        autoActions: Math.floor(Math.random() * 50),\n        manualReviews: Math.floor(Math.random() * 20),\n        latencyMs: Math.floor(Math.random() * 500) + 100,\n      };\n      this.modelMetrics.set(metrics.id, metrics);\n    });\n\n    console.log(`Demo data initialized: ${users.length} users, ${sources.length} sources, ${rawAlertIds.length} alerts, ${incidentIds.length} incidents`);\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    const userWithPassword = this.users.get(id);\n    if (!userWithPassword) return undefined;\n    \n    // Return user without password for public API\n    const { password, ...user } = userWithPassword;\n    return user;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const userWithPassword = Array.from(this.users.values()).find(\n      (user) => user.email === email,\n    );\n    if (!userWithPassword) return undefined;\n    \n    // Return user without password for public API\n    const { password, ...user } = userWithPassword;\n    return user;\n  }\n\n  async getUserByEmailWithPassword(email: string): Promise<(User & { password: string }) | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.email === email,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User & { password: string }> {\n    const id = randomUUID();\n    const user: User & { password: string } = { \n      id, \n      email: insertUser.email,\n      password: insertUser.password,\n      firstName: insertUser.firstName || null,\n      lastName: insertUser.lastName || null,\n      profileImageUrl: insertUser.profileImageUrl || null,\n      role: (insertUser.role || 'analyst') as 'analyst' | 'admin',\n      createdAt: new Date(),\n      updatedAt: new Date()\n    };\n    this.users.set(id, user);\n    return user;\n  }\n\n  async getSources(): Promise<Source[]> {\n    return Array.from(this.sources.values());\n  }\n\n  async getSource(id: string): Promise<Source | undefined> {\n    return this.sources.get(id);\n  }\n\n  async createSource(insertSource: InsertSource): Promise<Source> {\n    const id = randomUUID();\n    const source: Source = { ...insertSource, id, createdAt: new Date(), config: insertSource.config || {} };\n    this.sources.set(id, source);\n    return source;\n  }\n\n  async updateSource(id: string, updateData: Partial<Source>): Promise<Source | undefined> {\n    const source = this.sources.get(id);\n    if (!source) return undefined;\n    \n    const updatedSource = { ...source, ...updateData };\n    this.sources.set(id, updatedSource);\n    return updatedSource;\n  }\n\n  async deleteSource(id: string): Promise<boolean> {\n    return this.sources.delete(id);\n  }\n\n  async getRawAlerts(): Promise<RawAlert[]> {\n    return Array.from(this.rawAlerts.values());\n  }\n\n  async getRawAlert(id: string): Promise<RawAlert | undefined> {\n    return this.rawAlerts.get(id);\n  }\n\n  async createRawAlert(insertAlert: InsertRawAlert): Promise<RawAlert> {\n    const id = randomUUID();\n    const alert: RawAlert = { \n      ...insertAlert, \n      id, \n      receivedAt: new Date(),\n      type: insertAlert.type || null,\n      severity: insertAlert.severity || null,\n      description: insertAlert.description || null\n    };\n    this.rawAlerts.set(id, alert);\n    return alert;\n  }\n\n  async getNormalizedAlerts(): Promise<NormalizedAlert[]> {\n    return Array.from(this.normalizedAlerts.values());\n  }\n\n  async getNormalizedAlert(id: string): Promise<NormalizedAlert | undefined> {\n    return this.normalizedAlerts.get(id);\n  }\n\n  async createNormalizedAlert(alertData: {\n    sourceId: string;\n    originalId: string;\n    timestamp: Date;\n    severity: string;\n    alertType: string;\n    title: string;\n    description: string;\n    sourceIp?: string;\n    destinationIp?: string;\n    username?: string;\n    ruleId?: string;\n    rawData: any;\n    status: string;\n  }): Promise<NormalizedAlert> {\n    // For Kafka integration, create a simplified normalized alert\n    // In a real implementation, this would involve ML feature extraction\n    const id = randomUUID();\n    \n    // Create a dummy feature vector for the alert\n    const featureVectorId = randomUUID();\n    const featureVector: FeatureVector = {\n      id: featureVectorId,\n      rawAlertId: alertData.originalId,\n      features: {\n        severity_score: alertData.severity === 'critical' ? 10 : alertData.severity === 'high' ? 7 : alertData.severity === 'medium' ? 5 : 2,\n        source_reputation: Math.random() * 10,\n        behavioral_anomaly: Math.random() * 8,\n      },\n      computedAt: new Date(),\n    };\n    this.featureVectors.set(featureVectorId, featureVector);\n    \n    // Create the normalized alert\n    const normalizedAlert: NormalizedAlert = {\n      id,\n      featureVectorId,\n      decision: Math.random() > 0.7 ? \"AUTO\" : \"MANUAL\",\n      confidence: Math.random() * 0.4 + 0.6, // 0.6-1.0 confidence\n      status: alertData.status,\n      createdAt: alertData.timestamp,\n      closedAt: null,\n    };\n    \n    this.normalizedAlerts.set(id, normalizedAlert);\n    return normalizedAlert;\n  }\n\n  async getIncidents(): Promise<Incident[]> {\n    return Array.from(this.incidents.values())\n      .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n  }\n\n  async getIncident(id: string): Promise<Incident | undefined> {\n    return this.incidents.get(id);\n  }\n\n  async createIncident(insertIncident: InsertIncident): Promise<Incident> {\n    const id = randomUUID();\n    const incident: Incident = { \n      ...insertIncident, \n      id, \n      createdAt: new Date(), \n      closedAt: null,\n      status: (insertIncident.status as 'open' | 'investigating' | 'monitoring' | 'resolved') || 'open',\n      severity: insertIncident.severity as 'low' | 'medium' | 'high' | 'critical',\n      description: insertIncident.description || null,\n      assignedTo: insertIncident.assignedTo || null\n    };\n    this.incidents.set(id, incident);\n    return incident;\n  }\n\n  async updateIncident(id: string, updateData: Partial<Incident>): Promise<Incident | undefined> {\n    const incident = this.incidents.get(id);\n    if (!incident) return undefined;\n    \n    const updatedIncident = { ...incident, ...updateData };\n    this.incidents.set(id, updatedIncident);\n    return updatedIncident;\n  }\n\n  async getActions(): Promise<Action[]> {\n    return Array.from(this.actions.values());\n  }\n\n  async getActionsByIncident(incidentId: string): Promise<Action[]> {\n    return Array.from(this.actions.values())\n      .filter(action => action.incidentId === incidentId);\n  }\n\n  async createAction(insertAction: InsertAction): Promise<Action> {\n    const id = randomUUID();\n    const action: Action = { \n      ...insertAction, \n      id, \n      performedAt: new Date(),\n      payload: insertAction.payload || {},\n      performedBy: insertAction.performedBy || null\n    };\n    this.actions.set(id, action);\n    return action;\n  }\n\n  async getFeedback(): Promise<Feedback[]> {\n    return Array.from(this.feedbacks.values())\n      .sort((a, b) => new Date(b.submittedAt).getTime() - new Date(a.submittedAt).getTime());\n  }\n\n  async getFeedbackByIncident(incidentId: string): Promise<Feedback[]> {\n    return Array.from(this.feedbacks.values())\n      .filter(feedback => feedback.incidentId === incidentId);\n  }\n\n  async createFeedback(insertFeedback: InsertFeedback): Promise<Feedback> {\n    const id = randomUUID();\n    const feedback: Feedback = { \n      ...insertFeedback, \n      id, \n      submittedAt: new Date(),\n      alertId: insertFeedback.alertId || null,\n      incidentId: insertFeedback.incidentId || null,\n      rating: insertFeedback.rating || null\n    };\n    this.feedbacks.set(id, feedback);\n    return feedback;\n  }\n\n  async getModelMetrics(): Promise<ModelMetric[]> {\n    return Array.from(this.modelMetrics.values())\n      .sort((a, b) => new Date(b.runTs).getTime() - new Date(a.runTs).getTime());\n  }\n\n  async createModelMetric(insertMetric: InsertModelMetric): Promise<ModelMetric> {\n    const id = randomUUID();\n    const metric: ModelMetric = { ...insertMetric, id };\n    this.modelMetrics.set(id, metric);\n    return metric;\n  }\n\n  async getDashboardStats(): Promise<{\n    activeIncidents: number;\n    alertsToday: number;\n    avgResponseTime: string;\n    modelAccuracy: number;\n  }> {\n    const activeIncidents = Array.from(this.incidents.values())\n      .filter(incident => incident.status === 'open').length;\n\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    \n    const alertsToday = Array.from(this.rawAlerts.values())\n      .filter(alert => new Date(alert.receivedAt) >= today).length;\n\n    const latestMetrics = Array.from(this.modelMetrics.values())\n      .sort((a, b) => new Date(b.runTs).getTime() - new Date(a.runTs).getTime())[0];\n\n    return {\n      activeIncidents,\n      alertsToday,\n      avgResponseTime: \"4.2m\",\n      modelAccuracy: latestMetrics?.precision * 100 || 94.7,\n    };\n  }\n\n  // OCSF Events methods\n  async getOCSFEvents(): Promise<OCSFEvent[]> {\n    return Array.from(this.ocsfEvents.values())\n      .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n  }\n\n  async getOCSFEvent(id: string): Promise<OCSFEvent | undefined> {\n    return this.ocsfEvents.get(id);\n  }\n\n  async createOCSFEvent(insertEvent: InsertOCSFEvent): Promise<OCSFEvent> {\n    const id = randomUUID();\n    const event: OCSFEvent = { \n      ...insertEvent, \n      id, \n      createdAt: new Date(),\n      message: insertEvent.message || null,\n      severity: insertEvent.severity || null,\n      observables: insertEvent.observables || null\n    };\n    this.ocsfEvents.set(id, event);\n    return event;\n  }\n\n  async getOCSFEventsByClass(classUid: number): Promise<OCSFEvent[]> {\n    return Array.from(this.ocsfEvents.values())\n      .filter(event => event.classUid === classUid)\n      .sort((a, b) => new Date(b.time).getTime() - new Date(a.time).getTime());\n  }\n\n  // Enhanced Normalized Alerts methods\n  async getEnhancedNormalizedAlerts(): Promise<EnhancedNormalizedAlert[]> {\n    return Array.from(this.enhancedNormalizedAlerts.values())\n      .sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());\n  }\n\n  async getEnhancedNormalizedAlert(id: string): Promise<EnhancedNormalizedAlert | undefined> {\n    return this.enhancedNormalizedAlerts.get(id);\n  }\n\n  async createEnhancedNormalizedAlert(insertAlert: InsertEnhancedNormalizedAlert): Promise<EnhancedNormalizedAlert> {\n    const id = randomUUID();\n    const alert: EnhancedNormalizedAlert = { \n      ...insertAlert, \n      id, \n      createdAt: new Date(),\n      closedAt: null,\n      assignedTo: insertAlert.assignedTo || null,\n      ocsfEventId: insertAlert.ocsfEventId || null,\n      description: insertAlert.description || null,\n      sourceIp: insertAlert.sourceIp || null,\n      destinationIp: insertAlert.destinationIp || null,\n      username: insertAlert.username || null,\n      ruleId: insertAlert.ruleId || null,\n      rawData: insertAlert.rawData || null,\n      status: (insertAlert.status || 'open') as 'open' | 'investigating' | 'closed' | 'false_positive'\n    };\n    this.enhancedNormalizedAlerts.set(id, alert);\n    return alert;\n  }\n}\n\nexport const storage = new MemStorage();\n","size_bytes":27991},"server/threatIntelligence.ts":{"content":"import { storage } from \"./storage\";\nimport { type RawAlert } from \"@shared/schema\";\n\nexport interface ThreatIndicator {\n  id: string;\n  type: 'IP' | 'Domain' | 'URL' | 'FileHash' | 'Email' | 'Registry';\n  value: string;\n  confidence: number; // 0-1\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  tags: string[];\n  source: string; // e.g., 'VirusTotal', 'MISP', 'AlienVault'\n  firstSeen: Date;\n  lastSeen: Date;\n  threatType?: string; // e.g., 'malware', 'phishing', 'apt'\n  description?: string;\n  references?: string[];\n  ttl?: number; // Time to live in hours\n}\n\nexport interface ThreatEnrichmentResult {\n  indicators: ThreatIndicator[];\n  riskScore: number; // 0-10\n  threats: {\n    type: string;\n    confidence: number;\n    description: string;\n  }[];\n  recommendations: string[];\n}\n\nexport interface ThreatFeed {\n  name: string;\n  url: string;\n  enabled: boolean;\n  format: 'json' | 'csv' | 'xml' | 'stix';\n  updateInterval: number; // hours\n  lastUpdated?: Date;\n  apiKey?: string;\n}\n\nexport class ThreatIntelligenceService {\n  private static indicators: Map<string, ThreatIndicator> = new Map();\n  \n  // Sample threat feeds configuration\n  private static feeds: ThreatFeed[] = [\n    {\n      name: 'AlienVault OTX',\n      url: 'https://otx.alienvault.com/api/v1/indicators',\n      enabled: true,\n      format: 'json',\n      updateInterval: 6,\n      apiKey: process.env.ALIENVAULT_API_KEY\n    },\n    {\n      name: 'MISP Feed',\n      url: 'https://misp.example.com/feeds',\n      enabled: false,\n      format: 'json',\n      updateInterval: 12,\n      apiKey: process.env.MISP_API_KEY\n    },\n    {\n      name: 'VirusTotal',\n      url: 'https://www.virustotal.com/vtapi/v2',\n      enabled: true,\n      format: 'json',\n      updateInterval: 4,\n      apiKey: process.env.VIRUSTOTAL_API_KEY\n    }\n  ];\n\n  static {\n    // Initialize with sample threat intelligence data\n    this.initializeSampleData();\n  }\n\n  private static initializeSampleData() {\n    const sampleIndicators: ThreatIndicator[] = [\n      {\n        id: 'ioc-001',\n        type: 'IP',\n        value: '198.51.100.23',\n        confidence: 0.95,\n        severity: 'critical',\n        tags: ['malware', 'c2', 'apt29'],\n        source: 'VirusTotal',\n        firstSeen: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000),\n        lastSeen: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),\n        threatType: 'command-and-control',\n        description: 'Known C2 server for APT29 malware campaign',\n        references: ['https://attack.mitre.org/groups/G0016/']\n      },\n      {\n        id: 'ioc-002',\n        type: 'Domain',\n        value: 'malware.example.com',\n        confidence: 0.87,\n        severity: 'high',\n        tags: ['malware', 'downloader', 'emotet'],\n        source: 'AlienVault OTX',\n        firstSeen: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000),\n        lastSeen: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),\n        threatType: 'malware-distribution',\n        description: 'Domain serving Emotet banking trojan',\n        references: ['https://example.com/threat-report-emotet']\n      },\n      {\n        id: 'ioc-003',\n        type: 'FileHash',\n        value: 'a1b2c3d4e5f6789012345678901234567890abcd',\n        confidence: 0.92,\n        severity: 'critical',\n        tags: ['ransomware', 'ryuk', 'encryption'],\n        source: 'MISP',\n        firstSeen: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000),\n        lastSeen: new Date(Date.now() - 12 * 60 * 60 * 1000),\n        threatType: 'ransomware',\n        description: 'Ryuk ransomware variant hash',\n        references: ['https://example.com/ryuk-analysis']\n      },\n      {\n        id: 'ioc-004',\n        type: 'IP',\n        value: '203.0.113.45',\n        confidence: 0.78,\n        severity: 'medium',\n        tags: ['scanning', 'brute-force', 'ssh'],\n        source: 'ThreatFox',\n        firstSeen: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),\n        lastSeen: new Date(Date.now() - 3 * 60 * 60 * 1000),\n        threatType: 'scanning',\n        description: 'IP address conducting SSH brute force attacks',\n        references: []\n      },\n      {\n        id: 'ioc-005',\n        type: 'Email',\n        value: 'phishing@badactor.com',\n        confidence: 0.89,\n        severity: 'high',\n        tags: ['phishing', 'credential-theft', 'business-email-compromise'],\n        source: 'PhishTank',\n        firstSeen: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000),\n        lastSeen: new Date(Date.now() - 6 * 60 * 60 * 1000),\n        threatType: 'phishing',\n        description: 'Email address used in business email compromise campaigns',\n        references: ['https://example.com/bec-report']\n      },\n      {\n        id: 'ioc-006',\n        type: 'URL',\n        value: 'https://evil-domain.com/payload.exe',\n        confidence: 0.94,\n        severity: 'critical',\n        tags: ['malware', 'trojan', 'payload'],\n        source: 'URLVoid',\n        firstSeen: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000),\n        lastSeen: new Date(Date.now() - 1 * 60 * 60 * 1000),\n        threatType: 'malware-delivery',\n        description: 'URL hosting trojan payloads',\n        references: []\n      }\n    ];\n\n    sampleIndicators.forEach(indicator => {\n      this.indicators.set(indicator.value, indicator);\n    });\n\n    console.log(`🛡️ Loaded ${sampleIndicators.length} threat intelligence indicators`);\n  }\n\n  static async enrichAlert(alert: RawAlert): Promise<ThreatEnrichmentResult> {\n    const enrichmentResult: ThreatEnrichmentResult = {\n      indicators: [],\n      riskScore: 0,\n      threats: [],\n      recommendations: []\n    };\n\n    // Extract potential IOCs from alert data\n    const iocs = this.extractIOCs(alert);\n    let totalRiskScore = 0;\n    let threatCount = 0;\n\n    for (const ioc of iocs) {\n      const indicator = this.indicators.get(ioc.value);\n      if (indicator) {\n        enrichmentResult.indicators.push(indicator);\n        \n        // Calculate risk contribution\n        const riskContribution = this.calculateRiskScore(indicator);\n        totalRiskScore += riskContribution;\n        threatCount++;\n\n        // Add threat information\n        enrichmentResult.threats.push({\n          type: indicator.threatType || 'unknown',\n          confidence: indicator.confidence,\n          description: indicator.description || `${indicator.type} indicator detected`\n        });\n      }\n    }\n\n    // Calculate overall risk score (0-10)\n    enrichmentResult.riskScore = threatCount > 0 ? \n      Math.min(totalRiskScore / threatCount * 10, 10) : 0;\n\n    // Generate recommendations based on findings\n    enrichmentResult.recommendations = this.generateRecommendations(enrichmentResult);\n\n    return enrichmentResult;\n  }\n\n  private static extractIOCs(alert: RawAlert): { type: string; value: string }[] {\n    const iocs: { type: string; value: string }[] = [];\n    const alertText = JSON.stringify(alert.rawData).toLowerCase();\n\n    // Extract IP addresses\n    const ipRegex = /\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b/g;\n    const ips = alertText.match(ipRegex) || [];\n    ips.forEach(ip => {\n      if (this.isValidIP(ip)) {\n        iocs.push({ type: 'IP', value: ip });\n      }\n    });\n\n    // Extract domains\n    const domainRegex = /\\b(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\b/g;\n    const domains = alertText.match(domainRegex) || [];\n    domains.forEach(domain => {\n      if (this.isValidDomain(domain)) {\n        iocs.push({ type: 'Domain', value: domain });\n      }\n    });\n\n    // Extract file hashes (SHA1, SHA256, MD5)\n    const hashRegex = /\\b[a-f0-9]{32,64}\\b/g;\n    const hashes = alertText.match(hashRegex) || [];\n    hashes.forEach(hash => {\n      iocs.push({ type: 'FileHash', value: hash });\n    });\n\n    // Extract email addresses\n    const emailRegex = /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b/g;\n    const emails = alertText.match(emailRegex) || [];\n    emails.forEach(email => {\n      iocs.push({ type: 'Email', value: email.toLowerCase() });\n    });\n\n    // Extract URLs\n    const urlRegex = /https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*)/g;\n    const urls = alertText.match(urlRegex) || [];\n    urls.forEach(url => {\n      iocs.push({ type: 'URL', value: url });\n    });\n\n    return iocs;\n  }\n\n  private static calculateRiskScore(indicator: ThreatIndicator): number {\n    let score = indicator.confidence;\n\n    // Severity multiplier\n    const severityMultipliers = { 'low': 0.25, 'medium': 0.5, 'high': 0.75, 'critical': 1.0 };\n    score *= severityMultipliers[indicator.severity];\n\n    // Recency bonus (more recent = higher risk)\n    const daysSinceLastSeen = (Date.now() - indicator.lastSeen.getTime()) / (1000 * 60 * 60 * 24);\n    const recencyBonus = Math.max(0, 1 - (daysSinceLastSeen / 30)); // Decay over 30 days\n    score *= (1 + recencyBonus * 0.5);\n\n    // Threat type multiplier\n    const threatTypeMultipliers: { [key: string]: number } = {\n      'ransomware': 1.2,\n      'command-and-control': 1.1,\n      'malware-distribution': 1.0,\n      'phishing': 0.9,\n      'scanning': 0.7\n    };\n    const threatMultiplier = threatTypeMultipliers[indicator.threatType || ''] || 1.0;\n    score *= threatMultiplier;\n\n    return Math.min(score, 1.0);\n  }\n\n  private static generateRecommendations(enrichment: ThreatEnrichmentResult): string[] {\n    const recommendations: string[] = [];\n\n    if (enrichment.riskScore >= 7) {\n      recommendations.push('IMMEDIATE ACTION: High-risk threat indicators detected');\n      recommendations.push('Isolate affected systems immediately');\n      recommendations.push('Escalate to senior security team');\n    } else if (enrichment.riskScore >= 4) {\n      recommendations.push('Investigate and monitor affected systems');\n      recommendations.push('Consider blocking identified IOCs');\n    } else if (enrichment.riskScore >= 1) {\n      recommendations.push('Monitor for additional suspicious activity');\n      recommendations.push('Document findings for trend analysis');\n    }\n\n    // Specific recommendations based on threat types\n    const threatTypes = enrichment.threats.map(t => t.type);\n    if (threatTypes.includes('ransomware')) {\n      recommendations.push('Check for file encryption activities');\n      recommendations.push('Verify backup integrity and accessibility');\n    }\n    if (threatTypes.includes('phishing')) {\n      recommendations.push('Check for credential compromise');\n      recommendations.push('Notify users about potential phishing attempts');\n    }\n    if (threatTypes.includes('command-and-control')) {\n      recommendations.push('Block network communication to identified C2 servers');\n      recommendations.push('Hunt for additional compromised endpoints');\n    }\n\n    return recommendations;\n  }\n\n  private static isValidIP(ip: string): boolean {\n    const parts = ip.split('.');\n    return parts.length === 4 && parts.every(part => {\n      const num = parseInt(part, 10);\n      return num >= 0 && num <= 255;\n    });\n  }\n\n  private static isValidDomain(domain: string): boolean {\n    return domain.includes('.') && \n           domain.length > 3 && \n           !domain.includes(' ') &&\n           !['localhost', 'example.com', 'test.local'].includes(domain);\n  }\n\n  static async getIndicators(): Promise<ThreatIndicator[]> {\n    return Array.from(this.indicators.values());\n  }\n\n  static async getIndicatorsByType(type: string): Promise<ThreatIndicator[]> {\n    return Array.from(this.indicators.values()).filter(indicator => \n      indicator.type.toLowerCase() === type.toLowerCase()\n    );\n  }\n\n  static async searchIndicators(query: string): Promise<ThreatIndicator[]> {\n    const searchTerm = query.toLowerCase();\n    return Array.from(this.indicators.values()).filter(indicator =>\n      indicator.value.toLowerCase().includes(searchTerm) ||\n      indicator.tags.some(tag => tag.toLowerCase().includes(searchTerm)) ||\n      (indicator.description || '').toLowerCase().includes(searchTerm)\n    );\n  }\n\n  static async addIndicator(indicator: Omit<ThreatIndicator, 'id'>): Promise<ThreatIndicator> {\n    const newIndicator: ThreatIndicator = {\n      ...indicator,\n      id: `ioc-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\n    };\n    \n    this.indicators.set(newIndicator.value, newIndicator);\n    return newIndicator;\n  }\n\n  static async updateIndicator(id: string, updates: Partial<ThreatIndicator>): Promise<ThreatIndicator | null> {\n    const indicator = Array.from(this.indicators.values()).find(i => i.id === id);\n    if (!indicator) return null;\n\n    const updatedIndicator = { ...indicator, ...updates };\n    this.indicators.set(updatedIndicator.value, updatedIndicator);\n    return updatedIndicator;\n  }\n\n  static async deleteIndicator(id: string): Promise<boolean> {\n    const indicator = Array.from(this.indicators.values()).find(i => i.id === id);\n    if (!indicator) return false;\n\n    return this.indicators.delete(indicator.value);\n  }\n\n  static getStats() {\n    const indicators = Array.from(this.indicators.values());\n    const stats = {\n      total: indicators.length,\n      byType: {} as { [key: string]: number },\n      bySeverity: {} as { [key: string]: number },\n      bySource: {} as { [key: string]: number },\n      recentlyUpdated: indicators.filter(i => \n        new Date(i.lastSeen).getTime() > Date.now() - 24 * 60 * 60 * 1000\n      ).length\n    };\n\n    indicators.forEach(indicator => {\n      stats.byType[indicator.type] = (stats.byType[indicator.type] || 0) + 1;\n      stats.bySeverity[indicator.severity] = (stats.bySeverity[indicator.severity] || 0) + 1;\n      stats.bySource[indicator.source] = (stats.bySource[indicator.source] || 0) + 1;\n    });\n\n    return stats;\n  }\n}","size_bytes":13668},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, timestamp, jsonb, integer, real, uuid, boolean, index } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Users table for authentication\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique().notNull(),\n  password: varchar(\"password\").notNull(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  role: text(\"role\").notNull().$type<'analyst' | 'admin'>().default('analyst'),\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\", { withTimezone: true }).defaultNow().notNull(),\n});\n\n// Sources table\nexport const sources = pgTable(\"sources\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  type: text(\"type\").notNull(), // e.g. EDR, SIEM\n  config: jsonb(\"config\"),\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).defaultNow().notNull(),\n});\n\n// Raw alerts table\nexport const rawAlerts = pgTable(\"raw_alerts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  sourceId: varchar(\"source_id\").notNull().references(() => sources.id, { onDelete: \"cascade\" }),\n  severity: text(\"severity\"),\n  type: text(\"type\"),\n  description: text(\"description\"),\n  rawData: jsonb(\"raw_data\").notNull(),\n  receivedAt: timestamp(\"received_at\", { withTimezone: true }).defaultNow().notNull(),\n});\n\n// Normalized alerts table\nexport const normalizedAlerts = pgTable(\"normalized_alerts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  featureVectorId: varchar(\"feature_vector_id\").notNull().references(() => featureVectors.id, { onDelete: \"cascade\" }),\n  decision: text(\"decision\").notNull().$type<'AUTO' | 'MANUAL'>(),\n  confidence: real(\"confidence\").notNull(),\n  status: text(\"status\").notNull().default('pending'),\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).defaultNow().notNull(),\n  closedAt: timestamp(\"closed_at\", { withTimezone: true }),\n});\n\n// Feature vectors table\nexport const featureVectors = pgTable(\"feature_vectors\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  rawAlertId: varchar(\"raw_alert_id\").notNull().references(() => rawAlerts.id, { onDelete: \"cascade\" }),\n  features: jsonb(\"features\").notNull(),\n  computedAt: timestamp(\"computed_at\", { withTimezone: true }).defaultNow().notNull(),\n});\n\n// Incidents table\nexport const incidents = pgTable(\"incidents\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  severity: text(\"severity\").notNull().$type<'low' | 'medium' | 'high' | 'critical'>(),\n  status: text(\"status\").notNull().$type<'open' | 'investigating' | 'monitoring' | 'resolved'>().default('open'),\n  assignedTo: varchar(\"assigned_to\").references(() => users.id),\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).defaultNow().notNull(),\n  closedAt: timestamp(\"closed_at\", { withTimezone: true }),\n});\n\n// Actions table\nexport const actions = pgTable(\"actions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  incidentId: varchar(\"incident_id\").notNull().references(() => incidents.id, { onDelete: \"cascade\" }),\n  actionType: text(\"action_type\").notNull(), // AUTO_QUARANTINE, ANALYST_REVIEW\n  payload: jsonb(\"payload\"),\n  performedBy: text(\"performed_by\"),\n  performedAt: timestamp(\"performed_at\", { withTimezone: true }).defaultNow().notNull(),\n});\n\n// Feedback table\nexport const feedback = pgTable(\"feedback\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  alertId: varchar(\"alert_id\").references(() => normalizedAlerts.id, { onDelete: \"cascade\" }),\n  incidentId: varchar(\"incident_id\").references(() => incidents.id, { onDelete: \"cascade\" }),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  feedback: text(\"feedback\").notNull(),\n  rating: integer(\"rating\"),\n  submittedAt: timestamp(\"submitted_at\", { withTimezone: true }).defaultNow().notNull(),\n});\n\n// Model metrics table\nexport const modelMetrics = pgTable(\"model_metrics\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  runTs: timestamp(\"run_ts\", { withTimezone: true }).notNull(),\n  alertsProcessed: integer(\"alerts_processed\").notNull(),\n  autoActions: integer(\"auto_actions\").notNull(),\n  manualReviews: integer(\"manual_reviews\").notNull(),\n  accuracy: real(\"accuracy\").notNull(),\n  precision: real(\"precision\").notNull(),\n  recall: real(\"recall\").notNull(),\n  latencyMs: integer(\"latency_ms\").notNull(),\n});\n\n// OCSF Events table - Store raw OCSF events for compliance and analysis\nexport const ocsfEvents = pgTable(\"ocsf_events\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  classUid: integer(\"class_uid\").notNull(),\n  className: text(\"class_name\").notNull(),\n  categoryUid: integer(\"category_uid\").notNull(),\n  categoryName: text(\"category_name\").notNull(),\n  activityId: integer(\"activity_id\").notNull(),\n  activityName: text(\"activity_name\").notNull(),\n  severityId: integer(\"severity_id\").notNull(),\n  severity: text(\"severity\"),\n  time: timestamp(\"time\", { withTimezone: true }).notNull(),\n  message: text(\"message\"),\n  rawData: jsonb(\"raw_data\").notNull(),\n  observables: jsonb(\"observables\"), // Store OCSF observables as JSON\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).defaultNow().notNull(),\n}, (table) => ({\n  classUidIdx: index(\"ocsf_events_class_uid_idx\").on(table.classUid),\n  severityIdIdx: index(\"ocsf_events_severity_id_idx\").on(table.severityId),\n  timeIdx: index(\"ocsf_events_time_idx\").on(table.time),\n}));\n\n// Enhanced normalized alerts table to support both custom and OCSF events\nexport const enhancedNormalizedAlerts = pgTable(\"enhanced_normalized_alerts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  sourceId: text(\"source_id\").notNull(), // Source identifier\n  originalId: text(\"original_id\").notNull(), // Original event ID\n  timestamp: timestamp(\"timestamp\", { withTimezone: true }).notNull(),\n  severity: text(\"severity\").notNull().$type<'low' | 'medium' | 'high' | 'critical'>(),\n  alertType: text(\"alert_type\").notNull().$type<'malware' | 'intrusion' | 'policy_violation' | 'anomaly' | 'threat_intel'>(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  // Network fields\n  sourceIp: text(\"source_ip\"),\n  destinationIp: text(\"destination_ip\"),\n  // System fields\n  username: text(\"username\"),\n  ruleId: text(\"rule_id\"),\n  // Storage\n  rawData: jsonb(\"raw_data\"),\n  ocsfEventId: varchar(\"ocsf_event_id\").references(() => ocsfEvents.id), // Link to OCSF event if applicable\n  status: text(\"status\").notNull().$type<'open' | 'investigating' | 'closed' | 'false_positive'>().default('open'),\n  assignedTo: varchar(\"assigned_to\").references(() => users.id),\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).defaultNow().notNull(),\n  closedAt: timestamp(\"closed_at\", { withTimezone: true }),\n}, (table) => ({\n  severityIdx: index(\"enhanced_alerts_severity_idx\").on(table.severity),\n  statusIdx: index(\"enhanced_alerts_status_idx\").on(table.status),\n  timestampIdx: index(\"enhanced_alerts_timestamp_idx\").on(table.timestamp),\n  sourceIdx: index(\"enhanced_alerts_source_idx\").on(table.sourceId),\n}));\n\n// Insert schemas\nexport const insertUserSchema = createInsertSchema(users).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const registerUserSchema = createInsertSchema(users).omit({\n  id: true,\n  role: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  firstName: z.string().optional(),\n  lastName: z.string().optional(),\n  confirmPassword: z.string().min(1, \"Password confirmation is required\"),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\nexport const loginUserSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(1, \"Password is required\"),\n});\n\nexport const insertSourceSchema = createInsertSchema(sources).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertRawAlertSchema = createInsertSchema(rawAlerts).omit({\n  id: true,\n  receivedAt: true,\n});\n\nexport const insertIncidentSchema = createInsertSchema(incidents).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertActionSchema = createInsertSchema(actions).omit({\n  id: true,\n  performedAt: true,\n});\n\nexport const insertFeedbackSchema = createInsertSchema(feedback).omit({\n  id: true,\n  submittedAt: true,\n});\n\nexport const insertModelMetricSchema = createInsertSchema(modelMetrics).omit({\n  id: true,\n});\n\nexport const insertOCSFEventSchema = createInsertSchema(ocsfEvents).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertEnhancedNormalizedAlertSchema = createInsertSchema(enhancedNormalizedAlerts).omit({\n  id: true,\n  createdAt: true,\n});\n\n// Types\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type RegisterUser = z.infer<typeof registerUserSchema>;\nexport type LoginUser = z.infer<typeof loginUserSchema>;\nexport type User = Omit<typeof users.$inferSelect, 'password'>; // Exclude password from public User type\nexport type InsertSource = z.infer<typeof insertSourceSchema>;\nexport type Source = typeof sources.$inferSelect;\nexport type InsertRawAlert = z.infer<typeof insertRawAlertSchema>;\nexport type RawAlert = typeof rawAlerts.$inferSelect;\nexport type NormalizedAlert = typeof normalizedAlerts.$inferSelect;\nexport type FeatureVector = typeof featureVectors.$inferSelect;\nexport type Incident = typeof incidents.$inferSelect;\nexport type InsertIncident = z.infer<typeof insertIncidentSchema>;\nexport type Action = typeof actions.$inferSelect;\nexport type InsertAction = z.infer<typeof insertActionSchema>;\nexport type Feedback = typeof feedback.$inferSelect;\nexport type InsertFeedback = z.infer<typeof insertFeedbackSchema>;\nexport type ModelMetric = typeof modelMetrics.$inferSelect;\nexport type InsertModelMetric = z.infer<typeof insertModelMetricSchema>;\nexport type OCSFEvent = typeof ocsfEvents.$inferSelect;\nexport type InsertOCSFEvent = z.infer<typeof insertOCSFEventSchema>;\nexport type EnhancedNormalizedAlert = typeof enhancedNormalizedAlerts.$inferSelect;\nexport type InsertEnhancedNormalizedAlert = z.infer<typeof insertEnhancedNormalizedAlertSchema>;\n","size_bytes":10567},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { useState, useEffect } from \"react\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useRealtimeUpdates } from \"@/hooks/use-realtime-updates\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Sidebar } from \"@/components/layout/sidebar\";\nimport { Header } from \"@/components/layout/header\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/landing\";\nimport Login from \"@/pages/login\";\nimport Register from \"@/pages/register\";\nimport Dashboard from \"@/pages/dashboard\";\nimport Incidents from \"@/pages/incidents\";\nimport Alerts from \"@/pages/alerts\";\nimport Sources from \"@/pages/sources\";\nimport Analytics from \"@/pages/analytics\";\nimport Feedback from \"@/pages/feedback\";\nimport { cn } from \"@/lib/utils\";\n\nfunction Router() {\n  const [currentSection, setCurrentSection] = useState('dashboard');\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const { connectionStatus } = useRealtimeUpdates();\n  const { isAuthenticated, isLoading, user } = useAuth();\n  const { toast } = useToast();\n\n  // Handle authentication redirect\n  useEffect(() => {\n    if (!isLoading && !isAuthenticated) {\n      // Don't show error for initial load\n      return;\n    }\n  }, [isAuthenticated, isLoading]);\n\n  // Show loading state while checking authentication\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-slate-900 flex items-center justify-center\">\n        <div className=\"text-white text-lg\">Loading...</div>\n      </div>\n    );\n  }\n\n  // Show landing page, login, or register if not authenticated\n  if (!isAuthenticated) {\n    return (\n      <Switch>\n        <Route path=\"/login\" component={Login} />\n        <Route path=\"/register\" component={Register} />\n        <Route path=\"/\" component={Landing} />\n        <Route component={Landing} />\n      </Switch>\n    );\n  }\n\n  const handleSectionChange = (section: string) => {\n    setCurrentSection(section);\n    setMobileMenuOpen(false); // Close mobile menu when navigating\n  };\n\n  const renderCurrentSection = () => {\n    switch (currentSection) {\n      case 'dashboard':\n        return <Dashboard />;\n      case 'incidents':\n        return <Incidents />;\n      case 'alerts':\n        return <Alerts />;\n      case 'sources':\n        return <Sources />;\n      case 'analytics':\n        return <Analytics />;\n      case 'feedback':\n        return <Feedback />;\n      default:\n        return <Dashboard />;\n    }\n  };\n\n  return (\n    <div className=\"flex h-screen overflow-hidden bg-slate-900\">\n      {/* Desktop Sidebar */}\n      <div className=\"hidden lg:flex lg:flex-shrink-0 lg:w-64 bg-slate-800 border-r border-slate-700\">\n        <Sidebar\n          currentSection={currentSection}\n          onSectionChange={handleSectionChange}\n        />\n      </div>\n\n      {/* Mobile Sidebar Overlay */}\n      {mobileMenuOpen && (\n        <div className=\"fixed inset-0 z-40 lg:hidden\">\n          <div \n            className=\"fixed inset-0 bg-slate-900 bg-opacity-75\"\n            onClick={() => setMobileMenuOpen(false)}\n            data-testid=\"mobile-backdrop\"\n          />\n          <div className=\"fixed inset-y-0 left-0 max-w-xs w-full bg-slate-800 shadow-xl\">\n            <Sidebar\n              currentSection={currentSection}\n              onSectionChange={handleSectionChange}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Main Content Area */}\n      <div className=\"flex flex-col flex-1 overflow-hidden\">\n        <Header\n          onMobileMenuToggle={() => setMobileMenuOpen(!mobileMenuOpen)}\n          connectionStatus={connectionStatus}\n          user={user}\n        />\n        \n        {/* Main Content */}\n        <main className=\"flex-1 overflow-y-auto bg-slate-900 p-4 lg:p-8\">\n          <div className=\"space-y-6 animate-fade-in\">\n            {renderCurrentSection()}\n          </div>\n        </main>\n      </div>\n    </div>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <div className=\"dark\">\n          <Toaster />\n          <Router />\n        </div>\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":4400},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --background: hsl(222, 84%, 4.9%);\n  --foreground: hsl(210, 40%, 98%);\n  --card: hsl(222, 84%, 4.9%);\n  --card-foreground: hsl(210, 40%, 98%);\n  --popover: hsl(222, 84%, 4.9%);\n  --popover-foreground: hsl(210, 40%, 98%);\n  --primary: hsl(207, 90%, 54%);\n  --primary-foreground: hsl(222, 84%, 4.9%);\n  --secondary: hsl(217, 32%, 17%);\n  --secondary-foreground: hsl(210, 40%, 98%);\n  --muted: hsl(217, 32%, 17%);\n  --muted-foreground: hsl(215, 20%, 65%);\n  --accent: hsl(217, 32%, 17%);\n  --accent-foreground: hsl(210, 40%, 98%);\n  --destructive: hsl(0, 62.8%, 30.6%);\n  --destructive-foreground: hsl(210, 40%, 98%);\n  --border: hsl(217, 32%, 17%);\n  --input: hsl(217, 32%, 17%);\n  --ring: hsl(224, 71.4%, 4.1%);\n  --chart-1: hsl(12, 76%, 61%);\n  --chart-2: hsl(173, 58%, 39%);\n  --chart-3: hsl(197, 37%, 24%);\n  --chart-4: hsl(43, 74%, 66%);\n  --chart-5: hsl(27, 87%, 67%);\n  --radius: 0.5rem;\n  \n  /* SOC specific colors */\n  --soc-bg-primary: hsl(222, 47%, 11%);\n  --soc-bg-secondary: hsl(215, 28%, 17%);\n  --soc-bg-tertiary: hsl(215, 25%, 27%);\n  --soc-text-primary: hsl(210, 40%, 98%);\n  --soc-text-secondary: hsl(215, 20%, 65%);\n  --soc-accent-sky: hsl(207, 90%, 54%);\n  --soc-accent-emerald: hsl(160, 84%, 39%);\n  --soc-accent-amber: hsl(43, 96%, 56%);\n  --soc-accent-red: hsl(0, 84%, 60%);\n}\n\n.dark {\n  --background: hsl(222, 84%, 4.9%);\n  --foreground: hsl(210, 40%, 98%);\n  --card: hsl(222, 84%, 4.9%);\n  --card-foreground: hsl(210, 40%, 98%);\n  --popover: hsl(222, 84%, 4.9%);\n  --popover-foreground: hsl(210, 40%, 98%);\n  --primary: hsl(207, 90%, 54%);\n  --primary-foreground: hsl(222, 84%, 4.9%);\n  --secondary: hsl(217, 32%, 17%);\n  --secondary-foreground: hsl(210, 40%, 98%);\n  --muted: hsl(217, 32%, 17%);\n  --muted-foreground: hsl(215, 20%, 65%);\n  --accent: hsl(217, 32%, 17%);\n  --accent-foreground: hsl(210, 40%, 98%);\n  --destructive: hsl(0, 62.8%, 30.6%);\n  --destructive-foreground: hsl(210, 40%, 98%);\n  --border: hsl(217, 32%, 17%);\n  --input: hsl(217, 32%, 17%);\n  --ring: hsl(224, 71.4%, 4.1%);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply bg-background text-foreground font-sans antialiased;\n    background-color: var(--soc-bg-primary);\n  }\n}\n\n@layer components {\n  .soc-card {\n    @apply bg-slate-800 border border-slate-700 rounded-lg;\n  }\n  \n  .soc-button-primary {\n    @apply bg-sky-600 hover:bg-sky-700 text-white;\n  }\n  \n  .soc-button-secondary {\n    @apply bg-slate-700 hover:bg-slate-600 text-slate-200;\n  }\n  \n  .soc-status-critical {\n    @apply bg-red-900 text-red-200;\n  }\n  \n  .soc-status-high {\n    @apply bg-amber-900 text-amber-200;\n  }\n  \n  .soc-status-medium {\n    @apply bg-sky-900 text-sky-200;\n  }\n  \n  .soc-status-low {\n    @apply bg-emerald-900 text-emerald-200;\n  }\n  \n  .pulse-slow {\n    animation: pulse 3s infinite;\n  }\n  \n  .fade-in {\n    animation: fadeIn 0.5s ease-in-out;\n  }\n}\n\n@keyframes fadeIn {\n  0% { opacity: 0; transform: translateY(10px); }\n  100% { opacity: 1; transform: translateY(0); }\n}\n","size_bytes":3055},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/alert-stream.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { AlertTriangle, Shield, Clock, Plus } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface Alert {\n  id: string;\n  title: string;\n  severity: 'critical' | 'high' | 'medium' | 'low';\n  timestamp: Date;\n  source?: string;\n  description?: string;\n  payload?: Record<string, any>;\n}\n\ninterface AlertStreamProps {\n  alerts: Alert[];\n  onCreateIncident: (alert: Alert) => void;\n  isCreatingIncident?: boolean;\n  className?: string;\n}\n\nexport function AlertStream({ \n  alerts, \n  onCreateIncident, \n  isCreatingIncident = false,\n  className \n}: AlertStreamProps) {\n  const getSeverityConfig = (severity: Alert['severity']) => {\n    switch (severity) {\n      case 'critical':\n        return {\n          color: 'border-red-500',\n          bgColor: 'bg-red-500/10',\n          iconColor: 'text-red-500',\n          badgeClass: 'soc-status-critical'\n        };\n      case 'high':\n        return {\n          color: 'border-amber-500',\n          bgColor: 'bg-amber-500/10',\n          iconColor: 'text-amber-500',\n          badgeClass: 'soc-status-high'\n        };\n      case 'medium':\n        return {\n          color: 'border-sky-500',\n          bgColor: 'bg-sky-500/10',\n          iconColor: 'text-sky-500',\n          badgeClass: 'soc-status-medium'\n        };\n      case 'low':\n        return {\n          color: 'border-emerald-500',\n          bgColor: 'bg-emerald-500/10',\n          iconColor: 'text-emerald-500',\n          badgeClass: 'soc-status-low'\n        };\n      default:\n        return {\n          color: 'border-slate-500',\n          bgColor: 'bg-slate-500/10',\n          iconColor: 'text-slate-500',\n          badgeClass: 'soc-status-medium'\n        };\n    }\n  };\n\n  const getTimeAgo = (timestamp: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - timestamp.getTime();\n    const diffSeconds = Math.floor(diffMs / 1000);\n    const diffMinutes = Math.floor(diffSeconds / 60);\n    const diffHours = Math.floor(diffMinutes / 60);\n\n    if (diffSeconds < 60) {\n      return `${diffSeconds}s ago`;\n    } else if (diffMinutes < 60) {\n      return `${diffMinutes}m ago`;\n    } else if (diffHours < 24) {\n      return `${diffHours}h ago`;\n    } else {\n      return timestamp.toLocaleDateString();\n    }\n  };\n\n  return (\n    <div className={cn(\"space-y-3 max-h-96 overflow-y-auto\", className)} data-testid=\"alert-stream\">\n      {alerts.map((alert, index) => {\n        const severityConfig = getSeverityConfig(alert.severity);\n        \n        return (\n          <div\n            key={`${alert.id}-${index}`}\n            className={cn(\n              \"flex items-center justify-between p-4 bg-slate-750 rounded-lg border-l-4 transition-all duration-200 hover:bg-slate-700\",\n              severityConfig.color\n            )}\n            data-testid={`alert-${index}`}\n          >\n            <div className=\"flex items-center space-x-4 flex-1 min-w-0\">\n              <div className={cn(\"w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0\", severityConfig.bgColor)}>\n                {alert.severity === 'critical' || alert.severity === 'high' ? (\n                  <AlertTriangle className={cn(\"w-4 h-4\", severityConfig.iconColor)} />\n                ) : (\n                  <Shield className={cn(\"w-4 h-4\", severityConfig.iconColor)} />\n                )}\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"flex items-center space-x-2 mb-1\">\n                  <p className=\"text-sm font-medium text-white truncate\" data-testid={`alert-${index}-title`}>\n                    {alert.title}\n                  </p>\n                  <Badge className={severityConfig.badgeClass} data-testid={`alert-${index}-severity`}>\n                    {alert.severity}\n                  </Badge>\n                </div>\n                <p className=\"text-xs text-slate-400 truncate\" data-testid={`alert-${index}-source`}>\n                  {alert.source ? `Source: ${alert.source}` : 'Unknown source'}\n                  {alert.payload && Object.keys(alert.payload).length > 0 && (\n                    <span className=\"ml-2\">\n                      • {Object.entries(alert.payload).slice(0, 2).map(([key, value]) => \n                        `${key}: ${value}`\n                      ).join(' • ')}\n                    </span>\n                  )}\n                </p>\n              </div>\n            </div>\n            \n            <div className=\"flex items-center space-x-3 flex-shrink-0\">\n              <div className=\"flex items-center space-x-1 text-xs text-slate-400\">\n                <Clock className=\"w-3 h-3\" />\n                <span data-testid={`alert-${index}-time`}>\n                  {getTimeAgo(alert.timestamp)}\n                </span>\n              </div>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"text-sky-400 hover:text-sky-300 hover:bg-sky-500/10\"\n                onClick={() => onCreateIncident(alert)}\n                disabled={isCreatingIncident}\n                data-testid={`create-incident-${index}`}\n              >\n                <Plus className=\"w-4 h-4 mr-1\" />\n                {isCreatingIncident ? \"Creating...\" : \"Create Incident\"}\n              </Button>\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n","size_bytes":5403},"client/src/components/export-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Download, FileText, Database } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { api } from \"@/lib/api\";\n\ninterface ExportDialogProps {\n  type: 'incidents' | 'alerts' | 'analytics' | 'actions';\n  triggerText?: string;\n  className?: string;\n}\n\ninterface ExportFilters {\n  startDate?: string;\n  endDate?: string;\n  severity?: string[];\n  status?: string[];\n  sourceId?: string;\n}\n\nexport function ExportDialog({ type, triggerText, className }: ExportDialogProps) {\n  const [open, setOpen] = useState(false);\n  const [format, setFormat] = useState<'csv' | 'json'>('csv');\n  const [isExporting, setIsExporting] = useState(false);\n  const [filters, setFilters] = useState<ExportFilters>({});\n  const { toast } = useToast();\n\n  const handleExport = async () => {\n    try {\n      setIsExporting(true);\n      \n      let response: Response;\n      \n      switch (type) {\n        case 'incidents':\n          response = await api.exportIncidents(format, filters);\n          break;\n        case 'alerts':\n          response = await api.exportAlerts(format, filters);\n          break;\n        case 'analytics':\n          response = await api.exportAnalytics(format, {\n            startDate: filters.startDate,\n            endDate: filters.endDate,\n          });\n          break;\n        case 'actions':\n          response = await api.exportActions(format, {\n            startDate: filters.startDate,\n            endDate: filters.endDate,\n          });\n          break;\n        default:\n          throw new Error('Unknown export type');\n      }\n\n      if (!response.ok) {\n        throw new Error('Export failed');\n      }\n\n      // Get the filename from Content-Disposition header or generate one\n      const contentDisposition = response.headers.get('Content-Disposition');\n      const filenameMatch = contentDisposition?.match(/filename=\"(.+)\"/);\n      const filename = filenameMatch ? filenameMatch[1] : `soc-${type}-export.${format}`;\n\n      // Create blob and download\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = filename;\n      document.body.appendChild(link);\n      link.click();\n      link.remove();\n      window.URL.revokeObjectURL(url);\n\n      toast({\n        title: \"Export Complete\",\n        description: `${type} data exported successfully as ${format.toUpperCase()}`,\n      });\n\n      setOpen(false);\n    } catch (error) {\n      console.error('Export error:', error);\n      toast({\n        title: \"Export Failed\",\n        description: `Failed to export ${type} data. Please try again.`,\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsExporting(false);\n    }\n  };\n\n  const severityOptions = ['critical', 'high', 'medium', 'low'];\n  const statusOptions = ['open', 'investigating', 'monitoring', 'resolved'];\n\n  const handleSeverityToggle = (severity: string, checked: boolean) => {\n    setFilters(prev => ({\n      ...prev,\n      severity: checked \n        ? [...(prev.severity || []), severity]\n        : (prev.severity || []).filter(s => s !== severity)\n    }));\n  };\n\n  const handleStatusToggle = (status: string, checked: boolean) => {\n    setFilters(prev => ({\n      ...prev,\n      status: checked \n        ? [...(prev.status || []), status]\n        : (prev.status || []).filter(s => s !== status)\n    }));\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button className={className || \"soc-button-primary\"} data-testid={`export-${type}`}>\n          <Download className=\"w-4 h-4 mr-2\" />\n          {triggerText || `Export ${type.charAt(0).toUpperCase() + type.slice(1)}`}\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"bg-slate-800 border-slate-700 max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"text-white\">\n            Export {type.charAt(0).toUpperCase() + type.slice(1)} Data\n          </DialogTitle>\n        </DialogHeader>\n        \n        <div className=\"space-y-6\">\n          {/* Format Selection */}\n          <div className=\"space-y-2\">\n            <Label className=\"text-slate-300\">Export Format</Label>\n            <Select value={format} onValueChange={(value: 'csv' | 'json') => setFormat(value)}>\n              <SelectTrigger className=\"bg-slate-700 border-slate-600 text-white\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"csv\">\n                  <div className=\"flex items-center\">\n                    <FileText className=\"w-4 h-4 mr-2\" />\n                    CSV (Excel Compatible)\n                  </div>\n                </SelectItem>\n                <SelectItem value=\"json\">\n                  <div className=\"flex items-center\">\n                    <Database className=\"w-4 h-4 mr-2\" />\n                    JSON (Structured Data)\n                  </div>\n                </SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* Date Range */}\n          <div className=\"space-y-2\">\n            <Label className=\"text-slate-300\">Date Range (Optional)</Label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <div>\n                <Label className=\"text-xs text-slate-400\">Start Date</Label>\n                <Input\n                  type=\"date\"\n                  value={filters.startDate || ''}\n                  onChange={(e) => setFilters(prev => ({ ...prev, startDate: e.target.value }))}\n                  className=\"bg-slate-700 border-slate-600 text-white\"\n                />\n              </div>\n              <div>\n                <Label className=\"text-xs text-slate-400\">End Date</Label>\n                <Input\n                  type=\"date\"\n                  value={filters.endDate || ''}\n                  onChange={(e) => setFilters(prev => ({ ...prev, endDate: e.target.value }))}\n                  className=\"bg-slate-700 border-slate-600 text-white\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Filters specific to incidents and alerts */}\n          {(type === 'incidents' || type === 'alerts') && (\n            <div className=\"space-y-4\">\n              {/* Severity Filter */}\n              <div className=\"space-y-2\">\n                <Label className=\"text-slate-300\">Severity (Optional)</Label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  {severityOptions.map((severity) => (\n                    <div key={severity} className=\"flex items-center space-x-2\">\n                      <Checkbox\n                        id={`severity-${severity}`}\n                        checked={filters.severity?.includes(severity) || false}\n                        onCheckedChange={(checked) => handleSeverityToggle(severity, checked as boolean)}\n                      />\n                      <Label \n                        htmlFor={`severity-${severity}`} \n                        className=\"text-sm text-slate-300 capitalize\"\n                      >\n                        {severity}\n                      </Label>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Status Filter (incidents only) */}\n              {type === 'incidents' && (\n                <div className=\"space-y-2\">\n                  <Label className=\"text-slate-300\">Status (Optional)</Label>\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    {statusOptions.map((status) => (\n                      <div key={status} className=\"flex items-center space-x-2\">\n                        <Checkbox\n                          id={`status-${status}`}\n                          checked={filters.status?.includes(status) || false}\n                          onCheckedChange={(checked) => handleStatusToggle(status, checked as boolean)}\n                        />\n                        <Label \n                          htmlFor={`status-${status}`} \n                          className=\"text-sm text-slate-300 capitalize\"\n                        >\n                          {status}\n                        </Label>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Export Actions */}\n          <div className=\"flex justify-end space-x-2 pt-4\">\n            <Button\n              variant=\"ghost\"\n              onClick={() => setOpen(false)}\n              disabled={isExporting}\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleExport}\n              disabled={isExporting}\n              className=\"soc-button-primary\"\n              data-testid=\"confirm-export\"\n            >\n              {isExporting ? \"Exporting...\" : \"Export Data\"}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":9438},"client/src/components/incident-card.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { AlertTriangle, Eye, UserPlus, TrendingUp, Clock, User } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Incident } from \"@shared/schema\";\n\ninterface IncidentCardProps {\n  incident: Incident;\n  onView?: () => void;\n  onAssign?: () => void;\n  onEscalate?: () => void;\n  isLoading?: boolean;\n  className?: string;\n  testId?: string;\n}\n\nexport function IncidentCard({ \n  incident,\n  onView,\n  onAssign,\n  onEscalate,\n  isLoading = false,\n  className,\n  testId = \"incident-card\"\n}: IncidentCardProps) {\n  const getSeverityInfo = (confidence: number) => {\n    if (confidence > 0.8) return { label: 'Critical', color: 'critical', dotColor: 'bg-red-500' };\n    if (confidence > 0.5) return { label: 'High', color: 'high', dotColor: 'bg-amber-500' };\n    if (confidence > 0.3) return { label: 'Medium', color: 'medium', dotColor: 'bg-sky-500' };\n    return { label: 'Low', color: 'low', dotColor: 'bg-emerald-500' };\n  };\n\n  const getTimeAgo = (date: string | Date) => {\n    const now = new Date();\n    const incidentDate = new Date(date);\n    const diffMs = now.getTime() - incidentDate.getTime();\n    const diffMinutes = Math.floor(diffMs / (1000 * 60));\n    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n\n    if (diffMinutes < 60) {\n      return `${diffMinutes}m ago`;\n    } else if (diffHours < 24) {\n      return `${diffHours}h ago`;\n    } else if (diffDays < 7) {\n      return `${diffDays}d ago`;\n    } else {\n      return incidentDate.toLocaleDateString();\n    }\n  };\n\n  const severity = getSeverityInfo(incident.confidence);\n  const isOpen = incident.status === 'open';\n\n  return (\n    <Card className={cn(\"soc-card transition-all duration-200 hover:border-slate-600\", className)} data-testid={testId}>\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-start space-x-3 mb-4\">\n          <div className={cn(\"w-3 h-3 rounded-full mt-2 flex-shrink-0\", severity.dotColor)}></div>\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"flex items-start justify-between mb-2\">\n              <h3 className=\"text-sm font-medium text-white truncate\" data-testid={`${testId}-title`}>\n                Security Incident #{incident.id.slice(-6)}\n              </h3>\n              <Badge \n                className={`soc-status-${severity.color} ml-2 flex-shrink-0`}\n                data-testid={`${testId}-severity`}\n              >\n                {severity.label}\n              </Badge>\n            </div>\n            \n            <p className=\"text-xs text-slate-400 mb-3\" data-testid={`${testId}-description`}>\n              {incident.decision === 'AUTO' ? 'Automated detection' : 'Manual review required'} \n              {' • '}\n              {(incident.confidence * 100).toFixed(1)}% confidence\n            </p>\n\n            <div className=\"flex items-center space-x-4 text-xs text-slate-400 mb-4\">\n              <div className=\"flex items-center space-x-1\">\n                <Clock className=\"w-3 h-3\" />\n                <span data-testid={`${testId}-time`}>\n                  {getTimeAgo(incident.createdAt)}\n                </span>\n              </div>\n              <div className=\"flex items-center space-x-1\">\n                <User className=\"w-3 h-3\" />\n                <span data-testid={`${testId}-status`}>\n                  {incident.status}\n                </span>\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-2\">\n              {onView && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"text-sky-400 hover:text-sky-300 hover:bg-sky-500/10 h-8 px-2\"\n                  onClick={onView}\n                  disabled={isLoading}\n                  data-testid={`${testId}-view`}\n                >\n                  <Eye className=\"w-3 h-3 mr-1\" />\n                  View\n                </Button>\n              )}\n              \n              {onAssign && isOpen && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"text-emerald-400 hover:text-emerald-300 hover:bg-emerald-500/10 h-8 px-2\"\n                  onClick={onAssign}\n                  disabled={isLoading}\n                  data-testid={`${testId}-assign`}\n                >\n                  <UserPlus className=\"w-3 h-3 mr-1\" />\n                  Assign\n                </Button>\n              )}\n              \n              {onEscalate && isOpen && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"text-red-400 hover:text-red-300 hover:bg-red-500/10 h-8 px-2\"\n                  onClick={onEscalate}\n                  disabled={isLoading}\n                  data-testid={`${testId}-escalate`}\n                >\n                  <TrendingUp className=\"w-3 h-3 mr-1\" />\n                  Escalate\n                </Button>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Additional incident metadata */}\n        <div className=\"pt-3 border-t border-slate-700\">\n          <div className=\"flex items-center justify-between text-xs\">\n            <span className=\"text-slate-500\">ID: {incident.id}</span>\n            <span className=\"text-slate-500\">\n              Decision: {incident.decision}\n            </span>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":5620},"client/src/components/metrics-chart.tsx":{"content":"import { ResponsiveContainer, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, BarChart, Bar, PieChart, Pie, Cell } from 'recharts';\nimport { cn } from \"@/lib/utils\";\n\ninterface ChartData {\n  name: string;\n  value: number | string;\n  category?: string;\n}\n\ninterface MetricsChartProps {\n  data: ChartData[];\n  type?: 'line' | 'bar' | 'pie';\n  height?: number;\n  className?: string;\n  color?: string;\n  showGrid?: boolean;\n  showTooltip?: boolean;\n}\n\nconst COLORS = [\n  'hsl(207, 90%, 54%)', // sky-500\n  'hsl(160, 84%, 39%)', // emerald-500\n  'hsl(43, 96%, 56%)',  // amber-500\n  'hsl(0, 84%, 60%)',   // red-500\n  'hsl(262, 83%, 58%)', // purple-500\n  'hsl(142, 71%, 45%)', // green-500\n];\n\nexport function MetricsChart({ \n  data, \n  type = 'line',\n  height = 300,\n  className,\n  color = 'hsl(207, 90%, 54%)',\n  showGrid = true,\n  showTooltip = true\n}: MetricsChartProps) {\n  const numericData = data.map(item => ({\n    ...item,\n    value: typeof item.value === 'string' ? parseFloat(item.value) || 0 : item.value\n  }));\n\n  const CustomTooltip = ({ active, payload, label }: any) => {\n    if (active && payload && payload.length) {\n      return (\n        <div className=\"bg-slate-800 border border-slate-600 rounded-lg p-3 shadow-lg\">\n          <p className=\"text-slate-300 text-sm font-medium\">{label}</p>\n          {payload.map((entry: any, index: number) => (\n            <p key={index} className=\"text-white text-sm\">\n              <span className=\"font-medium\">{entry.name}:</span> {entry.value}\n              {type === 'line' && entry.name === 'value' && 'ms'}\n              {type === 'bar' && '%'}\n            </p>\n          ))}\n        </div>\n      );\n    }\n    return null;\n  };\n\n  if (numericData.length === 0) {\n    return (\n      <div \n        className={cn(\"flex items-center justify-center text-slate-400 bg-slate-750 rounded-lg border border-slate-600\", className)}\n        style={{ height }}\n        data-testid=\"metrics-chart-empty\"\n      >\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 bg-slate-600 rounded-lg flex items-center justify-center mx-auto mb-2\">\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\"></path>\n            </svg>\n          </div>\n          <p className=\"text-sm\">No data available</p>\n        </div>\n      </div>\n    );\n  }\n\n  const renderChart = () => {\n    switch (type) {\n      case 'bar':\n        return (\n          <BarChart data={numericData}>\n            {showGrid && <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(215, 25%, 27%)\" />}\n            <XAxis \n              dataKey=\"name\" \n              stroke=\"hsl(215, 20%, 65%)\" \n              fontSize={12}\n              tickLine={false}\n              axisLine={false}\n            />\n            <YAxis \n              stroke=\"hsl(215, 20%, 65%)\" \n              fontSize={12}\n              tickLine={false}\n              axisLine={false}\n            />\n            {showTooltip && <Tooltip content={<CustomTooltip />} />}\n            <Bar \n              dataKey=\"value\" \n              fill={color}\n              radius={[4, 4, 0, 0]}\n            />\n          </BarChart>\n        );\n\n      case 'pie':\n        return (\n          <PieChart>\n            <Pie\n              data={numericData}\n              cx=\"50%\"\n              cy=\"50%\"\n              outerRadius={height / 3}\n              fill={color}\n              dataKey=\"value\"\n              label={({ name, percent }) => `${name} ${(percent * 100).toFixed(0)}%`}\n            >\n              {numericData.map((entry, index) => (\n                <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n              ))}\n            </Pie>\n            {showTooltip && <Tooltip content={<CustomTooltip />} />}\n          </PieChart>\n        );\n\n      case 'line':\n      default:\n        return (\n          <LineChart data={numericData}>\n            {showGrid && <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(215, 25%, 27%)\" />}\n            <XAxis \n              dataKey=\"name\" \n              stroke=\"hsl(215, 20%, 65%)\" \n              fontSize={12}\n              tickLine={false}\n              axisLine={false}\n            />\n            <YAxis \n              stroke=\"hsl(215, 20%, 65%)\" \n              fontSize={12}\n              tickLine={false}\n              axisLine={false}\n            />\n            {showTooltip && <Tooltip content={<CustomTooltip />} />}\n            <Line \n              type=\"monotone\" \n              dataKey=\"value\" \n              stroke={color}\n              strokeWidth={2}\n              dot={{ fill: color, strokeWidth: 2, r: 4 }}\n              activeDot={{ r: 6, stroke: color, strokeWidth: 2, fill: 'hsl(222, 84%, 4.9%)' }}\n            />\n          </LineChart>\n        );\n    }\n  };\n\n  return (\n    <div className={cn(\"w-full\", className)} data-testid=\"metrics-chart\">\n      <ResponsiveContainer width=\"100%\" height={height}>\n        {renderChart()}\n      </ResponsiveContainer>\n    </div>\n  );\n}\n","size_bytes":5249},"client/src/components/source-card.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Shield, Server, Activity, Trash2, Edit, AlertCircle } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Source } from \"@shared/schema\";\n\ninterface SourceCardProps {\n  source: Source;\n  onToggle: (enabled: boolean) => void;\n  onDelete: () => void;\n  onEdit?: () => void;\n  isDeleting?: boolean;\n  isToggling?: boolean;\n  testId?: string;\n  className?: string;\n}\n\nexport function SourceCard({ \n  source, \n  onToggle, \n  onDelete, \n  onEdit,\n  isDeleting = false,\n  isToggling = false,\n  testId = \"source-card\",\n  className \n}: SourceCardProps) {\n  const getSourceIcon = (type: string) => {\n    switch (type.toLowerCase()) {\n      case 'siem':\n        return Shield;\n      case 'edr':\n        return Activity;\n      case 'firewall':\n        return Server;\n      default:\n        return Server;\n    }\n  };\n\n  const getSourceIconColor = (type: string) => {\n    switch (type.toLowerCase()) {\n      case 'siem':\n        return 'text-sky-500';\n      case 'edr':\n        return 'text-emerald-500';\n      case 'firewall':\n        return 'text-amber-500';\n      default:\n        return 'text-slate-500';\n    }\n  };\n\n  const getSourceIconBg = (type: string) => {\n    switch (type.toLowerCase()) {\n      case 'siem':\n        return 'bg-sky-500/10';\n      case 'edr':\n        return 'bg-emerald-500/10';\n      case 'firewall':\n        return 'bg-amber-500/10';\n      default:\n        return 'bg-slate-500/10';\n    }\n  };\n\n  const isEnabled = (source.config as any)?.enabled !== false;\n  const IconComponent = getSourceIcon(source.type);\n  \n  // Mock some realistic data for demonstration\n  const lastEventTime = new Date(Date.now() - Math.random() * 3600000).toISOString();\n  const eventsPerHour = Math.floor(Math.random() * 5000) + 100;\n\n  const getLastEventDisplay = () => {\n    const now = new Date();\n    const lastEvent = new Date(lastEventTime);\n    const diffMs = now.getTime() - lastEvent.getTime();\n    const diffMinutes = Math.floor(diffMs / (1000 * 60));\n    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n\n    if (diffMinutes < 60) {\n      return `${diffMinutes}m ago`;\n    } else if (diffHours < 24) {\n      return `${diffHours}h ago`;\n    } else {\n      return lastEvent.toLocaleDateString();\n    }\n  };\n\n  return (\n    <Card className={cn(\"soc-card transition-all duration-200 hover:border-slate-600\", className)} data-testid={testId}>\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className={cn(\"w-10 h-10 rounded-lg flex items-center justify-center\", getSourceIconBg(source.type))}>\n            <IconComponent className={cn(\"w-5 h-5\", getSourceIconColor(source.type))} />\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <Badge \n              className={isEnabled ? \"soc-status-low\" : \"soc-status-critical\"}\n              data-testid={`${testId}-status`}\n            >\n              {isEnabled ? \"Active\" : \"Inactive\"}\n            </Badge>\n            {!isEnabled && (\n              <AlertCircle className=\"w-4 h-4 text-amber-500\" />\n            )}\n          </div>\n        </div>\n\n        <div className=\"mb-4\">\n          <h3 className=\"text-lg font-medium text-white mb-2\" data-testid={`${testId}-name`}>\n            {source.name}\n          </h3>\n          <p className=\"text-sm text-slate-400 mb-3\" data-testid={`${testId}-type`}>\n            {source.type} • {(source.config as any)?.endpoint ? 'Configured' : 'Configuration needed'}\n          </p>\n        </div>\n\n        <div className=\"space-y-2 mb-4\">\n          <div className=\"flex items-center justify-between text-sm\">\n            <span className=\"text-slate-400\">Last Event:</span>\n            <span className=\"text-white\" data-testid={`${testId}-last-event`}>\n              {isEnabled ? getLastEventDisplay() : 'N/A'}\n            </span>\n          </div>\n          <div className=\"flex items-center justify-between text-sm\">\n            <span className=\"text-slate-400\">Events/hr:</span>\n            <span className=\"text-white\" data-testid={`${testId}-events-per-hour`}>\n              {isEnabled ? eventsPerHour.toLocaleString() : '0'}\n            </span>\n          </div>\n          {(source.config as any)?.endpoint && (\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"text-slate-400\">Endpoint:</span>\n              <span className=\"text-slate-300 text-xs truncate max-w-32\" title={(source.config as any).endpoint}>\n                {(source.config as any).endpoint}\n              </span>\n            </div>\n          )}\n        </div>\n\n        <div className=\"flex items-center justify-between pt-4 border-t border-slate-700\">\n          <div className=\"flex items-center space-x-2\">\n            <Switch\n              checked={isEnabled}\n              onCheckedChange={onToggle}\n              disabled={isToggling}\n              data-testid={`${testId}-toggle`}\n            />\n            <span className=\"text-sm text-slate-400\">\n              {isToggling ? \"Updating...\" : isEnabled ? \"Enabled\" : \"Disabled\"}\n            </span>\n          </div>\n\n          <div className=\"flex items-center space-x-1\">\n            {onEdit && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"text-slate-400 hover:text-white hover:bg-slate-700\"\n                onClick={onEdit}\n                data-testid={`${testId}-edit`}\n              >\n                <Edit className=\"w-4 h-4\" />\n              </Button>\n            )}\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"text-red-400 hover:text-red-300 hover:bg-red-500/10\"\n              onClick={onDelete}\n              disabled={isDeleting}\n              data-testid={`${testId}-delete`}\n            >\n              <Trash2 className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":6155},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/hooks/use-realtime-updates.tsx":{"content":"import { useEffect } from 'react';\nimport { useWebSocket } from './use-websocket';\nimport { queryClient } from '@/lib/queryClient';\nimport { useToast } from './use-toast';\n\ninterface WebSocketEvent {\n  type: string;\n  data?: any;\n  message?: string;\n}\n\nexport function useRealtimeUpdates() {\n  const { lastMessage, connectionStatus } = useWebSocket();\n  const { toast } = useToast();\n\n  useEffect(() => {\n    if (!lastMessage) return;\n\n    const event = lastMessage as WebSocketEvent;\n\n    switch (event.type) {\n      case 'incident_created':\n        queryClient.invalidateQueries({ queryKey: ['/api/incidents'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/dashboard/stats'] });\n        toast({\n          title: \"New Incident\",\n          description: `Incident ${event.data?.title || 'Unknown'} has been created`,\n        });\n        break;\n\n      case 'incident_updated':\n        queryClient.invalidateQueries({ queryKey: ['/api/incidents'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/dashboard/stats'] });\n        if (event.data?.id) {\n          queryClient.invalidateQueries({ queryKey: ['/api/incidents', event.data.id] });\n        }\n        toast({\n          title: \"Incident Updated\",\n          description: `Incident ${event.data?.title || 'Unknown'} has been updated`,\n        });\n        break;\n\n      case 'alert_created':\n        queryClient.invalidateQueries({ queryKey: ['/api/alerts'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/dashboard/stats'] });\n        toast({\n          title: \"New Alert\",\n          description: `New ${event.data?.severity || 'unknown'} severity alert received`,\n        });\n        break;\n\n      case 'alert_normalized':\n        queryClient.invalidateQueries({ queryKey: ['/api/alerts'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/incidents'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/dashboard/stats'] });\n        break;\n\n      case 'alerts_simulated':\n        queryClient.invalidateQueries({ queryKey: ['/api/alerts'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/dashboard/stats'] });\n        toast({\n          title: \"Alerts Simulated\",\n          description: `${event.data?.count || 0} ${event.data?.sourceType || 'unknown'} alerts simulated`,\n        });\n        break;\n\n      case 'source_created':\n      case 'source_updated':\n      case 'source_deleted':\n        queryClient.invalidateQueries({ queryKey: ['/api/sources'] });\n        break;\n\n      case 'action_created':\n        queryClient.invalidateQueries({ queryKey: ['/api/actions'] });\n        if (event.data?.incidentId) {\n          queryClient.invalidateQueries({ queryKey: ['/api/incidents', event.data.incidentId, 'actions'] });\n        }\n        break;\n\n      case 'feedback_created':\n        queryClient.invalidateQueries({ queryKey: ['/api/feedback'] });\n        if (event.data?.incidentId) {\n          queryClient.invalidateQueries({ queryKey: ['/api/incidents', event.data.incidentId, 'feedback'] });\n        }\n        break;\n\n      case 'metric_created':\n        queryClient.invalidateQueries({ queryKey: ['/api/metrics'] });\n        break;\n\n      case 'realtime_simulation_started':\n        toast({\n          title: \"Real-time Simulation Started\",\n          description: `${event.data?.sourceType} alerts will be generated for ${event.data?.durationMinutes} minutes`,\n        });\n        break;\n\n      case 'connected':\n        // Handle initial connection\n        console.log('WebSocket connected successfully');\n        break;\n\n      default:\n        console.log('Unknown WebSocket event:', event.type, event);\n    }\n  }, [lastMessage, toast]);\n\n  return {\n    connectionStatus,\n    isConnected: connectionStatus === 'connected',\n    isConnecting: connectionStatus === 'connecting',\n    isDisconnected: connectionStatus === 'disconnected'\n  };\n}","size_bytes":3864},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/hooks/use-websocket.tsx":{"content":"import { useEffect, useRef, useState } from \"react\";\n\ninterface WebSocketMessage {\n  type: string;\n  data?: any;\n  message?: string;\n}\n\nexport function useWebSocket(url?: string) {\n  const [socket, setSocket] = useState<WebSocket | null>(null);\n  const [lastMessage, setLastMessage] = useState<WebSocketMessage | null>(null);\n  const [connectionStatus, setConnectionStatus] = useState<'connecting' | 'connected' | 'disconnected'>('connecting');\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout>();\n\n  const connect = () => {\n    try {\n      const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n      const wsUrl = url || `${protocol}//${window.location.host}/ws`;\n      const ws = new WebSocket(wsUrl);\n\n      ws.onopen = () => {\n        console.log('WebSocket connected');\n        setConnectionStatus('connected');\n        setSocket(ws);\n      };\n\n      ws.onmessage = (event) => {\n        try {\n          const message: WebSocketMessage = JSON.parse(event.data);\n          setLastMessage(message);\n        } catch (error) {\n          console.error('Failed to parse WebSocket message:', error);\n        }\n      };\n\n      ws.onclose = () => {\n        console.log('WebSocket disconnected');\n        setConnectionStatus('disconnected');\n        setSocket(null);\n        \n        // Attempt to reconnect after 3 seconds\n        reconnectTimeoutRef.current = setTimeout(() => {\n          setConnectionStatus('connecting');\n          connect();\n        }, 3000);\n      };\n\n      ws.onerror = (error) => {\n        console.error('WebSocket error:', error);\n        setConnectionStatus('disconnected');\n      };\n\n    } catch (error) {\n      console.error('Failed to connect WebSocket:', error);\n      setConnectionStatus('disconnected');\n    }\n  };\n\n  useEffect(() => {\n    connect();\n\n    return () => {\n      if (reconnectTimeoutRef.current) {\n        clearTimeout(reconnectTimeoutRef.current);\n      }\n      if (socket) {\n        socket.close();\n      }\n    };\n  }, []);\n\n  const sendMessage = (message: any) => {\n    if (socket && socket.readyState === WebSocket.OPEN) {\n      socket.send(JSON.stringify(message));\n    } else {\n      console.warn('WebSocket is not connected');\n    }\n  };\n\n  return {\n    socket,\n    lastMessage,\n    connectionStatus,\n    sendMessage,\n  };\n}\n","size_bytes":2295},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}","size_bytes":256},"client/src/lib/api.ts":{"content":"import { apiRequest } from \"./queryClient\";\n\nexport interface DashboardStats {\n  activeIncidents: number;\n  alertsToday: number;\n  avgResponseTime: string;\n  modelAccuracy: number;\n}\n\nexport interface AlertData {\n  id: string;\n  sourceId: string;\n  payload: Record<string, any>;\n  receivedAt: string;\n  type?: string;\n  severity?: 'critical' | 'high' | 'medium' | 'low';\n  title?: string;\n  description?: string;\n}\n\nexport const api = {\n  // Dashboard\n  getDashboardStats: (): Promise<DashboardStats> =>\n    fetch('/api/dashboard/stats').then(res => res.json()),\n\n  // Sources\n  getSources: () =>\n    fetch('/api/sources').then(res => res.json()),\n    \n  createSource: (source: any) =>\n    apiRequest('POST', '/api/sources', source),\n    \n  updateSource: (id: string, source: any) =>\n    apiRequest('PUT', `/api/sources/${id}`, source),\n    \n  deleteSource: (id: string) =>\n    apiRequest('DELETE', `/api/sources/${id}`),\n\n  // Incidents\n  getIncidents: () =>\n    fetch('/api/incidents').then(res => res.json()),\n    \n  getIncident: (id: string) =>\n    fetch(`/api/incidents/${id}`).then(res => res.json()),\n    \n  createIncident: (incident: any) =>\n    apiRequest('POST', '/api/incidents', incident),\n    \n  updateIncident: (id: string, incident: any) =>\n    apiRequest('PUT', `/api/incidents/${id}`, incident),\n    \n  bulkUpdateIncidents: (incidentIds: string[], operation: string, data?: any) =>\n    apiRequest('PATCH', '/api/incidents/bulk', { incidentIds, operation, data }),\n\n  // Actions\n  getActions: () =>\n    fetch('/api/actions').then(res => res.json()),\n    \n  getIncidentActions: (incidentId: string) =>\n    fetch(`/api/incidents/${incidentId}/actions`).then(res => res.json()),\n    \n  createAction: (incidentId: string, action: any) =>\n    apiRequest('POST', `/api/incidents/${incidentId}/actions`, action),\n\n  // Alerts\n  getAlerts: () =>\n    fetch('/api/alerts').then(res => res.json()),\n    \n  createAlert: (alert: any) =>\n    apiRequest('POST', '/api/alerts', alert),\n\n  // Alert Normalization & Simulation\n  getDatasetStats: () =>\n    fetch('/api/alerts/dataset-stats').then(res => res.json()),\n    \n  simulateAlerts: (sourceType: string, count: number = 10) =>\n    apiRequest('POST', `/api/alerts/simulate/${sourceType}`, { count }),\n    \n  simulateRealTimeAlerts: (sourceType: string, durationMinutes: number = 5) =>\n    apiRequest('POST', `/api/alerts/simulate-realtime/${sourceType}`, { durationMinutes }),\n    \n  getSampleAlert: (sourceType: string) =>\n    fetch(`/api/alerts/sample/${sourceType}`).then(res => res.json()),\n\n  // Feedback\n  getFeedback: () =>\n    fetch('/api/feedback').then(res => res.json()),\n    \n  getIncidentFeedback: (incidentId: string) =>\n    fetch(`/api/incidents/${incidentId}/feedback`).then(res => res.json()),\n    \n  createFeedback: (feedback: any) =>\n    apiRequest('POST', '/api/feedback', feedback),\n\n  // Metrics\n  getMetrics: () =>\n    fetch('/api/metrics').then(res => res.json()),\n    \n  createMetric: (metric: any) =>\n    apiRequest('POST', '/api/metrics', metric),\n\n  // Threat Intelligence\n  getThreatIntel: () =>\n    fetch('/api/threatintel').then(res => res.json()),\n\n  // Export functionality\n  exportIncidents: (format: 'csv' | 'json', filters?: {\n    startDate?: string;\n    endDate?: string;\n    severity?: string[];\n    status?: string[];\n  }) => {\n    const params = new URLSearchParams({ format });\n    if (filters?.startDate) params.append('start_date', filters.startDate);\n    if (filters?.endDate) params.append('end_date', filters.endDate);\n    if (filters?.severity?.length) params.append('severity', filters.severity.join(','));\n    if (filters?.status?.length) params.append('status', filters.status.join(','));\n    \n    return fetch(`/api/export/incidents?${params.toString()}`);\n  },\n\n  exportAlerts: (format: 'csv' | 'json', filters?: {\n    startDate?: string;\n    endDate?: string;\n    severity?: string[];\n    sourceId?: string;\n  }) => {\n    const params = new URLSearchParams({ format });\n    if (filters?.startDate) params.append('start_date', filters.startDate);\n    if (filters?.endDate) params.append('end_date', filters.endDate);\n    if (filters?.severity?.length) params.append('severity', filters.severity.join(','));\n    if (filters?.sourceId) params.append('source_id', filters.sourceId);\n    \n    return fetch(`/api/export/alerts?${params.toString()}`);\n  },\n\n  exportAnalytics: (format: 'csv' | 'json', filters?: {\n    startDate?: string;\n    endDate?: string;\n  }) => {\n    const params = new URLSearchParams({ format });\n    if (filters?.startDate) params.append('start_date', filters.startDate);\n    if (filters?.endDate) params.append('end_date', filters.endDate);\n    \n    return fetch(`/api/export/analytics?${params.toString()}`);\n  },\n\n  exportActions: (format: 'csv' | 'json', filters?: {\n    startDate?: string;\n    endDate?: string;\n  }) => {\n    const params = new URLSearchParams({ format });\n    if (filters?.startDate) params.append('start_date', filters.startDate);\n    if (filters?.endDate) params.append('end_date', filters.endDate);\n    \n    return fetch(`/api/export/actions?${params.toString()}`);\n  },\n};\n","size_bytes":5125},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}","size_bytes":115},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/pages/alerts.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { AlertTriangle, Shield, Settings, Play, Database, TrendingUp } from \"lucide-react\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useWebSocket } from \"@/hooks/use-websocket\";\nimport { AlertStream } from \"@/components/alert-stream\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { ExportDialog } from \"@/components/export-dialog\";\nimport { useEffect, useState } from \"react\";\n\nexport default function Alerts() {\n  const { toast } = useToast();\n  const { lastMessage } = useWebSocket();\n  const [liveAlerts, setLiveAlerts] = useState<any[]>([]);\n  const [selectedSource, setSelectedSource] = useState<string>('crowdstrike');\n\n  const { data: alerts, isLoading } = useQuery({\n    queryKey: ['/api/alerts'],\n    queryFn: api.getAlerts,\n  });\n\n  const { data: datasetStats, isLoading: statsLoading } = useQuery({\n    queryKey: ['/api/alerts/dataset-stats'],\n    queryFn: api.getDatasetStats,\n  });\n\n  const createIncidentMutation = useMutation({\n    mutationFn: (incidentData: any) => api.createIncident(incidentData),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/incidents'] });\n      toast({\n        title: \"Success\",\n        description: \"Incident created from alert\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to create incident\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const simulateAlertsMutation = useMutation({\n    mutationFn: ({ sourceType, count }: { sourceType: string; count: number }) => \n      api.simulateAlerts(sourceType, count),\n    onSuccess: (data: any) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/alerts'] });\n      toast({\n        title: \"Success\",\n        description: `Generated ${data.results?.length || data.length || 10} alerts from ${selectedSource}`,\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to simulate alerts\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const realTimeSimulationMutation = useMutation({\n    mutationFn: ({ sourceType, duration }: { sourceType: string; duration: number }) => \n      api.simulateRealTimeAlerts(sourceType, duration),\n    onSuccess: () => {\n      toast({\n        title: \"Real-time simulation started\",\n        description: `Simulating ${selectedSource} alerts for ${5} minutes`,\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to start real-time simulation\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Handle real-time WebSocket updates\n  useEffect(() => {\n    if (lastMessage?.type === 'alert_created') {\n      const newAlert = {\n        ...lastMessage.data,\n        timestamp: new Date(),\n        severity: Math.random() > 0.7 ? 'critical' : Math.random() > 0.4 ? 'high' : 'medium',\n        title: generateAlertTitle(lastMessage.data),\n      };\n      setLiveAlerts(prev => [newAlert, ...prev.slice(0, 9)]);\n    }\n  }, [lastMessage]);\n\n  const generateAlertTitle = (alertData: any) => {\n    const titles = [\n      'Failed login attempt detected',\n      'Network anomaly detected',\n      'Malware signature found',\n      'Suspicious file activity',\n      'Unauthorized access attempt',\n      'Data exfiltration suspected',\n      'Brute force attack detected',\n    ];\n    return titles[Math.floor(Math.random() * titles.length)];\n  };\n\n  const handleCreateIncident = (alertData: any) => {\n    // Create a dummy feature vector ID for the incident\n    const dummyFeatureVectorId = \"dummy-fv-\" + Date.now();\n    \n    createIncidentMutation.mutate({\n      featureVectorId: dummyFeatureVectorId,\n      decision: 'MANUAL',\n      confidence: Math.random() * 0.4 + 0.6, // Random confidence between 0.6-1.0\n      status: 'open',\n    });\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <Skeleton className=\"h-8 w-48\" />\n        <Card className=\"soc-card\">\n          <CardContent className=\"p-6\">\n            <Skeleton className=\"h-64 w-full\" />\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  // Source type options with logos/descriptions\n  const sourceTypes = [\n    { id: 'crowdstrike', name: 'CrowdStrike', description: 'EDR & Threat Intelligence', color: 'red' },\n    { id: 'sentinelone', name: 'SentinelOne', description: 'Autonomous Security Platform', color: 'purple' },\n    { id: 'email', name: 'Email Security', description: 'Email Threat Protection', color: 'blue' },\n    { id: 'firewall', name: 'Firewall', description: 'Network Security', color: 'orange' },\n  ];\n\n  const handleSimulateAlerts = () => {\n    simulateAlertsMutation.mutate({ sourceType: selectedSource, count: 10 });\n  };\n\n  const handleStartRealTimeSimulation = () => {\n    realTimeSimulationMutation.mutate({ sourceType: selectedSource, duration: 5 });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-white\" data-testid=\"alerts-title\">Alert Monitoring</h2>\n          {!statsLoading && datasetStats && (\n            <p className=\"text-slate-400 text-sm mt-1\">\n              {datasetStats.stats.total.toLocaleString()} alerts loaded from {datasetStats.sources.length} security tools\n            </p>\n          )}\n        </div>\n        <div className=\"flex items-center space-x-2 mt-4 sm:mt-0\">\n          <ExportDialog \n            type=\"alerts\" \n            triggerText=\"Export\"\n            className=\"soc-button-secondary\"\n          />\n          <Button \n            variant=\"outline\" \n            className=\"soc-button-secondary\" \n            data-testid=\"configure-alerts\"\n          >\n            <Settings className=\"w-4 h-4 mr-2\" />\n            Configure\n          </Button>\n          <Button \n            className=\"soc-button-primary\" \n            onClick={handleSimulateAlerts}\n            disabled={simulateAlertsMutation.isPending}\n            data-testid=\"simulate-alerts\"\n          >\n            <Play className=\"w-4 h-4 mr-2\" />\n            {simulateAlertsMutation.isPending ? 'Generating...' : 'Simulate Alerts'}\n          </Button>\n        </div>\n      </div>\n\n      {/* Dataset Statistics */}\n      <Card className=\"soc-card\" data-testid=\"dataset-stats\">\n        <CardHeader className=\"flex flex-row items-center justify-between\">\n          <CardTitle className=\"text-lg font-medium text-white\">Security Data Sources</CardTitle>\n          <div className=\"flex items-center space-x-2\">\n            <Database className=\"w-5 h-5 text-sky-400\" />\n            <span className=\"text-sm text-sky-400\">Real Data Loaded</span>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {statsLoading ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              {[...Array(4)].map((_, i) => (\n                <div key={i} className=\"p-4 bg-slate-750 rounded-lg border border-slate-600\">\n                  <Skeleton className=\"h-16 w-full\" />\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              {sourceTypes.map((source) => {\n                const count = datasetStats?.stats[source.id] || 0;\n                const isSelected = selectedSource === source.id;\n                return (\n                  <div \n                    key={source.id}\n                    className={`p-4 bg-slate-750 rounded-lg border transition-all cursor-pointer ${\n                      isSelected ? 'border-sky-500 bg-sky-500/5' : 'border-slate-600 hover:border-slate-500'\n                    }`}\n                    onClick={() => setSelectedSource(source.id)}\n                    data-testid={`source-${source.id}`}\n                  >\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className={`w-3 h-3 bg-${source.color}-500 rounded-full`}></div>\n                      <Badge className={`text-xs ${\n                        isSelected ? 'bg-sky-500/20 text-sky-400' : 'bg-slate-600 text-slate-300'\n                      }`}>\n                        {isSelected ? 'Selected' : 'Available'}\n                      </Badge>\n                    </div>\n                    <h3 className=\"text-white font-medium text-sm mb-1\">{source.name}</h3>\n                    <p className=\"text-slate-400 text-xs mb-2\">{source.description}</p>\n                    <div className=\"text-2xl font-bold text-white\">\n                      {count.toLocaleString()}\n                    </div>\n                    <p className=\"text-xs text-slate-400\">alerts loaded</p>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Alert Simulation Controls */}\n      <Card className=\"soc-card\" data-testid=\"simulation-controls\">\n        <CardHeader>\n          <CardTitle className=\"text-lg font-medium text-white\">Alert Simulation & Testing</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0\">\n            <div>\n              <p className=\"text-white font-medium\">\n                Generate alerts from <span className=\"text-sky-400\">{sourceTypes.find(s => s.id === selectedSource)?.name}</span>\n              </p>\n              <p className=\"text-slate-400 text-sm mt-1\">\n                Test your SOC with real security alerts from production datasets\n              </p>\n            </div>\n            <div className=\"flex items-center space-x-3\">\n              <Button \n                variant=\"outline\" \n                onClick={handleStartRealTimeSimulation}\n                disabled={realTimeSimulationMutation.isPending}\n                data-testid=\"start-realtime\"\n              >\n                <TrendingUp className=\"w-4 h-4 mr-2\" />\n                {realTimeSimulationMutation.isPending ? 'Starting...' : 'Real-time (5min)'}\n              </Button>\n              <Button \n                onClick={handleSimulateAlerts}\n                disabled={simulateAlertsMutation.isPending}\n                data-testid=\"generate-alerts\"\n              >\n                <Play className=\"w-4 h-4 mr-2\" />\n                {simulateAlertsMutation.isPending ? 'Generating...' : 'Generate 10 Alerts'}\n              </Button>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Live Alert Stream */}\n      <Card className=\"soc-card\" data-testid=\"live-alert-stream\">\n        <CardHeader className=\"flex flex-row items-center justify-between\">\n          <CardTitle className=\"text-lg font-medium text-white\">Live Alert Stream</CardTitle>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n            <span className=\"text-sm text-slate-300\">Real-time</span>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {liveAlerts.length === 0 ? (\n            <div className=\"text-center py-12 text-slate-400\">\n              <Shield className=\"w-12 h-12 mx-auto mb-4 text-slate-600\" />\n              <p>No recent alerts</p>\n              <p className=\"text-sm mt-2\">Live alerts will appear here when received</p>\n            </div>\n          ) : (\n            <AlertStream \n              alerts={liveAlerts} \n              onCreateIncident={handleCreateIncident}\n              isCreatingIncident={createIncidentMutation.isPending}\n            />\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Alert Statistics */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <Card className=\"soc-card\" data-testid=\"alerts-today-stat\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-slate-400 text-sm font-medium\">Alerts in System</p>\n                <p className=\"text-3xl font-bold text-white mt-2\" data-testid=\"alerts-today-count\">\n                  {datasetStats?.stats.total.toLocaleString() || alerts?.length || 0}\n                </p>\n              </div>\n              <div className=\"w-12 h-12 bg-amber-500/10 rounded-lg flex items-center justify-center\">\n                <AlertTriangle className=\"w-6 h-6 text-amber-500\" />\n              </div>\n            </div>\n            <div className=\"mt-4 flex items-center text-sm\">\n              <span className=\"text-sky-400\">Real data</span>\n              <span className=\"text-slate-400 ml-2\">from 4 sources</span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"soc-card\" data-testid=\"critical-alerts-stat\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-slate-400 text-sm font-medium\">Live Alerts</p>\n                <p className=\"text-3xl font-bold text-white mt-2\" data-testid=\"critical-alerts-count\">\n                  {liveAlerts.length}\n                </p>\n              </div>\n              <div className=\"w-12 h-12 bg-red-500/10 rounded-lg flex items-center justify-center\">\n                <Shield className=\"w-6 h-6 text-red-500\" />\n              </div>\n            </div>\n            <div className=\"mt-4 flex items-center text-sm\">\n              <span className=\"text-green-400\">+{liveAlerts.filter(alert => alert.severity === 'critical').length}</span>\n              <span className=\"text-slate-400 ml-2\">critical alerts</span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"soc-card\" data-testid=\"response-rate-stat\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-slate-400 text-sm font-medium\">Selected Source</p>\n                <p className=\"text-lg font-bold text-white mt-2\" data-testid=\"response-rate-value\">\n                  {sourceTypes.find(s => s.id === selectedSource)?.name}\n                </p>\n              </div>\n              <div className=\"w-12 h-12 bg-emerald-500/10 rounded-lg flex items-center justify-center\">\n                <Database className=\"w-6 h-6 text-emerald-500\" />\n              </div>\n            </div>\n            <div className=\"mt-4 flex items-center text-sm\">\n              <span className=\"text-emerald-400\">{datasetStats?.stats[selectedSource]?.toLocaleString() || '0'}</span>\n              <span className=\"text-slate-400 ml-2\">alerts available</span>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":15045},"client/src/pages/analytics.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { TrendingUp, Clock, Target, Zap } from \"lucide-react\";\nimport { api } from \"@/lib/api\";\nimport { MetricsChart } from \"@/components/metrics-chart\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { ExportDialog } from \"@/components/export-dialog\";\n\nexport default function Analytics() {\n  const { data: metrics, isLoading: metricsLoading } = useQuery({\n    queryKey: ['/api/metrics'],\n    queryFn: api.getMetrics,\n  });\n\n  const { data: realTimeAnalytics, isLoading: analyticsLoading } = useQuery({\n    queryKey: ['/api/analytics/realtime'],\n    queryFn: () => fetch('/api/analytics/realtime').then(res => res.json()),\n    refetchInterval: 30000, // Refetch every 30 seconds\n  });\n\n  const { data: incidents } = useQuery({\n    queryKey: ['/api/incidents'],\n    queryFn: api.getIncidents,\n  });\n\n  // Calculate performance metrics from real-time data\n  const performanceData = [\n    {\n      name: \"Precision\",\n      value: realTimeAnalytics?.precision ? (realTimeAnalytics.precision * 100).toFixed(1) : \"0.0\",\n      percentage: realTimeAnalytics?.precision ? realTimeAnalytics.precision * 100 : 0,\n      color: \"emerald\",\n      icon: Target,\n    },\n    {\n      name: \"Recall\",\n      value: realTimeAnalytics?.recall ? (realTimeAnalytics.recall * 100).toFixed(1) : \"0.0\",\n      percentage: realTimeAnalytics?.recall ? realTimeAnalytics.recall * 100 : 0,\n      color: \"sky\",\n      icon: TrendingUp,\n    },\n    {\n      name: \"F1 Score\",\n      value: realTimeAnalytics?.f1Score ? (realTimeAnalytics.f1Score * 100).toFixed(1) : \"0.0\",\n      percentage: realTimeAnalytics?.f1Score ? realTimeAnalytics.f1Score * 100 : 0,\n      color: \"amber\",\n      icon: Zap,\n    },\n  ];\n\n  // Use real-time calculated response time\n  const avgResponseTime = realTimeAnalytics?.avgResponseTimeMinutes || 0;\n\n  if (metricsLoading || analyticsLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <Skeleton className=\"h-8 w-48\" />\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {[...Array(4)].map((_, i) => (\n            <Card key={i} className=\"soc-card\">\n              <CardContent className=\"p-6\">\n                <Skeleton className=\"h-48 w-full\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <h2 className=\"text-2xl font-bold text-white\" data-testid=\"analytics-title\">Performance Analytics</h2>\n        <ExportDialog \n          type=\"analytics\" \n          triggerText=\"Export Analytics Report\"\n          className=\"soc-button-primary\"\n        />\n      </div>\n\n      {/* Model Performance Metrics */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card className=\"soc-card\" data-testid=\"model-performance\">\n          <CardHeader>\n            <CardTitle className=\"text-lg font-medium text-white\">Model Performance</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {performanceData.map((metric, index) => (\n              <div key={metric.name} className=\"flex items-center justify-between\" data-testid={`metric-${metric.name.toLowerCase()}`}>\n                <div className=\"flex items-center space-x-3\">\n                  <div className={`w-8 h-8 bg-${metric.color}-500/10 rounded-lg flex items-center justify-center`}>\n                    <metric.icon className={`w-4 h-4 text-${metric.color}-500`} />\n                  </div>\n                  <span className=\"text-slate-400\">{metric.name}</span>\n                </div>\n                <div className=\"flex items-center space-x-3\">\n                  <Progress \n                    value={metric.percentage} \n                    className=\"w-32 bg-slate-700\"\n                    data-testid={`progress-${metric.name.toLowerCase()}`}\n                  />\n                  <span className=\"text-white font-medium w-12 text-right\" data-testid={`value-${metric.name.toLowerCase()}`}>\n                    {metric.value}{metric.name === 'Precision' || metric.name === 'Recall' ? '%' : ''}\n                  </span>\n                </div>\n              </div>\n            ))}\n          </CardContent>\n        </Card>\n\n        <Card className=\"soc-card\" data-testid=\"response-times-chart\">\n          <CardHeader>\n            <CardTitle className=\"text-lg font-medium text-white\">Response Times</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <MetricsChart \n              data={[\n                { name: 'Avg Response', value: avgResponseTime.toFixed(1) },\n                { name: 'Target', value: '5.0' },\n              ]}\n              height={200}\n            />\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Additional Analytics */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <Card className=\"soc-card\" data-testid=\"automation-rate\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-medium text-white\">Automation Rate</h3>\n              <Badge className=\"soc-status-high\">High</Badge>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-white mb-2\" data-testid=\"automation-rate-value\">\n                {realTimeAnalytics?.automationRate ? (realTimeAnalytics.automationRate * 100).toFixed(1) : '0.0'}%\n              </div>\n              <p className=\"text-slate-400 text-sm\">Auto-resolved incidents</p>\n              <Progress value={realTimeAnalytics?.automationRate ? realTimeAnalytics.automationRate * 100 : 0} className=\"mt-4 bg-slate-700\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"soc-card\" data-testid=\"threat-detection\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-medium text-white\">Threat Detection</h3>\n              <div className=\"w-8 h-8 bg-red-500/10 rounded-lg flex items-center justify-center\">\n                <TrendingUp className=\"w-4 h-4 text-red-500\" />\n              </div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-white mb-2\" data-testid=\"threat-detection-value\">\n                {realTimeAnalytics?.incidentsCreatedToday || 0}\n              </div>\n              <p className=\"text-slate-400 text-sm\">Incidents created today</p>\n              <div className=\"mt-4 flex items-center text-sm\">\n                <span className=\"text-emerald-400\">{realTimeAnalytics?.threatDetectionRate ? (realTimeAnalytics.threatDetectionRate * 100).toFixed(0) : '0'}%</span>\n                <span className=\"text-slate-400 ml-2\">detection rate</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"soc-card\" data-testid=\"false-positive-rate\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-medium text-white\">False Positive Rate</h3>\n              <Badge className=\"soc-status-low\">Low</Badge>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-white mb-2\" data-testid=\"false-positive-rate-value\">\n                {realTimeAnalytics?.falsePositiveRate ? (realTimeAnalytics.falsePositiveRate * 100).toFixed(1) : '0.0'}%\n              </div>\n              <p className=\"text-slate-400 text-sm\">False positive rate</p>\n              <div className=\"mt-4 flex items-center text-sm\">\n                <span className=\"text-emerald-400\">Avg: {realTimeAnalytics?.avgFeedbackRating ? realTimeAnalytics.avgFeedbackRating.toFixed(1) : '0.0'}/5</span>\n                <span className=\"text-slate-400 ml-2\">analyst rating</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Processing Statistics */}\n      <Card className=\"soc-card\" data-testid=\"processing-stats\">\n        <CardHeader>\n          <CardTitle className=\"text-lg font-medium text-white\">Processing Statistics</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-white mb-2\" data-testid=\"alerts-processed\">\n                {realTimeAnalytics?.alertsProcessedToday?.toLocaleString() || '0'}\n              </div>\n              <p className=\"text-slate-400 text-sm\">Alerts Processed Today</p>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-white mb-2\" data-testid=\"auto-actions\">\n                {Math.round((realTimeAnalytics?.automationRate || 0) * (realTimeAnalytics?.alertsProcessedToday || 0))}\n              </div>\n              <p className=\"text-slate-400 text-sm\">Auto Actions</p>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-white mb-2\" data-testid=\"manual-reviews\">\n                {realTimeAnalytics?.manualReviewsToday || 0}\n              </div>\n              <p className=\"text-slate-400 text-sm\">Manual Reviews Today</p>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-white mb-2\" data-testid=\"avg-processing-time\">\n                {realTimeAnalytics?.avgResponseTimeMinutes ? `${realTimeAnalytics.avgResponseTimeMinutes.toFixed(1)}m` : '0.0m'}\n              </div>\n              <p className=\"text-slate-400 text-sm\">Avg Response Time</p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":10102},"client/src/pages/dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { AlertTriangle, Shield, Clock, CheckCircle, TrendingUp, TrendingDown, Database } from \"lucide-react\";\nimport { api } from \"@/lib/api\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { MetricsChart } from \"@/components/metrics-chart\";\n\nexport default function Dashboard() {\n  const { data: stats, isLoading: statsLoading } = useQuery({\n    queryKey: ['/api/dashboard/stats'],\n    queryFn: api.getDashboardStats,\n  });\n\n  const { data: incidents, isLoading: incidentsLoading } = useQuery({\n    queryKey: ['/api/incidents'],\n    queryFn: api.getIncidents,\n  });\n\n  const { data: datasetStats } = useQuery({\n    queryKey: ['/api/alerts/dataset-stats'],\n    queryFn: api.getDatasetStats,\n  });\n\n  const { data: metrics } = useQuery({\n    queryKey: ['/api/metrics'],\n    queryFn: api.getMetrics,\n  });\n\n  const recentIncidents = incidents?.slice(0, 3) || [];\n\n  if (statsLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          {[...Array(4)].map((_, i) => (\n            <Card key={i} className=\"soc-card\">\n              <CardContent className=\"p-6\">\n                <Skeleton className=\"h-4 w-24 mb-4\" />\n                <Skeleton className=\"h-8 w-12 mb-4\" />\n                <Skeleton className=\"h-4 w-32\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const dashboardMetrics = [\n    {\n      title: \"Active Incidents\",\n      value: stats?.activeIncidents || 0,\n      icon: AlertTriangle,\n      iconColor: \"text-red-500\",\n      bgColor: \"bg-red-500/10\",\n      change: \"+2\",\n      changeType: \"increase\",\n      subtitle: \"from last hour\",\n      testId: \"metric-active-incidents\"\n    },\n    {\n      title: \"Alert Dataset\",\n      value: datasetStats?.stats.total?.toLocaleString() || stats?.alertsToday || 0,\n      icon: Database,\n      iconColor: \"text-sky-500\",\n      bgColor: \"bg-sky-500/10\",\n      change: \"4K+\",\n      changeType: \"increase\",\n      subtitle: \"real security alerts\",\n      testId: \"metric-dataset-size\"\n    },\n    {\n      title: \"Response Time\",\n      value: stats?.avgResponseTime || \"0m\",\n      icon: Clock,\n      iconColor: \"text-amber-500\",\n      bgColor: \"bg-amber-500/10\",\n      change: \"-1.2m\",\n      changeType: \"decrease\",\n      subtitle: \"improvement\",\n      testId: \"metric-response-time\"\n    },\n    {\n      title: \"Model Accuracy\",\n      value: `${stats?.modelAccuracy?.toFixed(1) || 94.2}%`,\n      icon: CheckCircle,\n      iconColor: \"text-emerald-500\",\n      bgColor: \"bg-emerald-500/10\",\n      change: \"+0.3%\",\n      changeType: \"increase\",\n      subtitle: \"with real data\",\n      testId: \"metric-model-accuracy\"\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Key Metrics Row */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        {dashboardMetrics.map((metric, index) => (\n          <Card key={index} className=\"soc-card\" data-testid={metric.testId}>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-slate-400 text-sm font-medium\">{metric.title}</p>\n                  <p className=\"text-3xl font-bold text-white mt-2\" data-testid={`${metric.testId}-value`}>\n                    {metric.value}\n                  </p>\n                </div>\n                <div className={`w-12 h-12 ${metric.bgColor} rounded-lg flex items-center justify-center`}>\n                  <metric.icon className={`w-6 h-6 ${metric.iconColor}`} />\n                </div>\n              </div>\n              <div className=\"mt-4 flex items-center text-sm\">\n                <span className={`${metric.changeType === 'increase' && metric.title === 'Active Incidents' ? 'text-red-400' : 'text-sky-400'}`}>\n                  {metric.changeType === 'increase' && metric.title === 'Active Incidents' ? \n                    <TrendingUp className=\"w-4 h-4 inline mr-1\" /> : \n                    <TrendingDown className=\"w-4 h-4 inline mr-1\" />\n                  }\n                  {metric.change}\n                </span>\n                <span className=\"text-slate-400 ml-2\">{metric.subtitle}</span>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Charts and Recent Activity */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Alert Sources Distribution */}\n        <Card className=\"soc-card\" data-testid=\"alert-sources-chart\">\n          <CardHeader className=\"flex flex-row items-center justify-between\">\n            <CardTitle className=\"text-lg font-semibold text-white\">Alert Sources</CardTitle>\n            <Badge className=\"soc-status-high\">Live Data</Badge>\n          </CardHeader>\n          <CardContent>\n            {datasetStats ? (\n              <MetricsChart \n                data={[\n                  { name: 'CrowdStrike', value: datasetStats.stats.crowdstrike },\n                  { name: 'SentinelOne', value: datasetStats.stats.sentinelone },\n                  { name: 'Email Security', value: datasetStats.stats.email },\n                  { name: 'Firewall', value: datasetStats.stats.firewall },\n                ]}\n                type=\"pie\"\n                height={240}\n              />\n            ) : (\n              <div className=\"h-64 bg-slate-750 rounded-lg flex items-center justify-center border border-slate-600\">\n                <div className=\"text-center text-slate-400\">\n                  <Database className=\"w-12 h-12 mx-auto mb-2\" />\n                  <p className=\"text-sm\">Loading alert source data...</p>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Recent Incidents */}\n        <Card className=\"soc-card\" data-testid=\"recent-incidents\">\n          <CardHeader className=\"flex flex-row items-center justify-between\">\n            <CardTitle className=\"text-lg font-semibold text-white\">Recent Incidents</CardTitle>\n            <Button variant=\"ghost\" className=\"text-sky-400 hover:text-sky-300 text-sm font-medium\" data-testid=\"view-all-incidents\">\n              View All\n            </Button>\n          </CardHeader>\n          <CardContent>\n            {incidentsLoading ? (\n              <div className=\"space-y-4\">\n                {[...Array(3)].map((_, i) => (\n                  <div key={i} className=\"flex items-start space-x-3 p-3 bg-slate-750 rounded-lg border border-slate-600\">\n                    <Skeleton className=\"w-3 h-3 rounded-full mt-1.5\" />\n                    <div className=\"flex-1\">\n                      <Skeleton className=\"h-4 w-48 mb-2\" />\n                      <Skeleton className=\"h-3 w-24 mb-2\" />\n                      <div className=\"flex items-center space-x-2\">\n                        <Skeleton className=\"h-5 w-16\" />\n                        <Skeleton className=\"h-3 w-12\" />\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : recentIncidents.length === 0 ? (\n              <div className=\"text-center py-8 text-slate-400\">\n                <AlertTriangle className=\"w-12 h-12 mx-auto mb-4 text-slate-600\" />\n                <p>No recent incidents</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {recentIncidents.map((incident: any, index: number) => {\n                  const severityColor = incident.confidence > 0.8 ? 'red' : incident.confidence > 0.5 ? 'amber' : 'sky';\n                  const severity = incident.confidence > 0.8 ? 'Critical' : incident.confidence > 0.5 ? 'High' : 'Medium';\n                  \n                  return (\n                    <div key={incident.id} className=\"flex items-start space-x-3 p-3 bg-slate-750 rounded-lg border border-slate-600\" data-testid={`incident-${index}`}>\n                      <div className={`w-3 h-3 bg-${severityColor}-500 rounded-full mt-1.5 flex-shrink-0`}></div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-medium text-white\" data-testid={`incident-${index}-title`}>\n                          Security Incident #{incident.id.slice(-6)}\n                        </p>\n                        <p className=\"text-xs text-slate-400 mt-1\" data-testid={`incident-${index}-time`}>\n                          {new Date(incident.createdAt).toLocaleString()}\n                        </p>\n                        <div className=\"flex items-center space-x-2 mt-2\">\n                          <Badge className={`soc-status-${severityColor === 'red' ? 'critical' : severityColor === 'amber' ? 'high' : 'medium'}`} data-testid={`incident-${index}-severity`}>\n                            {severity}\n                          </Badge>\n                          <span className=\"text-xs text-slate-400\" data-testid={`incident-${index}-status`}>\n                            {incident.status}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n      \n      {/* Alert Dataset Overview */}\n      <Card className=\"soc-card\" data-testid=\"dataset-overview\">\n        <CardHeader>\n          <CardTitle className=\"text-lg font-semibold text-white\">Normalization System Status</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-white mb-2\">\n                {datasetStats?.sources?.length || 4}\n              </div>\n              <p className=\"text-slate-400 text-sm\">Security Tools</p>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-white mb-2\">\n                {datasetStats?.stats?.total?.toLocaleString() || '0'}\n              </div>\n              <p className=\"text-slate-400 text-sm\">Normalized Alerts</p>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-emerald-400 mb-2\">\n                100%\n              </div>\n              <p className=\"text-slate-400 text-sm\">Data Quality</p>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-sky-400 mb-2\">\n                Active\n              </div>\n              <p className=\"text-slate-400 text-sm\">System Status</p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":10943},"client/src/pages/feedback.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { MessageSquare, Star, Plus, User } from \"lucide-react\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { insertFeedbackSchema } from \"@shared/schema\";\nimport { useState } from \"react\";\n\nconst feedbackFormSchema = insertFeedbackSchema.extend({\n  rating: z.number().min(1).max(5),\n  comment: z.string().min(10, \"Comment must be at least 10 characters\"),\n});\n\nexport default function Feedback() {\n  const { toast } = useToast();\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n\n  const { data: feedback, isLoading: feedbackLoading } = useQuery({\n    queryKey: ['/api/feedback'],\n    queryFn: api.getFeedback,\n  });\n\n  const { data: incidents } = useQuery({\n    queryKey: ['/api/incidents'],\n    queryFn: api.getIncidents,\n  });\n\n  const createFeedbackMutation = useMutation({\n    mutationFn: api.createFeedback,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/feedback'] });\n      setIsCreateDialogOpen(false);\n      form.reset();\n      toast({\n        title: \"Success\",\n        description: \"Feedback submitted successfully\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to submit feedback\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const form = useForm<z.infer<typeof feedbackFormSchema>>({\n    resolver: zodResolver(feedbackFormSchema),\n    defaultValues: {\n      incidentId: \"\",\n      userId: \"demo-user-id\", // In real app, this would come from auth\n      feedback: {},\n      rating: 5,\n      comment: \"\",\n    },\n  });\n\n  const onSubmit = (values: z.infer<typeof feedbackFormSchema>) => {\n    const { rating, comment, ...feedbackData } = values;\n    createFeedbackMutation.mutate({\n      ...feedbackData,\n      feedback: {\n        rating,\n        comment,\n        timestamp: new Date().toISOString(),\n      },\n    });\n  };\n\n  const renderStars = (rating: number) => {\n    return Array.from({ length: 5 }, (_, i) => (\n      <Star\n        key={i}\n        className={`w-4 h-4 ${i < rating ? 'text-amber-400 fill-current' : 'text-slate-600'}`}\n      />\n    ));\n  };\n\n  if (feedbackLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <Skeleton className=\"h-8 w-48\" />\n        <Card className=\"soc-card\">\n          <CardContent className=\"p-6\">\n            <Skeleton className=\"h-64 w-full\" />\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between\">\n        <h2 className=\"text-2xl font-bold text-white\" data-testid=\"feedback-title\">Feedback & Reviews</h2>\n        <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"mt-4 sm:mt-0 soc-button-primary\" data-testid=\"submit-feedback\">\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Submit Feedback\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"bg-slate-800 border-slate-700\">\n            <DialogHeader>\n              <DialogTitle className=\"text-white\">Submit Feedback</DialogTitle>\n            </DialogHeader>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\" data-testid=\"feedback-form\">\n                <FormField\n                  control={form.control}\n                  name=\"incidentId\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-slate-200\">Related Incident</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger className=\"bg-slate-700 border-slate-600 text-white\" data-testid=\"incident-select\">\n                            <SelectValue placeholder=\"Select an incident\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {incidents?.slice(0, 10).map((incident: any) => (\n                            <SelectItem key={incident.id} value={incident.id}>\n                              #{incident.id.slice(-6)} - {new Date(incident.createdAt).toLocaleDateString()}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"rating\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-slate-200\">Rating</FormLabel>\n                      <FormControl>\n                        <div className=\"flex space-x-1\" data-testid=\"rating-stars\">\n                          {Array.from({ length: 5 }, (_, i) => (\n                            <button\n                              key={i}\n                              type=\"button\"\n                              onClick={() => field.onChange(i + 1)}\n                              className=\"p-1\"\n                              data-testid={`star-${i + 1}`}\n                            >\n                              <Star\n                                className={`w-6 h-6 ${\n                                  i < field.value ? 'text-amber-400 fill-current' : 'text-slate-600'\n                                }`}\n                              />\n                            </button>\n                          ))}\n                        </div>\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"comment\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-slate-200\">Comment</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          {...field}\n                          placeholder=\"Share your thoughts on the incident handling, model accuracy, or system performance...\"\n                          className=\"bg-slate-700 border-slate-600 text-white min-h-[100px]\"\n                          data-testid=\"feedback-comment\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <div className=\"flex justify-end space-x-2 pt-4\">\n                  <Button \n                    type=\"button\" \n                    variant=\"ghost\" \n                    onClick={() => setIsCreateDialogOpen(false)}\n                    data-testid=\"cancel-feedback\"\n                  >\n                    Cancel\n                  </Button>\n                  <Button \n                    type=\"submit\" \n                    disabled={createFeedbackMutation.isPending}\n                    className=\"soc-button-primary\"\n                    data-testid=\"submit-feedback-button\"\n                  >\n                    {createFeedbackMutation.isPending ? \"Submitting...\" : \"Submit Feedback\"}\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Feedback Statistics */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n        <Card className=\"soc-card\" data-testid=\"total-feedback-stat\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-slate-400 text-sm font-medium\">Total Feedback</p>\n                <p className=\"text-3xl font-bold text-white mt-2\" data-testid=\"total-feedback-count\">\n                  {feedback?.length || 0}\n                </p>\n              </div>\n              <div className=\"w-12 h-12 bg-sky-500/10 rounded-lg flex items-center justify-center\">\n                <MessageSquare className=\"w-6 h-6 text-sky-500\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"soc-card\" data-testid=\"avg-rating-stat\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-slate-400 text-sm font-medium\">Average Rating</p>\n                <div className=\"flex items-center mt-2\">\n                  <p className=\"text-3xl font-bold text-white mr-2\" data-testid=\"avg-rating-value\">4.2</p>\n                  <div className=\"flex\">\n                    {renderStars(4)}\n                  </div>\n                </div>\n              </div>\n              <div className=\"w-12 h-12 bg-amber-500/10 rounded-lg flex items-center justify-center\">\n                <Star className=\"w-6 h-6 text-amber-500\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"soc-card\" data-testid=\"positive-feedback-stat\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-slate-400 text-sm font-medium\">Positive Feedback</p>\n                <p className=\"text-3xl font-bold text-white mt-2\" data-testid=\"positive-feedback-percentage\">\n                  86%\n                </p>\n              </div>\n              <div className=\"w-12 h-12 bg-emerald-500/10 rounded-lg flex items-center justify-center\">\n                <MessageSquare className=\"w-6 h-6 text-emerald-500\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"soc-card\" data-testid=\"response-rate-stat\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-slate-400 text-sm font-medium\">Response Rate</p>\n                <p className=\"text-3xl font-bold text-white mt-2\" data-testid=\"feedback-response-rate\">\n                  73%\n                </p>\n              </div>\n              <div className=\"w-12 h-12 bg-sky-500/10 rounded-lg flex items-center justify-center\">\n                <User className=\"w-6 h-6 text-sky-500\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Feedback List */}\n      <Card className=\"soc-card\" data-testid=\"feedback-list\">\n        <CardHeader>\n          <CardTitle className=\"text-lg font-medium text-white\">\n            Recent Feedback ({feedback?.length || 0})\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {!feedback?.length ? (\n            <div className=\"text-center py-12 text-slate-400\">\n              <MessageSquare className=\"w-12 h-12 mx-auto mb-4 text-slate-600\" />\n              <p>No feedback submitted yet</p>\n              <p className=\"text-sm mt-2\">Be the first to share your thoughts!</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {feedback.map((item: any, index: number) => (\n                <div key={item.id} className=\"flex space-x-4 p-4 bg-slate-750 rounded-lg\" data-testid={`feedback-${index}`}>\n                  <div className=\"w-10 h-10 bg-slate-600 rounded-full flex items-center justify-center flex-shrink-0\">\n                    <User className=\"w-5 h-5 text-slate-300\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <span className=\"font-medium text-white\" data-testid={`feedback-${index}-user`}>\n                        Security Analyst\n                      </span>\n                      <span className=\"text-slate-400 text-sm\" data-testid={`feedback-${index}-time`}>\n                        • {new Date(item.submittedAt).toLocaleString()}\n                      </span>\n                    </div>\n                    {item.feedback?.comment && (\n                      <p className=\"text-slate-300 text-sm mb-3\" data-testid={`feedback-${index}-comment`}>\n                        {item.feedback.comment}\n                      </p>\n                    )}\n                    <div className=\"flex items-center space-x-4\">\n                      <div className=\"flex items-center space-x-1\">\n                        <span className=\"text-xs text-slate-400\">Incident:</span>\n                        <Badge variant=\"outline\" className=\"text-sky-400 border-sky-400\" data-testid={`feedback-${index}-incident`}>\n                          #{item.incidentId?.slice(-6) || 'N/A'}\n                        </Badge>\n                      </div>\n                      {item.feedback?.rating && (\n                        <div className=\"flex items-center space-x-1\" data-testid={`feedback-${index}-rating`}>\n                          <span className=\"text-xs text-slate-400\">Rating:</span>\n                          <div className=\"flex\">\n                            {renderStars(item.feedback.rating)}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":14367},"client/src/pages/incidents.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogDescription } from \"@/components/ui/dialog\";\nimport { AlertTriangle, Eye, UserPlus, TrendingUp, Search, Download, X, CheckCircle2 } from \"lucide-react\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { ExportDialog } from \"@/components/export-dialog\";\nimport { useState } from \"react\";\n\nexport default function Incidents() {\n  const { toast } = useToast();\n  const [filterSeverity, setFilterSeverity] = useState<string>('all');\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [selectedIncidents, setSelectedIncidents] = useState<string[]>([]);\n  const [bulkOperation, setBulkOperation] = useState<string>('');\n  const [showBulkDialog, setShowBulkDialog] = useState(false);\n\n  const { data: incidents, isLoading } = useQuery({\n    queryKey: ['/api/incidents'],\n    queryFn: api.getIncidents,\n  });\n\n  const updateIncidentMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) => api.updateIncident(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/incidents'] });\n      toast({\n        title: \"Success\",\n        description: \"Incident updated successfully\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update incident\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const createActionMutation = useMutation({\n    mutationFn: ({ incidentId, action }: { incidentId: string; action: any }) => \n      api.createAction(incidentId, action),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/incidents'] });\n      toast({\n        title: \"Success\",\n        description: \"Action created successfully\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to create action\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const bulkUpdateMutation = useMutation({\n    mutationFn: ({ incidentIds, operation, data }: { incidentIds: string[]; operation: string; data?: any }) =>\n      api.bulkUpdateIncidents(incidentIds, operation, data),\n    onSuccess: (result) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/incidents'] });\n      setSelectedIncidents([]);\n      setShowBulkDialog(false);\n      toast({\n        title: \"Bulk Operation Complete\",\n        description: `Updated ${result.updated} incidents${result.errorCount > 0 ? ` (${result.errorCount} errors)` : ''}`,\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to perform bulk operation\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const filteredIncidents = incidents?.filter((incident: any) => {\n    const severityMatch = filterSeverity === 'all' || \n      (filterSeverity === 'critical' && incident.confidence > 0.8) ||\n      (filterSeverity === 'high' && incident.confidence <= 0.8 && incident.confidence > 0.5) ||\n      (filterSeverity === 'medium' && incident.confidence <= 0.5 && incident.confidence > 0.3) ||\n      (filterSeverity === 'low' && incident.confidence <= 0.3);\n    \n    const searchMatch = searchTerm === '' || \n      incident.id.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      incident.status.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    return severityMatch && searchMatch;\n  }) || [];\n\n  const getSeverityInfo = (confidence: number) => {\n    if (confidence > 0.8) return { label: 'Critical', color: 'critical' };\n    if (confidence > 0.5) return { label: 'High', color: 'high' };\n    if (confidence > 0.3) return { label: 'Medium', color: 'medium' };\n    return { label: 'Low', color: 'low' };\n  };\n\n  const handleAssignIncident = (incidentId: string) => {\n    createActionMutation.mutate({\n      incidentId,\n      action: {\n        actionType: 'ANALYST_ASSIGNMENT',\n        payload: { assignedTo: 'current_user' },\n        performedBy: 'system',\n      },\n    });\n  };\n\n  const handleEscalateIncident = (incidentId: string) => {\n    createActionMutation.mutate({\n      incidentId,\n      action: {\n        actionType: 'ESCALATE',\n        payload: { escalatedTo: 'senior_analyst' },\n        performedBy: 'system',\n      },\n    });\n  };\n\n  const handleSelectIncident = (incidentId: string, checked: boolean) => {\n    if (checked) {\n      setSelectedIncidents(prev => [...prev, incidentId]);\n    } else {\n      setSelectedIncidents(prev => prev.filter(id => id !== incidentId));\n    }\n  };\n\n  const handleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedIncidents(filteredIncidents.map((inc: any) => inc.id));\n    } else {\n      setSelectedIncidents([]);\n    }\n  };\n\n  const handleBulkOperation = (operation: string) => {\n    setBulkOperation(operation);\n    setShowBulkDialog(true);\n  };\n\n  const confirmBulkOperation = () => {\n    if (selectedIncidents.length === 0 || !bulkOperation) return;\n    \n    const data: any = { performedBy: 'analyst' };\n    \n    if (bulkOperation === 'assign') {\n      data.assignedTo = 'current_user'; // In real app, this would be selected\n    } else if (bulkOperation === 'close') {\n      data.reason = 'Bulk closure by analyst';\n    }\n    \n    bulkUpdateMutation.mutate({\n      incidentIds: selectedIncidents,\n      operation: bulkOperation,\n      data\n    });\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <Skeleton className=\"h-8 w-48\" />\n        <Card className=\"soc-card\">\n          <CardContent className=\"p-6\">\n            <Skeleton className=\"h-64 w-full\" />\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div className=\"flex items-center gap-4\">\n          <h2 className=\"text-2xl font-bold text-white\" data-testid=\"incidents-title\">Incident Management</h2>\n          {selectedIncidents.length > 0 && (\n            <div className=\"flex items-center gap-2\">\n              <Badge variant=\"secondary\" className=\"text-xs\">\n                {selectedIncidents.length} selected\n              </Badge>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setSelectedIncidents([])}\n                className=\"text-slate-400 hover:text-white\"\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          )}\n        </div>\n        <div className=\"flex flex-wrap gap-3\">\n          {selectedIncidents.length > 0 && (\n            <>\n              <Button\n                onClick={() => handleBulkOperation('assign')}\n                disabled={bulkUpdateMutation.isPending}\n                className=\"soc-button-secondary\"\n                data-testid=\"bulk-assign\"\n              >\n                <UserPlus className=\"w-4 h-4 mr-2\" />\n                Assign ({selectedIncidents.length})\n              </Button>\n              <Button\n                onClick={() => handleBulkOperation('escalate')}\n                disabled={bulkUpdateMutation.isPending}\n                className=\"soc-button-warning\"\n                data-testid=\"bulk-escalate\"\n              >\n                <TrendingUp className=\"w-4 h-4 mr-2\" />\n                Escalate ({selectedIncidents.length})\n              </Button>\n              <Button\n                onClick={() => handleBulkOperation('close')}\n                disabled={bulkUpdateMutation.isPending}\n                className=\"soc-button-success\"\n                data-testid=\"bulk-close\"\n              >\n                <CheckCircle2 className=\"w-4 h-4 mr-2\" />\n                Close ({selectedIncidents.length})\n              </Button>\n            </>\n          )}\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400\" />\n            <Input\n              type=\"text\"\n              placeholder=\"Search incidents...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"bg-slate-700 border-slate-600 pl-10 text-white placeholder-slate-400 w-64\"\n              data-testid=\"incidents-search\"\n            />\n          </div>\n          <Select value={filterSeverity} onValueChange={setFilterSeverity}>\n            <SelectTrigger className=\"bg-slate-700 border-slate-600 text-white w-40\" data-testid=\"severity-filter\">\n              <SelectValue placeholder=\"All Incidents\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Incidents</SelectItem>\n              <SelectItem value=\"critical\">Critical</SelectItem>\n              <SelectItem value=\"high\">High</SelectItem>\n              <SelectItem value=\"medium\">Medium</SelectItem>\n              <SelectItem value=\"low\">Low</SelectItem>\n            </SelectContent>\n          </Select>\n          <ExportDialog \n            type=\"incidents\" \n            triggerText=\"Export Report\"\n            className=\"soc-button-primary\"\n          />\n        </div>\n      </div>\n\n      {/* Incidents Table */}\n      <Card className=\"soc-card\" data-testid=\"incidents-table\">\n        <CardHeader>\n          <CardTitle className=\"text-lg font-medium text-white\">\n            Active Incidents ({filteredIncidents.length})\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-0\">\n          {filteredIncidents.length === 0 ? (\n            <div className=\"text-center py-12 text-slate-400\">\n              <AlertTriangle className=\"w-12 h-12 mx-auto mb-4 text-slate-600\" />\n              <p>No incidents found matching your criteria</p>\n            </div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead className=\"bg-slate-750\">\n                  <tr>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider w-12\">\n                      <Checkbox\n                        checked={selectedIncidents.length === filteredIncidents.length && filteredIncidents.length > 0}\n                        onCheckedChange={handleSelectAll}\n                        data-testid=\"select-all-checkbox\"\n                      />\n                    </th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">ID</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">Description</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">Severity</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">Status</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">Created</th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-slate-700\">\n                  {filteredIncidents.map((incident: any, index: number) => {\n                    const severity = getSeverityInfo(incident.confidence);\n                    return (\n                      <tr key={incident.id} className=\"hover:bg-slate-750\" data-testid={`incident-row-${index}`}>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <Checkbox\n                            checked={selectedIncidents.includes(incident.id)}\n                            onCheckedChange={(checked) => handleSelectIncident(incident.id, checked as boolean)}\n                            data-testid={`select-incident-${index}`}\n                          />\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm font-mono text-slate-300\" data-testid={`incident-id-${index}`}>\n                          #{incident.id.slice(-6)}\n                        </td>\n                        <td className=\"px-6 py-4 text-sm text-white\">\n                          <div>\n                            <p className=\"font-medium\" data-testid={`incident-title-${index}`}>\n                              Security Incident Detection\n                            </p>\n                            <p className=\"text-slate-400\" data-testid={`incident-description-${index}`}>\n                              Automated detection with {(incident.confidence * 100).toFixed(1)}% confidence\n                            </p>\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <Badge className={`soc-status-${severity.color}`} data-testid={`incident-severity-${index}`}>\n                            {severity.label}\n                          </Badge>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <Badge \n                            variant={incident.status === 'open' ? 'destructive' : 'secondary'}\n                            data-testid={`incident-status-${index}`}\n                          >\n                            {incident.status}\n                          </Badge>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-slate-300\" data-testid={`incident-created-${index}`}>\n                          {new Date(incident.createdAt).toLocaleString()}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm space-x-2\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            className=\"text-sky-400 hover:text-sky-300\"\n                            data-testid={`view-incident-${index}`}\n                          >\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            View\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            className=\"text-emerald-400 hover:text-emerald-300\"\n                            onClick={() => handleAssignIncident(incident.id)}\n                            disabled={createActionMutation.isPending}\n                            data-testid={`assign-incident-${index}`}\n                          >\n                            <UserPlus className=\"w-4 h-4 mr-1\" />\n                            Assign\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            className=\"text-red-400 hover:text-red-300\"\n                            onClick={() => handleEscalateIncident(incident.id)}\n                            disabled={createActionMutation.isPending}\n                            data-testid={`escalate-incident-${index}`}\n                          >\n                            <TrendingUp className=\"w-4 h-4 mr-1\" />\n                            Escalate\n                          </Button>\n                        </td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Bulk Operation Confirmation Dialog */}\n      <Dialog open={showBulkDialog} onOpenChange={setShowBulkDialog}>\n        <DialogContent className=\"bg-slate-800 border-slate-700\">\n          <DialogHeader>\n            <DialogTitle className=\"text-white\">Confirm Bulk Operation</DialogTitle>\n            <DialogDescription className=\"text-slate-400\">\n              You are about to {bulkOperation} {selectedIncidents.length} incident{selectedIncidents.length !== 1 ? 's' : ''}. \n              This action cannot be undone.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"bg-slate-750 p-4 rounded-lg\">\n              <h4 className=\"text-white font-medium mb-2\">Selected Incidents:</h4>\n              <div className=\"space-y-1 max-h-32 overflow-y-auto\">\n                {selectedIncidents.map((incidentId, index) => {\n                  const incident = filteredIncidents.find((inc: any) => inc.id === incidentId);\n                  return (\n                    <div key={incidentId} className=\"text-sm text-slate-300\">\n                      #{incident?.id.slice(-6)} - {incident?.status || 'Unknown'}\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n            <div className=\"flex justify-end space-x-2\">\n              <Button\n                variant=\"ghost\"\n                onClick={() => setShowBulkDialog(false)}\n                disabled={bulkUpdateMutation.isPending}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={confirmBulkOperation}\n                disabled={bulkUpdateMutation.isPending}\n                className=\"soc-button-primary\"\n                data-testid=\"confirm-bulk-operation\"\n              >\n                {bulkUpdateMutation.isPending ? \"Processing...\" : `Confirm ${bulkOperation}`}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":18169},"client/src/pages/landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Shield, AlertTriangle, Eye, TrendingUp } from \"lucide-react\";\n\nexport default function Landing() {\n  const handleLogin = () => {\n    window.location.href = \"/login\";\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-900 flex flex-col\">\n      {/* Header */}\n      <header className=\"border-b border-slate-700 bg-slate-800\">\n        <div className=\"container mx-auto px-4 py-4 flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <Shield className=\"w-8 h-8 text-blue-500\" />\n            <h1 className=\"text-2xl font-bold text-white\">SOC Dashboard</h1>\n          </div>\n          <Button onClick={handleLogin} className=\"bg-blue-600 hover:bg-blue-700\">\n            Sign In\n          </Button>\n        </div>\n      </header>\n\n      {/* Hero Section */}\n      <main className=\"flex-1 container mx-auto px-4 py-16\">\n        <div className=\"text-center mb-16\">\n          <h2 className=\"text-5xl font-bold text-white mb-6\">\n            Advanced Security Operations Center\n          </h2>\n          <p className=\"text-xl text-slate-400 mb-8 max-w-3xl mx-auto\">\n            Real-time threat detection, automated incident response, and comprehensive analytics \n            for modern cybersecurity teams.\n          </p>\n          <Button onClick={handleLogin} size=\"lg\" className=\"bg-blue-600 hover:bg-blue-700 text-lg px-8 py-3\">\n            Get Started\n          </Button>\n        </div>\n\n        {/* Features Grid */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16\">\n          <Card className=\"bg-slate-800 border-slate-700\">\n            <CardHeader>\n              <AlertTriangle className=\"w-10 h-10 text-red-500 mb-4\" />\n              <CardTitle className=\"text-white\">Real-time Alerts</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-slate-400\">\n                Instant threat detection and alerting from multiple security sources.\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-slate-800 border-slate-700\">\n            <CardHeader>\n              <Eye className=\"w-10 h-10 text-blue-500 mb-4\" />\n              <CardTitle className=\"text-white\">Incident Management</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-slate-400\">\n                Streamlined incident tracking, assignment, and resolution workflows.\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-slate-800 border-slate-700\">\n            <CardHeader>\n              <TrendingUp className=\"w-10 h-10 text-green-500 mb-4\" />\n              <CardTitle className=\"text-white\">Analytics & Reporting</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-slate-400\">\n                Comprehensive performance metrics and automated reporting.\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-slate-800 border-slate-700\">\n            <CardHeader>\n              <Shield className=\"w-10 h-10 text-purple-500 mb-4\" />\n              <CardTitle className=\"text-white\">Threat Intelligence</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-slate-400\">\n                Advanced threat correlation and intelligence integration.\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Statistics */}\n        <div className=\"bg-slate-800 rounded-lg p-8 border border-slate-700\">\n          <h3 className=\"text-2xl font-bold text-white text-center mb-8\">\n            Trusted by Security Teams Worldwide\n          </h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 text-center\">\n            <div>\n              <div className=\"text-4xl font-bold text-blue-500 mb-2\">99.9%</div>\n              <div className=\"text-slate-400\">Uptime Reliability</div>\n            </div>\n            <div>\n              <div className=\"text-4xl font-bold text-green-500 mb-2\">&lt;2min</div>\n              <div className=\"text-slate-400\">Average Response Time</div>\n            </div>\n            <div>\n              <div className=\"text-4xl font-bold text-purple-500 mb-2\">24/7</div>\n              <div className=\"text-slate-400\">Continuous Monitoring</div>\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* Footer */}\n      <footer className=\"border-t border-slate-700 bg-slate-800 py-8\">\n        <div className=\"container mx-auto px-4 text-center text-slate-400\">\n          <p>&copy; 2024 SOC Dashboard. Secure by design.</p>\n        </div>\n      </footer>\n    </div>\n  );\n}","size_bytes":4830},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Shield, Eye, EyeOff } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { loginUserSchema, type LoginUser } from \"@shared/schema\";\n\nexport default function Login() {\n  const [showPassword, setShowPassword] = useState(false);\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const form = useForm<LoginUser>({\n    resolver: zodResolver(loginUserSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: LoginUser) => {\n      const response = await apiRequest('POST', '/api/auth/login', data);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Logged in successfully!\",\n      });\n      \n      // Invalidate auth queries to refresh user data\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/user'] });\n      \n      // Redirect to dashboard\n      setLocation('/');\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Login Failed\",\n        description: error.message || \"Invalid email or password\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: LoginUser) => {\n    loginMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-900 flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md bg-slate-800 border-slate-700\">\n        <CardHeader className=\"text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <Shield className=\"w-12 h-12 text-blue-500\" />\n          </div>\n          <CardTitle className=\"text-2xl text-white\">Sign In</CardTitle>\n          <p className=\"text-slate-400\">Access your SOC Dashboard</p>\n        </CardHeader>\n        \n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-white\">Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        type=\"email\"\n                        placeholder=\"Enter your email\"\n                        className=\"bg-slate-700 border-slate-600 text-white placeholder-slate-400\"\n                        disabled={loginMutation.isPending}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-white\">Password</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Input\n                          {...field}\n                          type={showPassword ? \"text\" : \"password\"}\n                          placeholder=\"Enter your password\"\n                          className=\"bg-slate-700 border-slate-600 text-white placeholder-slate-400 pr-10\"\n                          disabled={loginMutation.isPending}\n                        />\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"absolute right-0 top-0 h-full px-3 text-slate-400 hover:text-white\"\n                          onClick={() => setShowPassword(!showPassword)}\n                        >\n                          {showPassword ? (\n                            <EyeOff className=\"w-4 h-4\" />\n                          ) : (\n                            <Eye className=\"w-4 h-4\" />\n                          )}\n                        </Button>\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <Button\n                type=\"submit\"\n                className=\"w-full bg-blue-600 hover:bg-blue-700\"\n                disabled={loginMutation.isPending}\n              >\n                {loginMutation.isPending ? \"Signing In...\" : \"Sign In\"}\n              </Button>\n            </form>\n          </Form>\n          \n          <div className=\"mt-6 text-center\">\n            <p className=\"text-slate-400\">\n              Don't have an account?{\" \"}\n              <Link href=\"/register\" className=\"text-blue-400 hover:text-blue-300\">\n                Sign up\n              </Link>\n            </p>\n          </div>\n\n          {/* Demo credentials */}\n          <div className=\"mt-6 p-4 bg-slate-700 rounded-lg border border-slate-600\">\n            <p className=\"text-sm text-slate-300 mb-2 font-medium\">Demo Credentials:</p>\n            <div className=\"space-y-1 text-xs text-slate-400\">\n              <p><strong>Analyst:</strong> john.smith@company.com / password123</p>\n              <p><strong>Admin:</strong> sarah.johnson@company.com / admin123</p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":5956},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/pages/register.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Shield, Eye, EyeOff } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { registerUserSchema, type RegisterUser } from \"@shared/schema\";\n\nexport default function Register() {\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const form = useForm<RegisterUser>({\n    resolver: zodResolver(registerUserSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      firstName: \"\",\n      lastName: \"\",\n    },\n  });\n\n  const registerMutation = useMutation({\n    mutationFn: async (data: RegisterUser) => {\n      const response = await apiRequest('POST', '/api/auth/register', data);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Account created successfully! You are now logged in.\",\n      });\n      \n      // Invalidate auth queries to refresh user data\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/user'] });\n      \n      // Redirect to dashboard\n      setLocation('/');\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Registration Failed\",\n        description: error.message || \"Failed to create account\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: RegisterUser) => {\n    registerMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-900 flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md bg-slate-800 border-slate-700\">\n        <CardHeader className=\"text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <Shield className=\"w-12 h-12 text-blue-500\" />\n          </div>\n          <CardTitle className=\"text-2xl text-white\">Create Account</CardTitle>\n          <p className=\"text-slate-400\">Join the SOC Dashboard</p>\n        </CardHeader>\n        \n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"firstName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-white\">First Name</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          value={field.value || \"\"}\n                          placeholder=\"John\"\n                          className=\"bg-slate-700 border-slate-600 text-white placeholder-slate-400\"\n                          disabled={registerMutation.isPending}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                \n                <FormField\n                  control={form.control}\n                  name=\"lastName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-white\">Last Name</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          value={field.value || \"\"}\n                          placeholder=\"Doe\"\n                          className=\"bg-slate-700 border-slate-600 text-white placeholder-slate-400\"\n                          disabled={registerMutation.isPending}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n              \n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-white\">Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        type=\"email\"\n                        placeholder=\"Enter your email\"\n                        className=\"bg-slate-700 border-slate-600 text-white placeholder-slate-400\"\n                        disabled={registerMutation.isPending}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-white\">Password</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Input\n                          {...field}\n                          type={showPassword ? \"text\" : \"password\"}\n                          placeholder=\"Create a password\"\n                          className=\"bg-slate-700 border-slate-600 text-white placeholder-slate-400 pr-10\"\n                          disabled={registerMutation.isPending}\n                        />\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"absolute right-0 top-0 h-full px-3 text-slate-400 hover:text-white\"\n                          onClick={() => setShowPassword(!showPassword)}\n                        >\n                          {showPassword ? (\n                            <EyeOff className=\"w-4 h-4\" />\n                          ) : (\n                            <Eye className=\"w-4 h-4\" />\n                          )}\n                        </Button>\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <FormField\n                control={form.control}\n                name=\"confirmPassword\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-white\">Confirm Password</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Input\n                          {...field}\n                          type={showConfirmPassword ? \"text\" : \"password\"}\n                          placeholder=\"Confirm your password\"\n                          className=\"bg-slate-700 border-slate-600 text-white placeholder-slate-400 pr-10\"\n                          disabled={registerMutation.isPending}\n                        />\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"absolute right-0 top-0 h-full px-3 text-slate-400 hover:text-white\"\n                          onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                        >\n                          {showConfirmPassword ? (\n                            <EyeOff className=\"w-4 h-4\" />\n                          ) : (\n                            <Eye className=\"w-4 h-4\" />\n                          )}\n                        </Button>\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <Button\n                type=\"submit\"\n                className=\"w-full bg-blue-600 hover:bg-blue-700\"\n                disabled={registerMutation.isPending}\n              >\n                {registerMutation.isPending ? \"Creating Account...\" : \"Create Account\"}\n              </Button>\n            </form>\n          </Form>\n          \n          <div className=\"mt-6 text-center\">\n            <p className=\"text-slate-400\">\n              Already have an account?{\" \"}\n              <Link href=\"/login\" className=\"text-blue-400 hover:text-blue-300\">\n                Sign in\n              </Link>\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":8964},"client/src/pages/sources.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Shield, Server, Plus, Edit, Trash2, Activity } from \"lucide-react\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { SourceCard } from \"@/components/source-card\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { insertSourceSchema } from \"@shared/schema\";\nimport { useState } from \"react\";\n\nconst sourceFormSchema = insertSourceSchema.extend({\n  endpoint: z.string().url().optional(),\n});\n\nexport default function Sources() {\n  const { toast } = useToast();\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n\n  const { data: sources, isLoading } = useQuery({\n    queryKey: ['/api/sources'],\n    queryFn: api.getSources,\n  });\n\n  const createSourceMutation = useMutation({\n    mutationFn: api.createSource,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/sources'] });\n      setIsCreateDialogOpen(false);\n      form.reset();\n      toast({\n        title: \"Success\",\n        description: \"Source created successfully\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to create source\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateSourceMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) => api.updateSource(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/sources'] });\n      toast({\n        title: \"Success\",\n        description: \"Source updated successfully\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update source\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteSourceMutation = useMutation({\n    mutationFn: api.deleteSource,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/sources'] });\n      toast({\n        title: \"Success\",\n        description: \"Source deleted successfully\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete source\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const form = useForm<z.infer<typeof sourceFormSchema>>({\n    resolver: zodResolver(sourceFormSchema),\n    defaultValues: {\n      name: \"\",\n      type: \"\",\n      config: {},\n    },\n  });\n\n  const onSubmit = (values: z.infer<typeof sourceFormSchema>) => {\n    const { endpoint, ...sourceData } = values;\n    const config = endpoint ? { ...(sourceData.config || {}), endpoint } : (sourceData.config || {});\n    \n    createSourceMutation.mutate({\n      ...sourceData,\n      config,\n    });\n  };\n\n  const handleToggleSource = (sourceId: string, currentStatus: boolean) => {\n    updateSourceMutation.mutate({\n      id: sourceId,\n      data: { config: { enabled: !currentStatus } },\n    });\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <Skeleton className=\"h-8 w-48\" />\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {[...Array(6)].map((_, i) => (\n            <Card key={i} className=\"soc-card\">\n              <CardContent className=\"p-6\">\n                <Skeleton className=\"h-48 w-full\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between\">\n        <h2 className=\"text-2xl font-bold text-white\" data-testid=\"sources-title\">Data Sources</h2>\n        <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"mt-4 sm:mt-0 soc-button-primary\" data-testid=\"add-source\">\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Add Source\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"bg-slate-800 border-slate-700\">\n            <DialogHeader>\n              <DialogTitle className=\"text-white\">Add New Data Source</DialogTitle>\n            </DialogHeader>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\" data-testid=\"create-source-form\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-slate-200\">Source Name</FormLabel>\n                      <FormControl>\n                        <Input \n                          {...field} \n                          className=\"bg-slate-700 border-slate-600 text-white\"\n                          data-testid=\"source-name-input\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"type\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-slate-200\">Source Type</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger className=\"bg-slate-700 border-slate-600 text-white\" data-testid=\"source-type-select\">\n                            <SelectValue placeholder=\"Select source type\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"SIEM\">SIEM</SelectItem>\n                          <SelectItem value=\"EDR\">EDR</SelectItem>\n                          <SelectItem value=\"Firewall\">Firewall</SelectItem>\n                          <SelectItem value=\"IDS\">IDS</SelectItem>\n                          <SelectItem value=\"Antivirus\">Antivirus</SelectItem>\n                          <SelectItem value=\"Network\">Network Monitor</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"endpoint\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-slate-200\">Endpoint URL (Optional)</FormLabel>\n                      <FormControl>\n                        <Input \n                          {...field} \n                          placeholder=\"https://source.example.com/api\"\n                          className=\"bg-slate-700 border-slate-600 text-white\"\n                          data-testid=\"source-endpoint-input\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <div className=\"flex justify-end space-x-2 pt-4\">\n                  <Button \n                    type=\"button\" \n                    variant=\"ghost\" \n                    onClick={() => setIsCreateDialogOpen(false)}\n                    data-testid=\"cancel-source-button\"\n                  >\n                    Cancel\n                  </Button>\n                  <Button \n                    type=\"submit\" \n                    disabled={createSourceMutation.isPending}\n                    className=\"soc-button-primary\"\n                    data-testid=\"create-source-button\"\n                  >\n                    {createSourceMutation.isPending ? \"Creating...\" : \"Create Source\"}\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Sources Grid */}\n      {sources?.length === 0 ? (\n        <Card className=\"soc-card\">\n          <CardContent className=\"text-center py-12\">\n            <Server className=\"w-12 h-12 mx-auto mb-4 text-slate-600\" />\n            <p className=\"text-slate-400 text-lg mb-2\">No data sources configured</p>\n            <p className=\"text-slate-500 text-sm\">Add your first data source to start monitoring</p>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {sources?.map((source: any, index: number) => (\n            <SourceCard\n              key={source.id}\n              source={source}\n              onToggle={(enabled) => handleToggleSource(source.id, !enabled)}\n              onDelete={() => deleteSourceMutation.mutate(source.id)}\n              isDeleting={deleteSourceMutation.isPending}\n              isToggling={updateSourceMutation.isPending}\n              testId={`source-${index}`}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":9675},"client/src/components/layout/header.tsx":{"content":"import { Search, Bell, Menu, LogOut, User } from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport type { User as UserType } from \"@shared/schema\";\n\ninterface HeaderProps {\n  onMobileMenuToggle: () => void;\n  connectionStatus: 'connecting' | 'connected' | 'disconnected';\n  user?: UserType;\n}\n\nexport function Header({ onMobileMenuToggle, connectionStatus, user }: HeaderProps) {\n  const handleLogout = async () => {\n    try {\n      await fetch('/api/auth/logout', {\n        method: 'POST',\n        credentials: 'include',\n      });\n      // Reload page to trigger authentication check\n      window.location.reload();\n    } catch (error) {\n      console.error('Logout error:', error);\n      // Fallback: reload anyway\n      window.location.reload();\n    }\n  };\n\n  const getUserInitials = (user: UserType) => {\n    const firstName = user.firstName || '';\n    const lastName = user.lastName || '';\n    return (firstName.charAt(0) + lastName.charAt(0)).toUpperCase() || user.email?.charAt(0).toUpperCase() || 'U';\n  };\n  return (\n    <header className=\"bg-slate-800 border-b border-slate-700 px-4 lg:px-8 py-4\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center\">\n          {/* Mobile menu button */}\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={onMobileMenuToggle}\n            className=\"lg:hidden mr-4 text-slate-400 hover:text-white hover:bg-slate-700\"\n            data-testid=\"mobile-menu-button\"\n          >\n            <Menu className=\"w-6 h-6\" />\n          </Button>\n          \n          <div>\n            <h1 className=\"text-2xl font-semibold text-white\">Security Operations Dashboard</h1>\n            <p className=\"text-sm text-slate-400 mt-1\">Real-time monitoring and incident response</p>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center space-x-4\">\n          {/* Real-time status indicator */}\n          <div className=\"flex items-center space-x-2\" data-testid=\"connection-status\">\n            <div \n              className={`w-2 h-2 rounded-full ${\n                connectionStatus === 'connected' ? 'bg-green-500 animate-pulse' :\n                connectionStatus === 'connecting' ? 'bg-amber-500 animate-pulse' :\n                'bg-red-500'\n              }`} \n            />\n            <span className=\"text-sm text-slate-300 capitalize\">{connectionStatus}</span>\n          </div>\n          \n          {/* Search */}\n          <div className=\"hidden md:block\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400\" />\n              <Input\n                type=\"text\"\n                placeholder=\"Search incidents...\"\n                className=\"bg-slate-700 border-slate-600 pl-10 pr-4 text-white placeholder-slate-400 focus:ring-sky-500 focus:border-transparent w-64\"\n                data-testid=\"search-input\"\n              />\n            </div>\n          </div>\n          \n          {/* Notifications */}\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"relative text-slate-400 hover:text-white\"\n            data-testid=\"notifications-button\"\n          >\n            <Bell className=\"w-6 h-6\" />\n            <span className=\"absolute top-0 right-0 block h-2 w-2 bg-red-400 rounded-full\"></span>\n          </Button>\n\n          {/* User Profile */}\n          {user && (\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" className=\"relative h-8 w-8 rounded-full\">\n                  <Avatar className=\"h-8 w-8\">\n                    <AvatarImage src={user.profileImageUrl || undefined} alt=\"Profile\" />\n                    <AvatarFallback className=\"bg-slate-600 text-white text-sm\">\n                      {getUserInitials(user)}\n                    </AvatarFallback>\n                  </Avatar>\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent className=\"w-56 bg-slate-800 border-slate-700\" align=\"end\" forceMount>\n                <DropdownMenuLabel className=\"font-normal\">\n                  <div className=\"flex flex-col space-y-1\">\n                    <p className=\"text-sm font-medium leading-none text-white\">\n                      {user.firstName || user.lastName \n                        ? `${user.firstName || ''} ${user.lastName || ''}`.trim()\n                        : 'User'\n                      }\n                    </p>\n                    <p className=\"text-xs leading-none text-slate-400\">\n                      {user.email}\n                    </p>\n                  </div>\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator className=\"bg-slate-700\" />\n                <DropdownMenuItem \n                  className=\"text-slate-300 hover:bg-slate-700 hover:text-white cursor-pointer\"\n                  onClick={handleLogout}\n                >\n                  <LogOut className=\"mr-2 h-4 w-4\" />\n                  <span>Log out</span>\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          )}\n        </div>\n      </div>\n    </header>\n  );\n}\n","size_bytes":5554},"client/src/components/layout/sidebar.tsx":{"content":"import { Shield, BarChart3, AlertTriangle, Server, TrendingUp, MessageSquare } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface SidebarProps {\n  currentSection: string;\n  onSectionChange: (section: string) => void;\n  className?: string;\n}\n\nconst navigationItems = [\n  {\n    id: 'dashboard',\n    label: 'Dashboard',\n    icon: BarChart3,\n    badge: null,\n  },\n  {\n    id: 'incidents',\n    label: 'Incidents',\n    icon: AlertTriangle,\n    badge: { count: 5, variant: 'destructive' as const },\n  },\n  {\n    id: 'alerts',\n    label: 'Alerts',\n    icon: Shield,\n    badge: { count: 23, variant: 'warning' as const },\n  },\n  {\n    id: 'sources',\n    label: 'Sources',\n    icon: Server,\n    badge: null,\n  },\n  {\n    id: 'analytics',\n    label: 'Analytics',\n    icon: TrendingUp,\n    badge: null,\n  },\n  {\n    id: 'feedback',\n    label: 'Feedback',\n    icon: MessageSquare,\n    badge: null,\n  },\n];\n\nexport function Sidebar({ currentSection, onSectionChange, className }: SidebarProps) {\n  return (\n    <nav className={cn(\"flex flex-col w-full\", className)}>\n      {/* Logo */}\n      <div className=\"flex items-center px-6 py-4 border-b border-slate-700\">\n        <div className=\"w-8 h-8 bg-sky-500 rounded-lg flex items-center justify-center\">\n          <Shield className=\"w-5 h-5 text-white\" />\n        </div>\n        <span className=\"ml-3 text-xl font-semibold text-white\">SOC Platform</span>\n      </div>\n      \n      {/* Navigation Menu */}\n      <div className=\"flex-1 px-3 py-4 space-y-1\">\n        {navigationItems.map((item) => (\n          <button\n            key={item.id}\n            onClick={() => onSectionChange(item.id)}\n            data-testid={`nav-${item.id}`}\n            className={cn(\n              \"flex items-center w-full px-3 py-2 text-sm font-medium rounded-md group transition-colors\",\n              currentSection === item.id\n                ? \"bg-slate-700 text-white\"\n                : \"text-slate-300 hover:bg-slate-700 hover:text-white\"\n            )}\n          >\n            <item.icon className=\"mr-3 w-5 h-5\" />\n            {item.label}\n            {item.badge && (\n              <span\n                className={cn(\n                  \"ml-auto text-xs rounded-full px-2 py-1\",\n                  item.badge.variant === 'destructive' && \"bg-red-500 text-white\",\n                  item.badge.variant === 'warning' && \"bg-amber-500 text-white\"\n                )}\n                data-testid={`badge-${item.id}`}\n              >\n                {item.badge.count}\n              </span>\n            )}\n          </button>\n        ))}\n      </div>\n      \n      {/* User Profile */}\n      <div className=\"px-3 py-4 border-t border-slate-700\">\n        <div className=\"flex items-center\">\n          <div className=\"w-8 h-8 bg-slate-600 rounded-full flex items-center justify-center\">\n            <span className=\"text-sm font-medium text-white\">JS</span>\n          </div>\n          <div className=\"ml-3\">\n            <p className=\"text-sm font-medium text-white\">John Smith</p>\n            <p className=\"text-xs text-slate-400\">Security Analyst</p>\n          </div>\n        </div>\n      </div>\n    </nav>\n  );\n}\n","size_bytes":3145},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209}}}